--- orig.lhapdf/5.8.5/src/gzio.inc	2011-03-21 14:54:14.256267000 +0100
+++ lhapdf/5.8.5/src/gzio.inc	2011-03-21 14:54:53.178589000 +0100
@@ -0,0 +1,7 @@
+!*
+      INTEGER LUNMAX, STDLUN
+      PARAMETER (LUNMAX=1000, STDLUN=6)
+      COMMON /GZIOFD/ LUNS(LUNMAX), LUNMODS(LUNMAX), &
+       FILDES(8,LUNMAX)
+      INTEGER LUNS, LUNMODS, FILDES
+!* 
--- orig.lhapdf/5.8.5/src/gzio.F	2011-03-21 14:54:14.256003000 +0100
+++ lhapdf/5.8.5/src/gzio.F	2011-03-21 14:57:14.390738000 +0100
@@ -0,0 +1,457 @@
+!*
+      SUBROUTINE GZBREAD (LUN, CHBUF, NBBUF, ISTAT)
+!************************************************************************
+!*
+!* Reads a line from a zipped ascii file
+!*
+!* Arguments:
+!* LUN Logical Unit Number for reading
+!* CHBUF array for storing unzipped info
+!* NBBUF record size, number of bytes of array MBUF
+!* ISTAT status, =NBREC if ok., =zero if EOF encountered
+!************************************************************************
+!*
+      IMPLICIT NONE
+#include "gzio.inc"
+!*
+      CHARACTER*(*) CHBUF
+      INTEGER LUN, NBBUF, ISTAT
+      INTEGER ILUN, GZFINDL
+!*
+      ILUN = GZFINDL (LUN)                      
+      IF (ILUN .EQ. 0) THEN                     
+        WRITE (STDLUN,'(A,I4)') &                  
+         'GZBREAD: Error - undefined LUN =', LUN 
+!C        CALL EXITF (1)                            
+        STOP 1
+      END IF                                    
+!*     
+      IF (LUNMODS(ILUN) .EQ. 1) THEN
+        CALL GZGETB (FILDES(1,ILUN),NBBUF,CHBUF,ISTAT)
+      ELSE
+        WRITE (STDLUN,'(A,A,I4)') &
+         'GZBREAD: Error - attempt to read from a file', &
+         'opened for writing, LUN =', LUN
+!C        CALL EXITF (1)
+        STOP 1
+      END IF
+!*     
+      END
+ 
+!*     
+      SUBROUTINE GZBWRITE (LUN, BUFFER, NBYTES)
+!*     
+!*     
+!************************************************************************
+!*     
+!*     Writes the binary content in BUFFER to a zipped file
+!*     
+!*     Arguments:
+!*     LUN Logical Unit Number for reading
+!*     BUFFER Array of binary content
+!*     NBYTES Number of Bytes to write
+!*     
+!*     
+!************************************************************************
+!*     
+      IMPLICIT NONE
+#include "gzio.inc"
+!*     
+      INTEGER LUN, BUFFER(*), NBYTES
+      INTEGER ISTAT, ILUN, GZFINDL
+!*     
+      ILUN = GZFINDL (LUN)
+      IF (ILUN .EQ. 0) THEN
+        WRITE (STDLUN,'(A,I4)') &
+         'GZBWRITE: Error - undefined LUN =', LUN
+!C        CALL EXITF (1)
+        STOP 1
+      END IF
+!*     
+      IF (LUNMODS(ILUN) .EQ. 2) THEN
+        CALL GZPUTS (FILDES(1,ILUN),NBYTES,BUFFER,ISTAT)
+        IF (ISTAT .LT. 0) THEN
+          WRITE (STDLUN,'(A,I4)') &
+           'GZBWRITE: Error while writing to the zipped file', &
+           ' for LUN =', LUN
+!C          CALL EXITF (1)
+          STOP 1
+        END IF
+      ELSE
+        WRITE (STDLUN,'(A,I4)') &
+         'GZBWRITE: Error, attempt to write to a file', &
+         ' opened for reading, LUN =', LUN
+!C      CALL EXITF (1)
+        STOP 1  
+
+      END IF
+!*     
+      END
+!* 
+      SUBROUTINE GZCLOSE (LUN, ISTAT)
+!*     
+!*     
+!************************************************************************
+!*     
+!*     Closes the zipped file
+!*     
+!*     Argument:
+!*     LUN Logical Unit Number
+!*     ISTAT =0 ok, =1 error occured
+!*     
+!************************************************************************
+!*     
+      IMPLICIT NONE
+#include "gzio.inc"
+!*     
+      INTEGER LUN, ISTAT
+      INTEGER ILUN, GZFINDL
+!*     
+      ISTAT = 0
+      ILUN = GZFINDL (LUN)
+      IF (ILUN .EQ. 0) THEN
+        WRITE (STDLUN,'(A,I4)') &
+         'GZCLOSE: Error - undefined LUN =', LUN
+        ISTAT = 1
+        GO TO 90
+      END IF
+!*     
+      IF (LUNMODS(ILUN) .EQ. 1) THEN
+        CALL GZCLOS (FILDES(1,ILUN),'r',ISTAT)
+        IF (ISTAT .NE. 0) THEN
+          WRITE (STDLUN,'(A,A,I4)') &
+           'GZCLOSE: Error - Input file could not be closed', &
+           'LUN =',LUN
+        ELSE
+          LUNS(ILUN) = 0
+        END IF
+      ELSE
+        CALL GZCLOS (FILDES(1,ILUN),'w',ISTAT)
+        IF (ISTAT .NE. 0) THEN
+          WRITE (STDLUN,'(A,A,I4)') &
+           'GZCLOSE: Error - Output file could not be closed', &
+           'LUN =',LUN
+        ELSE
+          LUNS(ILUN) = 0
+        END IF
+      END IF
+!*     
+ 90   RETURN
+!*     
+      END
+!*     
+      INTEGER FUNCTION GZFINDL (LUN)
+!************************************************************************
+!*     
+!*     check if LUN is defined and returns the correspondig pointer
+!*     as function value
+!*     
+!*     Arguments:
+!*     LUN Logical Unit Number for reading
+!*     ILUN Pointer to the file descriptor area
+!************************************************************************
+!*     
+      IMPLICIT NONE
+#include "gzio.inc"
+!*     
+      INTEGER LUN, J
+!*     
+      IF (LUN .LT. 1 .OR. LUN .GT. 99) THEN
+        WRITE (STDLUN,'(A,I4)') &
+         'GZFINDL: Error - LUN outside limits LUN =', LUN
+!C        CALL EXITF (1)
+        STOP 1
+      END IF
+!*     
+      DO J = 1,LUNMAX
+        IF (LUN .EQ. LUNS(J)) THEN
+          GZFINDL = J
+          RETURN
+        END IF
+      END DO
+      GZFINDL = 0
+!*     
+      END 
+!*     
+      SUBROUTINE GZOPEN (LUN, MODE, FILNAM, ISTAT)
+!*     
+!************************************************************************
+!*     
+!*     Opens a file for zipped IO
+!*     
+!*     Arguments:
+!*     LUN logical unit number used for this file
+!*     MODE string selecting IO mode (r, w)
+!*     FILNAM name of the file (including the null-terminator)
+!*     ISTAT status, =zero if success, #0 otherwise
+!*     
+!*     Input file: Extension '.gz' is checked
+!*     Output file: Extension '.gz' is checked
+!*     
+!************************************************************************
+!*     
+      IMPLICIT NONE
+#include "gzio.inc"
+!*     
+      CHARACTER*1 MODE, MYMODE
+      CHARACTER*(*) FILNAM
+      CHARACTER*256 MYFNAM
+      INTEGER LUN, ILUN, GZFINDL, FLNLEN, ISTAT, LENOCC
+!*     
+      INTEGER NLUNS
+      DATA NLUNS / 0/
+      SAVE NLUNS
+!*     
+      ISTAT = 0
+      ILUN = GZFINDL (LUN)
+      IF (ILUN .NE. 0) THEN
+        WRITE (STDLUN,'(A,I4)') &
+         'GZOPEN: Error - LUN used already, LUN =', LUN
+        ISTAT = 1
+        GO TO 90
+      END IF
+!*     
+      IF (NLUNS+1 .GT. LUNMAX) THEN
+        WRITE (STDLUN,'(A,I4)') &
+         'GZOPEN: Error - LUN table overflow for LUN =', LUN
+        ISTAT = 1
+        GO TO 90
+      END IF
+!*     
+      FLNLEN = LENOCC (FILNAM)
+      IF (MODE .EQ. 'r' .OR. MODE .EQ. 'R') THEN
+        MYMODE='r'
+      ELSE IF (MODE .EQ. 'w' .OR. MODE .EQ. 'W') THEN
+        MYMODE='w'
+      ELSE
+        WRITE (STDLUN,'(A,I4)') &
+         'GZOPEN: Error - undefined mode for LUN =', LUN
+      END IF
+!*     
+      IF (MYMODE .EQ. 'r') THEN
+        IF (FILNAM(FLNLEN-2:FLNLEN) .EQ. '.gz') THEN
+          NLUNS = NLUNS + 1
+          LUNS(NLUNS) = LUN
+          LUNMODS(NLUNS) = 1
+          CALL GZIOOP (FILDES(1,NLUNS), 'r', FILNAM(1:FLNLEN), FLNLEN, &
+           ISTAT)
+          GO TO 90
+        ELSE
+          WRITE (STDLUN,'(A,A,I4)') &
+           'GZOPEN: Error - Input file name has no .gz extension', &
+           ' LUN =', LUN
+          ISTAT = 1
+          GO TO 90
+        END IF
+!*       
+      ELSE IF (MYMODE .EQ. 'w') THEN
+        IF (FILNAM(FLNLEN-2:FLNLEN) .EQ. '.gz') THEN
+          NLUNS = NLUNS + 1
+          LUNS(NLUNS) = LUN
+          LUNMODS(NLUNS) = 2
+          CALL GZIOOP (FILDES(1,NLUNS), 'w', FILNAM(1:FLNLEN), FLNLEN, &
+           ISTAT)
+          GO TO 90
+        ELSE
+          WRITE (STDLUN,'(A,A,I4)') &
+           'GZOPEN: Error - Output file name has no .gz extension', &
+           ' LUN =', LUN
+          ISTAT = 1
+        END IF
+      END IF
+!*     
+ 90   RETURN
+!*     
+      END
+!* 
+      SUBROUTINE GZREAD (LUN, CHBUF, NBBUF, ISTAT)
+!************************************************************************
+!*     
+!*     Reads a line from a zipped ascii file
+!*     
+!*     Arguments:
+!*     LUN Logical Unit Number for reading
+!*     CHBUF array for storing unzipped info
+!*     NBBUF record size, number of bytes of array MBUF
+!*     ISTAT status, =NBREC if ok., =zero if EOF encountered
+!************************************************************************
+!*     
+      IMPLICIT NONE
+#include "gzio.inc"
+!*     
+      CHARACTER*(*) CHBUF
+      INTEGER LUN, NBBUF, ISTAT
+      INTEGER ILUN, GZFINDL
+!*     
+      ILUN = GZFINDL (LUN)
+      IF (ILUN .EQ. 0) THEN
+        WRITE (STDLUN,'(A,I4)') &
+         'GZREAD: Error - undefined LUN =', LUN
+!C        CALL EXITF (1)
+        STOP 1
+      END IF
+!*     
+      IF (LUNMODS(ILUN) .EQ. 1) THEN
+        CALL GZGETS (FILDES(1,ILUN),NBBUF,CHBUF,ISTAT)
+      ELSE
+        WRITE (STDLUN,'(A,A,I4)') &
+         'GZREAD: Error - attempt to read from a file', &
+         'opened for writing, LUN =', LUN
+!C        CALL EXITF (1)
+        STOP 1
+      END IF
+!*     
+      END
+!* 
+      SUBROUTINE GZSTORE (IDIR, ARRAY, NROW, NCOL, I1, J1, J2, BUFFER)
+!*     
+!*     
+!************************************************************************
+!*     
+!*     Utility routine for siwdstgz
+!*     Stores scattered ARRAY(NROW,NCOL) info into BUFFER (IDIR=1)
+!*     or vice versa (IDIR=2)
+!*     
+!*     according to:
+!*     
+!*     I1 = row number,
+!*     J1 = starting column number,
+!*     J2 = ending column number,
+!*     
+!*     Called by SIWDSTGZ, ANEVTI
+!*     
+!************************************************************************
+!*     
+      IMPLICIT NONE
+#include "gzio.inc"
+!*     
+      INTEGER IDIR, NROW, NCOL, I1, J1, J2
+      INTEGER ARRAY(NROW,NCOL), BUFFER(*)
+      INTEGER J, K
+!*     
+      K = 0
+      IF (IDIR .EQ. 1) THEN
+        DO J = J1,J2
+        K = K + 1
+        BUFFER(K) = ARRAY(I1,J)
+      END DO
+      ELSE IF (IDIR .EQ. 2) THEN
+        DO J = J1,J2
+        K = K + 1
+        ARRAY(I1,J) = BUFFER(K)
+      END DO
+      ELSE
+        WRITE (STDLUN,'(A,I4)') &
+         'GZSTORE: Error - wrong value of argument IDIR =', IDIR
+!C        CALL EXITF (1)
+        STOP 1
+      END IF
+!*     
+      END
+!* 
+      SUBROUTINE GZWRITE (LUN, OUTLINE)
+!*     
+!*     
+!************************************************************************
+!*     
+!*     Writes a line to a zipped file
+!*     
+!*     Argument:
+!*     LUN Logical Unit Number for writing
+!*     OUTLINE Character string to write
+!*     
+!*     
+!************************************************************************
+!*     
+      IMPLICIT NONE
+#include "gzio.inc"
+!*     
+!*     
+      CHARACTER*(*) OUTLINE
+      INTEGER LUN
+      CHARACTER*1 NL
+      INTEGER LGN, ISTAT, LNBLNK, ILUN, GZFINDL
+!*     
+      IF (LUN .LT. 1 .OR. LUN .GT. 99) THEN
+        WRITE (STDLUN,'(A,I4)') &
+         'GZBRITE: Error - wrong LUN =', LUN
+!C        CALL EXITF (1)
+        STOP 1
+      END IF
+!*     
+      ILUN = GZFINDL (LUNS(1),LUNMAX)
+      IF (ILUN .EQ. 0) THEN
+        WRITE (STDLUN,'(A,I4)') &
+         'GZBRITE: Error - undefined LUN =', LUN
+!C        CALL EXITF (1)
+        STOP 1
+      END IF
+!*     
+      IF (LUNMODS(ILUN) .EQ. 2) THEN
+        NL = CHAR(10)
+        LGN = LNBLNK (OUTLINE)
+        LGN = LGN + 1
+        OUTLINE(LGN:LGN) = NL
+        CALL GZPUTS (FILDES(1,ILUN),LGN,OUTLINE,ISTAT)
+        IF (ISTAT .LT. 0) THEN
+          WRITE (STDLUN,'(A,A,I4)') &
+           'GZWRITE: Error while writing to the zipped file', &
+           'LUN =', LUN
+!C          CALL EXITF (1)
+          STOP 1
+        END IF
+      ELSE
+        WRITE (STDLUN,'(A,A,I4)') &
+         'GZWRITE: Error, attempt to write to a file', &
+         ' opened for reading, LUN =', LUN
+!C        CALL EXITF (1)
+        STOP 1
+      END IF
+!*     
+      END
+!* 
+      integer function lenocc(c)
+      character*(*) c
+      lenocc = len(c)
+      do 1 i=len(c),1,-1
+        if(c(i:i).ne.' ') then
+          lenocc = i
+          return
+        endif
+ 1    continue
+      lenocc = 0
+      end
+!
+      SUBROUTINE GZMULT( LUN, CHVEC, NITEM)
+!     
+!     read a list of NITEM items split across multiple lines and return them
+!     in an array of characters CHVEC
+!     F. Cossutti
+!
+      IMPLICIT NONE
+      INTEGER LUN, NITEM, NBBUF, ISTAT
+      CHARACTER*(*) CHVEC(NITEM)
+      CHARACTER*512 OUTLINE
+      DATA NBBUF / 512 /
+
+      INTEGER ITER,II,JJ,ILAST
+
+      ITER = 0
+      ILAST = 0
+
+      DO 1 II = 1,NITEM
+        CHVEC(II) = ' '
+ 1    CONTINUE
+
+ 5    CALL GZREAD(LUN,OUTLINE,NBBUF,ISTAT)
+      DO 10 II = 1,ISTAT
+        IF ((OUTLINE(II:II).NE.' ' .AND. II.EQ.1) .OR. &
+            (OUTLINE(II:II).NE.' ' .AND. IACHAR(OUTLINE(II:II)).GT.32 .AND. OUTLINE(II-1:II-1).EQ.' ')) &
+            ITER = ITER+1
+ 10   CONTINUE
+      READ(OUTLINE(1:ISTAT),*) (CHVEC(JJ),JJ=ILAST+1,ITER)
+      ILAST = ITER
+      IF (ITER.LT.NITEM) GOTO 5
+
+      RETURN
+      END
--- orig.lhapdf/5.8.5/src/ftn_gzio.c	2011-03-21 14:54:14.255781000 +0100
+++ lhapdf/5.8.5/src/ftn_gzio.c	2011-03-21 14:57:50.249876000 +0100
@@ -0,0 +1,220 @@
+/* ftn_gzio - usage of the zlib compression library by fortran calls
+ * Copyright (C) 2001 Harald Vogt
+ * derived from gzio
+ * Copyright (C) 1995-1998 Jean-loup Gailly.
+ */
+
+
+#include <stdlib.h>
+#include <stdio.h>
+#include <string.h>
+#include "zlib.h"
+
+extern void exit OF((int));
+
+
+/* ===========================================================================
+ * fortran interface to open .gz files for read/write
+ *
+ * SUBROTINE GZIOOP (FILDES, MODE, FILENAME, LGFNAME, ISTAT)
+ *
+ * FILDES address of file descriptor area
+ * MODE string selecting IO mode (r, w)
+ * FILENAME name of the file (including the null-terminator)
+ * LGFNAME length of the filename string
+ * *ISTAT status, =zero if success
+ */
+
+void gzioop_(gzFile *fildes,char *fmode,char *fname,int *lgfname,int *stat)
+{
+  char *pttext;
+  gzFile file;
+
+  *stat = -1;
+
+  if(*lgfname==0) {
+    perror("GZIOOP: no filename");
+    *stat = 107;
+    return;
+  }
+
+  //  if(!((long)pttext=malloc(*lgfname+8))) {
+  if(!(pttext=malloc(*lgfname+8))) {
+    fprintf(stderr, "GZIOOP: no malloc possible\n");
+    exit(1);
+  }
+  strncpy(pttext,fname,*lgfname);
+  pttext[*lgfname]='\0';
+
+  switch (*fmode) {
+  case 'r':
+    file = gzopen(pttext, "rb");
+    if (file == NULL) {
+      fprintf(stderr, "GZIOOP: input file open error\n");
+      *stat = 108;
+      return;
+    }
+    break;
+  case 'w':
+    file = gzopen(pttext, "wb");
+    if (file == NULL) {
+      fprintf(stderr, "GZIOOP: output file oopen error\n");
+      *stat = 108;
+      return;
+    }
+    break;
+  default: fprintf(stderr,"GZIOOP: unknown i/o mode %s\n",fmode);
+    *stat = 108;
+    return;
+  }
+  /* myprint_(file); */
+  *fildes = file;
+  *stat = 0;
+  return;
+}
+
+/*
+ *
+ * SUBROTINE GZCLOS (FILDES, MODE, ISTAT)
+ *
+ * FILDES address of file descriptor area
+ * MODE string selecting IO mode (r, w)
+ * *ISTAT status, =zero if success
+ */
+
+void gzclos_(gzFile *fildes,char *fmode,int *stat)
+{
+  gzFile file;
+
+  *stat = -1;
+  file = *fildes;
+
+  switch (*fmode) {
+  case 'r':
+	gzclose(file);
+	if (file == NULL) {
+      fprintf(stderr, "GZCLOS: no file defined to close\n");
+      exit(1);
+	}
+	break;
+  case 'w':
+	/* gzseek(file, 1L, SEEK_CUR); */ /* add one zero byte */
+	gzclose(file);
+	if (file == NULL) {
+      fprintf(stderr, "GZCLOS: no file defined to close\n");
+      exit(1);
+	}
+	break;
+  default: fprintf(stderr,"GZCLOS: unknown i/o mode %s\n",fmode);
+	exit(1);
+  }
+  *stat = 0;
+  return;
+}
+	
+/*
+ *
+ * SUBROTINE GZREWIND (FILDES)
+ *
+ * FILDES address of file descriptor area
+ */
+	
+void gzrewind_(gzFile *fildes)
+{
+  gzFile file;
+	
+  file = *fildes;
+  gzrewind(file);
+  return;
+}
+	
+/*
+ *
+ * SUBROTINE GZPUTS (FILDES, NBREC, MBUF, ISTAT)
+ *
+ * FILDES address of file descriptor area
+ * NBREC record size, number of bytes to be written
+ * MBUF vector to be written
+ * *ISTAT status, =zero if success
+ */
+	
+void gzputs_(gzFile *fildes,int *nbrec, char *mbuf, int *stat)
+{
+  int nbdn, nbdo;
+  gzFile file;
+	
+  *stat = -1;
+  file = *fildes;
+	
+  nbdo = *nbrec;
+	
+  if (file == NULL) {
+	fprintf(stderr, "GZPUTS: no file defined to write\n");
+	exit(1);
+  }
+  nbdn = gzwrite(file, mbuf, nbdo);
+  *stat = nbdn;
+  return;
+}
+	
+/*
+ *
+ * SUBROTINE GZGETS (FILDES, NBREC, MBUF, ISTAT)
+ *
+ * FILDES address of file descriptor area
+ * NBREC record size, number of bytes of array MBUF
+ * MBUF array for storing unzipped info
+ * *ISTAT status, =NBREC if ok., =zero if EOF encountered
+ */
+	
+void gzgets_(gzFile *fildes,int *nbrec, char *mbuf, int *stat)
+{
+  unsigned len;
+  char *buf;
+  gzFile file;
+	
+  *stat = 0;
+  file = *fildes;
+	
+  len = *nbrec;
+  buf = mbuf;
+  if (file == NULL) {
+	fprintf(stderr, "GZGETS: no file defined to write\n");
+	exit(1);
+  }
+  if (buf == Z_NULL || len <= 0) *stat = 0;
+  while (--len > 0 && gzread(file, buf, 1) == 1 && *buf++ != '\n') ;
+  *buf = '\0';
+  *stat = buf - mbuf;
+	
+  return;
+}
+	
+/*
+ *
+ * SUBROTINE GZGETB (FILDES, NBREC, MBUF, ISTAT)
+ *
+ * FILDES address of file descriptor area
+ * NBREC record size, number of bytes of array MBUF
+ * MBUF array for storing unzipped info
+ * *ISTAT status, =NBREC if ok., =zero if EOF encountered
+ */
+	
+void gzgetb_(gzFile *fildes,int *nbrec, char *mbuf, int *stat)
+{
+  int nbdn, nbdo;
+  gzFile file;
+	
+  *stat = -1;
+  file = *fildes;
+	
+  nbdo = *nbrec;
+	
+  if (file == NULL) {
+	fprintf(stderr, "GZGETB: Error - no input file defined\n");
+	exit(1);
+  }
+  nbdn = gzread(file, mbuf, nbdo);
+  *stat = nbdn;
+  return;
+} 
--- orig.lhapdf/5.8.5/src/QCDparams.f	2011-02-15 13:25:27.000000000 +0100
+++ lhapdf/5.8.5/src/QCDparams.f	2011-02-14 14:18:38.000000000 +0100
@@ -53,14 +53,23 @@
   integer nset
   ! integer iset,imem
   ! common/SET/iset,imem
+  integer istat,nbbuf
+  character*512 outline
+  data nbbuf /512/
   save
-  read(1,*)nmem,nrep
+!  read(1,*)nmem,nrep
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) nmem,nrep
   if(nrep.eq.0) then
      do i=0,nmem
-        read(1,*) (parmQCD(nset,i,j),j=1,2)
+!        read(1,*) (parmQCD(nset,i,j),j=1,2)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (parmQCD(nset,i,j),j=1,2)
      enddo
   else
-     read(1,*) (parmQCD(nset,0,j),j=1,2)
+!     read(1,*) (parmQCD(nset,0,j),j=1,2)
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) (parmQCD(nset,0,j),j=1,2)
      do i=1,nmem
         do j=1,2
            parmQCD(nset,i,j)=parmQCD(nset,0,j)
@@ -87,18 +96,27 @@
   double precision parmQ2min(nmxset,0:noemax),q2min
   double precision parmQ2max(nmxset,0:noemax),q2max
   integer nset
+  integer istat,nbbuf
+  character*512 outline
+  data nbbuf /512/
   save
-  read(1,*)nmem,nrep
+!  read(1,*)nmem,nrep
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) nmem,nrep
   if(nrep.eq.0) then
      do i=0,nmem
-        read(1,*) &
+!        read(1,*) &
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) &
              parmXmin(nset,i),&
              parmXmax(nset,i),&
              parmQ2min(nset,i),&
              parmQ2max(nset,i)
      enddo
   else
-     read(1,*) &
+!     read(1,*) &
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) &
           parmXmin(nset,0),&
           parmXmax(nset,0),&
           parmQ2min(nset,0),&
--- orig.lhapdf/5.8.5/src/alphas.f	2011-02-15 13:25:27.000000000 +0100
+++ lhapdf/5.8.5/src/alphas.f	2011-02-14 14:18:38.000000000 +0100
@@ -59,6 +59,9 @@
   double precision cmass(nmxset),bmass(nmxset),tmass(nmxset)
   common/masses_LHA/cmass,bmass,tmass
   save EvlOrd,parm,Etype,alfasQ,Q0,Method
+  integer istat,nbbuf
+  character*512 outline
+  data nbbuf /512/
   
   call setnset(nset)
   
@@ -127,7 +130,9 @@
   entry InitAlphasPDF(nset)
   Etype(nset)=-1
   EvlOrd(nset)=-1
-  read(1,*) s1,s2,s3
+!  read(1,*) s1,s2,s3
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) s1,s2,s3
   if (index(s2,'lo').eq.1) EvlOrd(nset)=0
   if (index(s2,'nlo').eq.1) EvlOrd(nset)=1
   if (index(s2,'nnlo').eq.1) EvlOrd(nset)=2
@@ -139,12 +144,16 @@
   if (index(s1,'Fixed').eq.1) then
      Etype(nset)=1
      parm(nset)=-1
-     read(1,*) alfasQ(nset),Q0(nset),cmass(nset),bmass(nset),tmass(nset)
+!     read(1,*) alfasQ(nset),Q0(nset),cmass(nset),bmass(nset),tmass(nset)
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) alfasQ(nset),Q0(nset),cmass(nset),bmass(nset),tmass(nset)
   endif
   if (index(s1,'Variable').eq.1) then
      Etype(nset)=2
      alfasQ(nset)=0d0
-     read(1,*) parm(nset),Q0(nset),cmass(nset),bmass(nset),tmass(nset)
+!     read(1,*) parm(nset),Q0(nset),cmass(nset),bmass(nset),tmass(nset)
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) parm(nset),Q0(nset),cmass(nset),bmass(nset),tmass(nset)
   endif
   if (Etype(nset).lt.0) then
      write(*,*) 'File description error:'
--- orig.lhapdf/5.8.5/src/description.f	2011-02-15 13:25:27.000000000 +0100
+++ lhapdf/5.8.5/src/description.f	2011-02-14 14:18:38.000000000 +0100
@@ -11,12 +11,17 @@
   integer lhasilent
   common/lhasilent/lhasilent
   save nline,desc
+  integer istat,nbbuf
+  character*512 outline
+  data nbbuf /512/
 
   l=0
   if (lhasilent.eq.0) then
      write(*,*) '>>>>>> PDF description: <<<<<<'
   endif
-1 read(1,*) string
+!1 read(1,*) string
+1 call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) string
   id=token(string)
   if (id.eq.0) then
      if(lhasilent.eq.0) then
--- orig.lhapdf/5.8.5/src/evolution.f	2011-02-15 13:25:27.000000000 +0100
+++ lhapdf/5.8.5/src/evolution.f	2011-02-14 14:18:38.000000000 +0100
@@ -26,11 +26,16 @@
   character*16 s2
   double precision Q,Q2,Q2fit,muR
   integer nset,order,EvlOrd
+  integer istat,nbbuf
+  character*512 outline
+  data nbbuf /512/
   
   save EvlOrd,Q2fit,muR
   
   EvlOrd=-1
-  read(1,*) s2,Q2fit,muR
+!  read(1,*) s2,Q2fit,muR
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) s2,Q2fit,muR
   if (index(s2,'lo').eq.1) EvlOrd=0
   if (index(s2,'nlo').eq.1) EvlOrd=1
   if (index(s2,'nnlo').eq.1) EvlOrd=2
--- orig.lhapdf/5.8.5/src/wrapcteq5.f	2011-02-15 13:25:28.000000000 +0100
+++ lhapdf/5.8.5/src/wrapcteq5.f	2011-02-14 14:18:38.000000000 +0100
@@ -22,6 +22,11 @@
      & / QCDtable /  Alambda(nmxset), Nfl(nmxset), Iorder(nmxset)       &
      & / Masstbl / Amass(6,nmxset)                                      
       data pi / 3.141592653589793d0 / 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      integer nitem
+      character*20 chvec(40000)
       save 
 !                                                                       
       U =         X * CtLhCtq5Pdf(1,X,Q) 
@@ -56,22 +61,46 @@
       call CtLhbldat1 
       call CtLhbldat2 
                                                                         
-      read(1,*)nmem(nset),ndef(nset) 
-      Read  (1, '(A)') Line 
-      Read  (1, '(A)') Line 
-      Read  (1, *) Dr, Fl, Al5(nset), (Amass(I,nset),I=1,6) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) Dr, Fl, Al5(nset), (Amass(I,nset),I=1,6) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) Dr, Fl, Al5(nset), (Amass(I,nset),I=1,6) 
       Iorder(nset) = Nint(Dr) 
       Nfl(nset) = Nint(Fl) 
       Alambda(nset) = Al5(nset) 
                                                                         
-      Read  (1, '(A)') Line 
-      Read  (1, *) NX(nset),  NT(nset), NfMx(nset) 
-                                                                        
-      Read  (1, '(A)') Line 
-      Read  (1, *) QINI(nset), QMAX(nset), (QL5(I,nset), I =0, NT(nset)) 
-                                                                        
-      Read  (1, '(A)') Line 
-      Read  (1, *) XMIN(nset), (XV5(I,nset), I =0, NX(nset)) 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) NX(nset),  NT(nset), NfMx(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) NX(nset),  NT(nset), NfMx(nset) 
+                                                                        
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) QINI(nset), QMAX(nset), (QL5(I,nset), I =0, NT(nset)) 
+      nitem = 3+nt(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) qini(nset)
+      read(chvec(2),*) qmax(nset)
+      do i = 0, nt(nset)
+         read(chvec(i+3),*) ql5(i,nset)
+      enddo
+                                                                        
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) XMIN(nset), (XV5(I,nset), I =0, NX(nset)) 
+      nitem = 2+nx(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) XMIN(nset)
+      do i = 0,nx(nset)
+         read(chvec(2+i),*) XV5(I,nset)
+      enddo
                                                                         
       Do 11 Iq = 0, NT(nset) 
          QL5(Iq,nset) = Log (QL5(Iq,nset) /Al5(nset)) 
@@ -84,8 +113,14 @@
       Nblk = (NX(nset)+1) * (NT(nset)+1) 
       Npts =  Nblk  * (NfMx(nset)+3) 
                                                                         
-      Read  (1, '(A)') Line 
-      Read  (1, *, IOSTAT=IRET) (UPD5(I,nset), I=1,Npts) 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *, IOSTAT=IRET) (UPD5(I,nset), I=1,Npts) 
+      nitem = npts
+      call gzmult(1,chvec,nitem)
+      do i = 1,npts
+         read(chvec(i),*) UPD5(I,nset)
+      enddo
       Return 
 !                                                                       
                                                                         
--- orig.lhapdf/5.8.5/src/wrapcteq6.f	2011-02-15 13:25:28.000000000 +0100
+++ lhapdf/5.8.5/src/wrapcteq6.f	2011-02-14 14:18:38.000000000 +0100
@@ -22,6 +22,11 @@
      & / Masstbl / Amass(6,nmxset)                                      
       common/masses_LHA/cMass(nmxset),bMass(nmxset),tMass(nmxset) 
       data pi / 3.141592653589793d0 / 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      integer nitem
+      character*20 chvec(40000)
       save 
 !                                                                       
       call getnset(iset) 
@@ -59,14 +64,20 @@
                                                                         
       call LHct6set 
                                             !*** nmem+1=number of member
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
       if(nmem(nset) .gt. nhess) then 
          print *,'fatal error:  nmem=',nmem(nset),' > nhess=',nhess 
          stop 
       endif 
-      Read  (1, '(A)') Line 
-      Read  (1, '(A)') Line 
-      Read  (1, *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
       Iorder(nset) = Nint(Dr) 
       Nfl(nset) = Nint(Fl) 
       Alambda(nset) = Al(nset) 
@@ -75,15 +86,33 @@
       bMass(nset) = Amass(5,nset) 
       tMass(nset) = Amass(6,nset) 
                                                                         
-      Read  (1, '(A)') Line 
-      Read  (1, *) NX(nset),  NT(nset), NfMx(nset) 
-                                                                        
-      Read  (1, '(A)') Line 
-      Read  (1, *)                                                      &
-     &  QINI(nset), QMAX(nset), (TV(I,nset), I =0, NT(nset))            
-                                                                        
-      Read  (1, '(A)') Line 
-      Read  (1, *) XMIN(nset), (XV(I,nset), I =0, NX(nset)) 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) NX(nset),  NT(nset), NfMx(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) NX(nset),  NT(nset), NfMx(nset) 
+                                                                        
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *)                                                      &
+!     &  QINI(nset), QMAX(nset), (TV(I,nset), I =0, NT(nset))            
+      nitem = 3+nt(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) qini(nset)
+      read(chvec(2),*) qmax(nset)
+      do i = 0, nt(nset)
+         read(chvec(i+3),*) tv(i,nset)
+      enddo
+                                                                        
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) XMIN(nset), (XV(I,nset), I =0, NX(nset)) 
+      nitem = 2+nx(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) XMIN(nset)
+      do i = 0,nx(nset)
+         read(chvec(2+i),*) XV(I,nset)
+      enddo
                                                                         
       Do 11 Iq = 0, NT(nset) 
          TV(Iq,nset) = Log(Log (TV(Iq,nset) /Al(nset))) 
@@ -99,9 +128,16 @@
                                              !*** new version: allows nm
       do ihess = 0,nmem(nset) 
                                                                         
-        Read  (1, '(A)') Line 
-        Read  (1, '(A)') Line 
-        Read  (1, *, IOSTAT=IRET) (UPD(ihess,I,nset), I=1,Npts) 
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat)
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat)
+!        Read  (1, *, IOSTAT=IRET) (UPD(ihess,I,nset), I=1,Npts) 
+         nitem = npts
+         call gzmult(1,chvec,nitem)
+         do i = 1,npts
+            read(chvec(i),*) UPD(ihess,I,nset)
+         enddo
                                                                         
       enddo 
       return 
--- orig.lhapdf/5.8.5/src/wrapcteq65.f	2011-02-15 13:25:28.000000000 +0100
+++ lhapdf/5.8.5/src/wrapcteq65.f	2011-02-15 11:37:53.000000000 +0100
@@ -24,6 +24,11 @@
       common/masses_LHA/cMass(nmxset),bMass(nmxset),tMass(nmxset) 
                                                                         
       data pi / 3.141592653589793d0 / 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      integer nitem
+      character*20 chvec(40000)
       save 
 !                                                                       
       call getnset(iset) 
@@ -123,18 +128,28 @@
       call CtLhbldat2 
                                                                         
       call LHct65set 
-                                                                        
+
                                             !*** nmem+1=number of member
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
+      if(nmem(nset) .gt. nhess) then 
+         print *,'fatal error:  nmem=',nmem(nset),' > nhess=',nhess 
+         stop 
+      endif 
       if(nmem(nset) .gt. nhess) then 
          print *,'fatal error:  nmem=',nmem(nset),' > nhess=',nhess 
          stop 
       endif 
                                                                         
       MxVal = 3 
-      Read  (1, '(A)') Line 
-      Read  (1, '(A)') Line 
-      Read  (1, *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
       Iorder(nset) = Nint(Dr) 
       Nfl(nset) = Nint(Fl) 
       Alambda(nset) = Al(nset) 
@@ -143,17 +158,43 @@
       bMass(nset) = Amass(5,nset) 
       tMass(nset) = Amass(6,nset) 
                                                                         
-      Read  (1, '(A)') Line 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
 !                                               This is the .pds (WKT) f
-      Read  (1, *) N0, N0, N0, NfMx(nset), N0, N0 
-      Read  (1, '(A)') Line 
-      Read  (1, *) NX(nset),  NT(nset), N0, N0, N0 
-      Read  (1, '(A)') (Line,I=1,4) 
-      Read  (1, *)                                                      &
-     &  QINI(nset), QMAX(nset), (aa,TV(I,nset), I =0, NT(nset))         
-                                                                        
-      Read  (1, '(A)') Line 
-      Read  (1, *) XMIN(nset), aa, (XV(I,nset), I =1, NX(nset)) 
+!      Read  (1, *) N0, N0, N0, NfMx(nset), N0, N0 
+      call gzread(1,outline,nbbuf,istat) 
+      read(outline(1:istat),*) N0, N0, N0, NfMx(nset), N0, N0 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat) 
+!      Read  (1, *) NX(nset),  NT(nset), N0, N0, N0 
+      call gzread(1,outline,nbbuf,istat) 
+      read(outline(1:istat),*) NX(nset),  NT(nset), N0, N0, N0 
+!      Read  (1, '(A)') (Line,I=1,4) 
+      call gzread(1,outline,nbbuf,istat) 
+      call gzread(1,outline,nbbuf,istat) 
+      call gzread(1,outline,nbbuf,istat) 
+      call gzread(1,outline,nbbuf,istat) 
+!      Read  (1, *)                                                      &
+!     &  QINI(nset), QMAX(nset), (aa,TV(I,nset), I =0, NT(nset))         
+      nitem = 4+2*nt(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) qini(nset)
+      read(chvec(2),*) qmax(nset)
+      do i = 0, nt(nset)
+         read(chvec(2*i+3),*) aa
+         read(chvec(2*i+4),*) tv(i,nset)
+      enddo
+                                                                        
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat) 
+!      Read  (1, *) XMIN(nset), aa, (XV(I,nset), I =1, NX(nset)) 
+      nitem = 2+nx(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) XMIN(nset)
+      read(chvec(2),*) aa
+      do i = 1,nx(nset)
+         read(chvec(2+i),*) XV(I,nset)
+      enddo
       XV(0,nset)=0D0 
 !                                                                       
 !                  Since quark = anti-quark for nfl>2 at this stage,    
@@ -167,10 +208,17 @@
                                              !*** new version: allows nm
       do ihess = 0,nmem(nset) 
                                                                         
-        Read  (1, '(A)') Line 
-        Read  (1, '(A)') Line 
-        Read  (1, *, IOSTAT=IRET) (UPD(ihess,I,nset), I=1,Npts) 
-                                                                        
+!        Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!        Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!        Read  (1, *, IOSTAT=IRET) (UPD(ihess,I,nset), I=1,Npts) 
+      nitem = npts
+      call gzmult(1,chvec,nitem)
+      do i = 1,npts
+         read(chvec(i),*) UPD(ihess,I,nset)
+      enddo
+      
       enddo 
       return 
 !                                                                       
@@ -181,16 +229,22 @@
       call LHct65set 
                                                                         
                                             !*** nmem+1=number of member
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
       if(nmem(nset) .gt. nhess) then 
          print *,'fatal error:  nmem=',nmem(nset),' > nhess=',nhess 
          stop 
       endif 
                                                                         
       MxVal = 2 
-      Read  (1, '(A)') Line 
-      Read  (1, '(A)') Line 
-      Read  (1, *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
       Iorder(nset) = Nint(Dr) 
       Nfl(nset) = Nint(Fl) 
       Alambda(nset) = Al(nset) 
@@ -199,17 +253,43 @@
       bMass(nset) = Amass(5,nset) 
       tMass(nset) = Amass(6,nset) 
                                                                         
-      Read  (1, '(A)') Line 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
 !                                               This is the .pds (WKT) f
-      Read  (1, *) N0, N0, N0, NfMx(nset), N0, N0 
-      Read  (1, '(A)') Line 
-      Read  (1, *) NX(nset),  NT(nset), N0, N0, N0 
-      Read  (1, '(A)') (Line,I=1,4) 
-      Read  (1, *)                                                      &
-     &  QINI(nset), QMAX(nset), (aa,TV(I,nset), I =0, NT(nset))         
-                                                                        
-      Read  (1, '(A)') Line 
-      Read  (1, *) XMIN(nset), aa, (XV(I,nset), I =1, NX(nset)) 
+!      Read  (1, *) N0, N0, N0, NfMx(nset), N0, N0 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) N0, N0, N0, NfMx(nset), N0, N0 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) NX(nset),  NT(nset), N0, N0, N0 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) NX(nset),  NT(nset), N0, N0, N0 
+!      Read  (1, '(A)') (Line,I=1,4) 
+      call gzread(1,outline,nbbuf,istat)
+      call gzread(1,outline,nbbuf,istat)
+      call gzread(1,outline,nbbuf,istat)
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *)                                                      &
+!     &  QINI(nset), QMAX(nset), (aa,TV(I,nset), I =0, NT(nset))         
+      nitem = 4+2*nt(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) qini(nset)
+      read(chvec(2),*) qmax(nset)
+      do i = 0, nt(nset)
+         read(chvec(2*i+3),*) aa
+         read(chvec(2*i+4),*) TV(I,nset)
+      enddo
+                                                                        
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) XMIN(nset), aa, (XV(I,nset), I =1, NX(nset)) 
+      nitem = 2+nx(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) XMIN(nset)
+      read(chvec(2),*) aa
+      do i = 1, nx(nset)
+         read(chvec(i+2),*) XV(I,nset)
+      enddo
       XV(0,nset)=0D0 
 !                                                                       
 !                  Since quark = anti-quark for nfl>2 at this stage,    
@@ -223,11 +303,18 @@
                                              !*** new version: allows nm
       do ihess = 0,nmem(nset) 
                                                                         
-        Read  (1, '(A)') Line 
-        Read  (1, '(A)') Line 
-        Read  (1, *, IOSTAT=IRET) (UPD(ihess,I,nset), I=1,Npts) 
-                                                                        
-      enddo 
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat) 
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat) 
+!        Read  (1, *, IOSTAT=IRET) (UPD(ihess,I,nset), I=1,Npts) 
+         nitem = npts
+         call gzmult(1,chvec,nitem)
+         do i = 1,npts
+            read(chvec(i),*) UPD(ihess,I,nset)
+         enddo
+         
+      enddo
       return 
 !                                                                       
                                              !like CTEQ65read, but c.ne.
@@ -237,7 +324,9 @@
       call LHct65set 
                                                                         
                                             !*** nmem+1=number of member
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
       if(nmem(nset) .gt. nhess) then 
          print *,'fatal error:  nmem=',nmem(nset),' > nhess=',nhess 
          stop 
@@ -245,9 +334,13 @@
                                                                         
                                                !one more species free   
       MxVal = 4 
-      Read  (1, '(A)') Line 
-      Read  (1, '(A)') Line 
-      Read  (1, *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
       Iorder(nset) = Nint(Dr) 
       Nfl(nset) = Nint(Fl) 
       Alambda(nset) = Al(nset) 
@@ -256,17 +349,43 @@
       bMass(nset) = Amass(5,nset) 
       tMass(nset) = Amass(6,nset) 
                                                                         
-      Read  (1, '(A)') Line 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
 !                                               This is the .pds (WKT) f
-      Read  (1, *) N0, N0, N0, NfMx(nset), N0, N0 
-      Read  (1, '(A)') Line 
-      Read  (1, *) NX(nset),  NT(nset), N0, N0, N0 
-      Read  (1, '(A)') (Line,I=1,4) 
-      Read  (1, *)                                                      &
-     &  QINI(nset), QMAX(nset), (aa,TV(I,nset), I =0, NT(nset))         
-                                                                        
-      Read  (1, '(A)') Line 
-      Read  (1, *) XMIN(nset), aa, (XV(I,nset), I =1, NX(nset)) 
+!      Read  (1, *) N0, N0, N0, NfMx(nset), N0, N0 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) N0, N0, N0, NfMx(nset), N0, N0       
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) NX(nset),  NT(nset), N0, N0, N0 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) NX(nset),  NT(nset), N0, N0, N0 
+!      Read  (1, '(A)') (Line,I=1,4) 
+      call gzread(1,outline,nbbuf,istat)
+      call gzread(1,outline,nbbuf,istat)
+      call gzread(1,outline,nbbuf,istat)
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *)                                                      &
+!     &  QINI(nset), QMAX(nset), (aa,TV(I,nset), I =0, NT(nset))         
+      nitem = 4+2*nt(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) qini(nset)
+      read(chvec(2),*) qmax(nset)
+      do i = 0, nt(nset)
+         read(chvec(2*i+3),*) aa
+         read(chvec(2*i+4),*) tv(i,nset)
+      enddo
+                                                                        
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat) 
+!      Read  (1, *) XMIN(nset), aa, (XV(I,nset), I =1, NX(nset)) 
+      nitem = 2+nx(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) XMIN(nset)
+      read(chvec(2),*) aa
+      do i = 1,nx(nset)
+         read(chvec(2+i),*) XV(I,nset)
+      enddo
       XV(0,nset)=0D0 
 !                                                                       
 ! we Read only the non-redundent data points                            
@@ -277,9 +396,16 @@
                                              !*** new version: allows nm
       do ihess = 0,nmem(nset) 
                                                                         
-        Read  (1, '(A)') Line 
-        Read  (1, '(A)') Line 
-        Read  (1, *, IOSTAT=IRET) (UPD(ihess,I,nset), I=1,Npts) 
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat) 
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat) 
+!        Read  (1, *, IOSTAT=IRET) (UPD(ihess,I,nset), I=1,Npts) 
+         nitem = npts
+         call gzmult(1,chvec,nitem)
+         do i = 1,npts
+            read(chvec(i),*) UPD(ihess,I,nset)
+         enddo
                                                                         
       enddo 
       return 
--- orig.lhapdf/5.8.5/src/wrapcteq6lg.f	2011-02-15 13:25:28.000000000 +0100
+++ lhapdf/5.8.5/src/wrapcteq6lg.f	2011-02-15 12:05:13.000000000 +0100
@@ -28,6 +28,11 @@
      & / Masstbllg / Amass(6,nmxset),Alg(0:nhess)                       
       common/masses_LHA/cMass(nmxset),bMass(nmxset),tMass(nmxset) 
       data pi / 3.141592653589793d0 / 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      integer nitem
+      character*20 chvec(60000)
       save 
 !                                                                       
       call getnset(iset) 
@@ -66,17 +71,24 @@
                                                                         
       call LHct6set 
                                             !*** nmem+1=number of member
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
       if(nmem(nset) .gt. nhess) then 
          print *,'fatal error:  nmem=',nmem(nset),' > nhess=',nhess 
          stop 
       endif 
                                              !*** new version: allows nm
       do ihess = 0,nmem(nset) 
-        Read  (1, '(A)') Line 
-        Read  (1, '(A)') Line 
-        Read  (1, '(A)') Line 
-        Read(1, *)Dr,Fl,Al(ihess,nset),(Amass(I,nset),I=1,6),Alg(ihess) 
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat)
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat)
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat)
+!        Read(1, *)Dr,Fl,Al(ihess,nset),(Amass(I,nset),I=1,6),Alg(ihess) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) Dr,Fl,Al(ihess,nset),(Amass(I,nset),I=1,6),Alg(ihess) 
         Iorder(nset) = Nint(Dr) 
         Nfl(nset) = Nint(Fl) 
         Alambda(ihess,nset) = Al(ihess,nset) 
@@ -85,15 +97,32 @@
         bMass(nset) = Amass(5,nset) 
         tMass(nset) = Amass(6,nset) 
                                                                         
-        Read  (1, '(A)') Line 
-        Read  (1, *) NX(ihess,nset),  NT(ihess,nset), NfMx(ihess,nset) 
-                                                                        
-        Read  (1, '(A)') Line 
-        Read  (1, *)                                                    &
-     &  QINI(nset), QMAX(nset), (TV(ihess,I,nset), I =0, NT(ihess,nset))
-                                                                        
-        Read  (1, '(A)') Line 
-        Read  (1, *) XMIN(nset), (XV(ihess,I,nset), I =0,NX(ihess,nset)) 
+!        Read  (1, '(A)') Line 
+        call gzread(1,outline,nbbuf,istat)
+!        Read  (1, *) NX(ihess,nset),  NT(ihess,nset), NfMx(ihess,nset) 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) NX(ihess,nset),  NT(ihess,nset), NfMx(ihess,nset) 
+!        Read  (1, '(A)') Line 
+        call gzread(1,outline,nbbuf,istat)
+!        Read  (1, *)                                                    &
+!     &  QINI(nset), QMAX(nset), (TV(ihess,I,nset), I =0, NT(ihess,nset))
+        nitem = 3+nt(ihess,nset)
+        call gzmult(1,chvec,nitem)
+        read(chvec(1),*) qini(nset)
+        read(chvec(2),*) qmax(nset)
+        do i = 0, nt(ihess,nset)
+           read(chvec(i+3),*) tv(ihess,i,nset)
+        enddo
+        
+!        Read  (1, '(A)') Line 
+        call gzread(1,outline,nbbuf,istat)
+!        Read  (1, *) XMIN(nset), (XV(ihess,I,nset), I =0,NX(ihess,nset)) 
+        nitem = 1+nx(ihess,nset)
+        call gzmult(1,chvec,nitem)
+        read(chvec(1),*) XMIN(nset)
+        do i = 0,nx(ihess,nset)
+           read(chvec(2+i),*) XV(ihess,I,nset)
+        enddo
         Do 11 Iq = 0, NT(ihess,nset) 
            TV(ihess,Iq,nset) =Log(Log(TV(ihess,Iq,nset)/Al(ihess,nset))) 
    11   Continue 
@@ -107,9 +136,15 @@
                                                                         
                                                                         
 !        Read  (1, '(A)') Line                                          
-        Read  (1, '(A)') Line 
-        Read  (1, *, IOSTAT=IRET) (UPD(ihess,I,nset), I=1,Npts) 
-                                                                        
+        call gzread(1,outline,nbbuf,istat) 
+!        Read  (1, *, IOSTAT=IRET) (UPD(ihess,I,nset), I=1,Npts) 
+        nitem = npts
+        call gzmult(1,chvec,nitem)
+        do i = 1,npts
+           read(chvec(i),*) UPD(ihess,I,nset)
+        enddo
+ 
+                                                                       
       enddo 
       return 
 !                                                                       
--- orig.lhapdf/5.8.5/src/eps08.f	2011-02-15 13:25:27.000000000 +0100
+++ lhapdf/5.8.5/src/eps08.f	2011-02-14 14:18:38.000000000 +0100
@@ -247,6 +247,11 @@
   common/eps0800/qq0, qqb
   common/eps0801/peps08i(197,13,8,5)
   common/eps0802/ amx(13)
+  integer nset,nnset
+  integer istat,nbbuf
+  character*512 outline
+  character*512 compath
+  data nbbuf /512/
   data readFR2/0/
   
   ! Initialise common blocks  
@@ -276,16 +281,26 @@
      call getdirpath(dirpath)
      
      setpath=dirpath(:LEN_TRIM(dirpath))//"/"//'eps08dta.LHgrid'
-     open(11,file=setpath(:LEN_TRIM(setpath)),status='unknown')
+     compath = setpath//".gz" 
+!     open(11,file=setpath(:LEN_TRIM(setpath)),status='unknown')
+     call gzopen(11,'r',compath,istat)
+     if (istat.ne.0) then
+        write(*,*) 'LHAPDF eps08init : unable to open file ',compath,' status = ',istat
+        stop
+     endif
      do ik=1,8
         do ia=1,13
            do ix=1,197
-              read(11,137) peps08i(ix,ia,ik,1), peps08i(ix,ia,ik,2), &
+!              read(11,137) peps08i(ix,ia,ik,1), peps08i(ix,ia,ik,2), &
+!                   peps08i(ix,ia,ik,3), peps08i(ix,ia,ik,4), peps08i(ix,ia,ik,5)
+              call gzread(11,outline,nbbuf,istat)
+              read(outline(1:istat),137) peps08i(ix,ia,ik,1), peps08i(ix,ia,ik,2), &
                    peps08i(ix,ia,ik,3), peps08i(ix,ia,ik,4), peps08i(ix,ia,ik,5)
            enddo
         enddo
      enddo
-     close(11)
+!     close(11)
+     call gzclose(11,istat)
      readFR2=1
   endif
   return
--- orig.lhapdf/5.8.5/src/wrapmrst.f	2009-09-10 10:56:16.000000000 +0200
+++ lhapdf/5.8.5/src/wrapmrst.f	2011-02-16 11:19:26.000000000 +0100
@@ -41,6 +41,11 @@
      &        1.8d4,3.2d4,5.6d4,1d5,1.8d5,3.2d5,5.6d5,1d6,              &
      &        1.8d6,3.2d6,5.6d6,1d7/                                    
       data xmin,xmax,qsqmin,qsqmax/1d-5,1d0,1.25d0,1d7/ 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      integer nitem
+      character*20 chvec(40000)
       save 
                                                                         
       xsave=x 
@@ -144,14 +149,19 @@
       return 
 !                                                                       
       entry MRSTread(nset) 
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
 !      print *,nmem(nset),ndef(nset)                                    
 !      do nm = 0,nmem-1                                                 
       do nm = 0,nmem(nset) 
         do 20 n=1,nx-1 
         do 20 m=1,nq 
-        read(1,50)f1(n,m),f2(n,m),f3(n,m),f4(n,m),                      &
-     &                  f5(n,m),f7(n,m),f6(n,m),f8(n,m)                 
+!        read(1,50)f1(n,m),f2(n,m),f3(n,m),f4(n,m),                      &
+!     &                  f5(n,m),f7(n,m),f6(n,m),f8(n,m)                 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),50)f1(n,m),f2(n,m),f3(n,m),f4(n,m),           &
+      &                  f5(n,m),f7(n,m),f6(n,m),f8(n,m)                    
 ! notation: 1=uval 2=val 3=glue 4=usea 5=chm 6=str 7=btm 8=dsea         
    20 continue 
 !      write(*,*)'PDF set ',nm,' first element ',f1(1,1)                
--- orig.lhapdf/5.8.5/src/wrapmrst2006.f	2008-10-21 13:07:39.000000000 +0200
+++ lhapdf/5.8.5/src/wrapmrst2006.f	2011-02-16 11:28:55.000000000 +0100
@@ -46,6 +46,9 @@
      &     1.8d4,3.2d4,5.6d4,1d5,1.8d5,3.2d5,5.6d5,1d6,                 &
      &     1.8d6,3.2d6,5.6d6,1d7,1.8d7,3.2d7,5.6d7,1d8,                 &
      &     1.8d8,3.2d8,5.6d8,1d9/                                       
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
       save 
                                                                         
       xsave=x 
@@ -134,7 +137,9 @@
 !---------------------------------------------------------------------- 
                                                                         
       entry MRST2006read(nset) 
-         read(1,*)nmem(nset),ndef(nset) 
+!         read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
                                                                         
                                                                         
       do i = 0,nhess 
@@ -143,8 +148,11 @@
         do  n=1,nx-1 
           do  m=1,nq 
 !            print *,i,n,m                                              
-            read(1,50) f1(n,m),f2(n,m),f3(n,m),f4(n,m),                 &
-     &           f5(n,m),f7(n,m),f6(n,m),f8(n,m),f9(n,m)                
+!            read(1,50) f1(n,m),f2(n,m),f3(n,m),f4(n,m),                 &
+!     &           f5(n,m),f7(n,m),f6(n,m),f8(n,m),f9(n,m)                
+             call gzread(1,outline,nbbuf,istat)
+             read(outline(1:istat),50)f1(n,m),f2(n,m),f3(n,m),f4(n,m),           &
+      &                  f5(n,m),f7(n,m),f6(n,m),f8(n,m),f9(n,m)
 !            write(6,50) f1(n,m),f2(n,m),f3(n,m),f4(n,m),               
 !     &           f5(n,m),f7(n,m),f6(n,m),f8(n,m),f9(n,m)               
 !--   Notation:1=upv 2=dnv 3=glu 4=usea 5=chm 6=str 7=bot 8=dsea 9=sbar 
--- orig.lhapdf/5.8.5/src/wrapmrst98.f	2008-10-21 13:07:39.000000000 +0200
+++ lhapdf/5.8.5/src/wrapmrst98.f	2011-02-16 11:31:09.000000000 +0100
@@ -27,6 +27,9 @@
      &        1.8d6,3.2d6,5.6d6,1d7/                                    
       data xmin,xmax,qsqmin,qsqmax/1d-5,1d0,1.25d0,1d7/ 
       data n0/3,4,5,9,9,9,9,9/ 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
       save 
 !                                                                       
       xsave=x 
@@ -86,7 +89,9 @@
       return 
 !                                                                       
       entry MRST98read(nset) 
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
 ! - first resotre the xx array                                          
       do j=1,nx 
         xx(j)=xxin(j) 
@@ -95,7 +100,10 @@
       do nm = 0,nmem(nset) 
         do 20 n=1,nx-1 
         do 20 m=1,nq 
-        read(1,50)f(nm,1,n,m),f(nm,2,n,m),f(nm,3,n,m),f(nm,4,n,m),      &
+!        read(1,50)f(nm,1,n,m),f(nm,2,n,m),f(nm,3,n,m),f(nm,4,n,m),      &
+!     &                  f(nm,5,n,m),f(nm,7,n,m),f(nm,6,n,m),f(nm,8,n,m) 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),50)f(nm,1,n,m),f(nm,2,n,m),f(nm,3,n,m),f(nm,4,n,m),      &
      &                  f(nm,5,n,m),f(nm,7,n,m),f(nm,6,n,m),f(nm,8,n,m) 
 ! notation: 1=uval 2=val 3=glue 4=usea 5=chm 6=str 7=btm 8=dsea         
         do 25 i=1,np 
--- orig.lhapdf/5.8.5/src/wrapmrstqed.f	2010-08-13 13:02:40.000000000 +0200
+++ lhapdf/5.8.5/src/wrapmrstqed.f	2011-02-16 11:37:58.000000000 +0100
@@ -43,6 +43,9 @@
      &        1.8d4,3.2d4,5.6d4,1d5,1.8d5,3.2d5,5.6d5,1d6,              &
      &        1.8d6,3.2d6,5.6d6,1d7/                                    
       data xmin,xmax,qsqmin,qsqmax/1d-5,1d0,1.25d0,1d7/ 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
       save 
              
       xsave=x 
@@ -99,13 +102,18 @@
       return 
 !                                                                       
       entry MRSTqedread(nset) 
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
 !      print *,nmem(nset),ndef(nset)                                    
 !      do nm = 0,nmem-1                                                 
       do nm = 0,nmem(nset) 
         do 20 n=1,nx-1 
         do 20 m=1,nq 
-        read(1,50)f1(n,m),f2(n,m),f3(n,m),f4(n,m),                      &
+!        read(1,50)f1(n,m),f2(n,m),f3(n,m),f4(n,m),                      &
+!     &                  f5(n,m),f7(n,m),f6(n,m),f8(n,m),f9(n,m)         
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),50)f1(n,m),f2(n,m),f3(n,m),f4(n,m),                      &
      &                  f5(n,m),f7(n,m),f6(n,m),f8(n,m),f9(n,m)         
 ! notation: 1=uval 2=val 3=glue 4=usea 5=chm 6=str 7=btm 8=dsea +9 - pho
    20 continue 
--- orig.lhapdf/5.8.5/src/wrapmrst2006-lite.f	2008-10-21 13:07:39.000000000 +0200
+++ lhapdf/5.8.5/src/wrapmrst2006-lite.f	2011-02-16 11:40:52.000000000 +0100
@@ -37,6 +37,10 @@
        emb2minuseps,emb2,2.6d1,4d1,6.4d1,1d2,1.6d2,2.4d2,4d2,6.4d2,1d3,1.8d3,3.2d3,5.6d3, &
        1d4,1.8d4,3.2d4,5.6d4,1d5,1.8d5,3.2d5,5.6d5,1d6,1.8d6,3.2d6,5.6d6,1d7,1.8d7,3.2d7, &
        5.6d7,1d8,1.8d8,3.2d8,5.6d8,1d9/
+  integer istat,nbbuf
+  character*512 outline
+  data nbbuf /512/
+  character*512 compath
   save
 
   xsave=x
@@ -118,12 +122,15 @@
 
   entry MRST2006read(nset)
   ! - dummy read in to get to End: (stream 1 is still open) 
-  read(1,*)nmem(nset),ndef(nset)
+!  read(1,*)nmem(nset),ndef(nset)
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) nmem(nset),ndef(nset) 
   
   do i=0,nmem(nset)
      do n=1,nx-1
         do m=1,nq
-           read(1,'(a)') line
+!           read(1,'(a)') line
+           call gzread(1,outline,nbbuf,istat)
         enddo
      enddo
   enddo
@@ -152,22 +159,35 @@
   
   ! have to reopen stream 1 
   call getsetpath(setpath)
-  open(1,file=setpath(1:len_trim(setpath)))
+  compath = setpath//".gz"
+!  open(1,file=setpath(1:len_trim(setpath)))
+  call gzopen(1,'r',compath,istat)
+  if (istat.ne.0) then
+     write(*,*) 'LHAPDF MRST2006pdf : unable to open file ',compath,' status = ',istat
+     stop
+  endif
   
   line = ''
   do while (line(2:11).ne.'Evolution:') 
-     read(1,'(a)'),line
-  enddo
-  read(1,'(a)'),line
-  read(1,'(a)'),line
-  
-  read(1,*)nmem(iset),ndef(iset)
+!     read(1,'(a)'),line
+     call gzread(1,outline,nbbuf,istat)
+     line = outline(1:istat)
+  enddo
+!  read(1,'(a)'),line
+  call gzread(1,outline,nbbuf,istat)
+!  read(1,'(a)'),line
+  call gzread(1,outline,nbbuf,istat)
+  
+!  read(1,*)nmem(iset),ndef(iset)
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) nmem(iset),ndef(iset) 
   
   ! - dummy read up to the member requested
   do i=0,mem-1
      do n=1,nx-1
         do m=1,nq
-           read(1,'(a)')line
+!           read(1,'(a)')line
+           call gzread(1,outline,nbbuf,istat)
         enddo
      enddo
   enddo
@@ -177,7 +197,9 @@
   do  n=1,nx-1
      do  m=1,nq
         ! print *,i,n,m
-        read(1,50) f1(n,m),f2(n,m),f3(n,m),f4(n,m),f5(n,m),f7(n,m),f6(n,m),f8(n,m),f9(n,m)
+!        read(1,50) f1(n,m),f2(n,m),f3(n,m),f4(n,m),f5(n,m),f7(n,m),f6(n,m),f8(n,m),f9(n,m)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),50)f1(n,m),f2(n,m),f3(n,m),f4(n,m),f5(n,m),f7(n,m),f6(n,m),f8(n,m),f9(n,m)
         ! write(6,50) f1(n,m),f2(n,m),f3(n,m),f4(n,m),f5(n,m),f7(n,m),f6(n,m),f8(n,m),f9(n,m)
         !--   Notation:1=upv 2=dnv 3=glu 4=usea 5=chm 6=str 7=bot 8=dsea 9=sbar
      enddo
@@ -226,7 +248,8 @@
   enddo
   call InitialLHAPDF(i,nhess,nx,nqb,nqc0-nqb0,nqb0-nqb0,xxl,qqlb,fb,ccb)
   
-  close(1)
+!  close(1)
+  call gzclose(1,istat)
  
 50 format(9e13.5)
   
--- orig.lhapdf/5.8.5/src/wrapmrstqed-lite.f	2010-08-13 13:02:40.000000000 +0200
+++ lhapdf/5.8.5/src/wrapmrstqed-lite.f	2011-02-16 11:41:52.000000000 +0100
@@ -45,6 +45,10 @@
      &        1.8d4,3.2d4,5.6d4,1d5,1.8d5,3.2d5,5.6d5,1d6,              &
      &        1.8d6,3.2d6,5.6d6,1d7/                                    
       data xmin,xmax,qsqmin,qsqmax/1d-5,1d0,1.25d0,1d7/ 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      character*512 compath
       save 
             
       xsave=x 
@@ -102,12 +106,15 @@
 !                                                                       
       entry MRSTqedread(nset) 
 ! - dummy read in to get to End: (stream 1 is still open)               
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
 
       do i=0,nmem(nset) 
         do n=1,nx-1 
           do m=1,nq 
-            read(1,'(a)'),line 
+!            read(1,'(a)'),line 
+             call gzread(1,outline,nbbuf,istat)
           enddo 
         enddo 
       enddo 
@@ -126,22 +133,35 @@
         call setnmem(iset,mem) 
                                                                         
 ! have to reopen stream 1                                               
-        call getsetpath(setpath) 
-        open(1,file=setpath(1:len_trim(setpath))) 
+        call getsetpath(setpath)
+        compath = setpath//".gz" 
+!        open(1,file=setpath(1:len_trim(setpath))) 
+        call gzopen(1,'r',compath,istat)
+        if (istat.ne.0) then
+           write(*,*) 'LHAPDF MRSTqedpdf : unable to open file ',compath,' status = ',istat
+           stop
+        endif
         line = '' 
         do while (line(2:11).ne.'Evolution:') 
-           read(1,'(a)'),line 
+!           read(1,'(a)'),line 
+           call gzread(1,outline,nbbuf,istat)
+           line = outline(1:istat)
         enddo 
-        read(1,'(a)'),line 
-        read(1,'(a)'),line 
-                                                                        
-        read(1,*)nmem(iset),ndef(iset) 
+!        read(1,'(a)'),line 
+        call gzread(1,outline,nbbuf,istat)
+!        read(1,'(a)'),line 
+        call gzread(1,outline,nbbuf,istat)
+                                                                        
+!        read(1,*)nmem(iset),ndef(iset) 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) nmem(iset),ndef(iset) 
                                                                         
 ! - dummy read up to the member requested                               
       do i=0,mem-1 
         do n=1,nx-1 
           do m=1,nq 
-            read(1,'(a)')line 
+!            read(1,'(a)')line 
+             call gzread(1,outline,nbbuf,istat)
           enddo 
         enddo 
       enddo 
@@ -150,7 +170,10 @@
 !- read in the data of the requested member                             
         do 20 n=1,nx-1 
         do 20 m=1,nq 
-        read(1,50)f1(n,m),f2(n,m),f3(n,m),f4(n,m),                      &
+!        read(1,50)f1(n,m),f2(n,m),f3(n,m),f4(n,m),                      &
+!     &                  f5(n,m),f7(n,m),f6(n,m),f8(n,m),f9(n,m)                 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),50)f1(n,m),f2(n,m),f3(n,m),f4(n,m),                      &
      &                  f5(n,m),f7(n,m),f6(n,m),f8(n,m),f9(n,m)                 
 ! notation: 1=uval 2=val 3=glue 4=usea 5=chm 6=str 7=btm 8=dsea 9-photon         
    20 continue 
@@ -195,7 +218,8 @@
       qqlb(1)=dlog(emb2) 
       call jeppe1(0,nx,nqb,xxl,qqlb,fb,ccb(0,1,1,1,1,iset)) 
                                                                         
-      close(1) 
+!      close(1) 
+      call gzclose(1,istat)
    50 format(9f10.5) 
                                                                         
                                                                         
--- orig.lhapdf/5.8.5/src/wrapmrst-lite.f	2010-02-18 16:48:15.000000000 +0100
+++ lhapdf/5.8.5/src/wrapmrst-lite.f	2011-02-16 11:59:12.000000000 +0100
@@ -43,6 +43,10 @@
      &        1.8d4,3.2d4,5.6d4,1d5,1.8d5,3.2d5,5.6d5,1d6,              &
      &        1.8d6,3.2d6,5.6d6,1d7/                                    
       data xmin,xmax,qsqmin,qsqmax/1d-5,1d0,1.25d0,1d7/ 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      character*512 compath
       save 
                                                                         
       xsave=x 
@@ -147,12 +151,15 @@
 !                                                                       
       entry MRSTread(nset) 
 ! - dummy read in to get to End: (stream 1 is still open)               
-        read(1,*)nmem(nset),ndef(nset) 
+!        read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
                                                                         
         do i=0,nmem(nset) 
           do n=1,nx-1 
             do m=1,nq 
-              read(1,'(a)'),line 
+!              read(1,'(a)'),line 
+              call gzread(1,outline,nbbuf,istat)
             enddo 
           enddo 
         enddo 
@@ -185,21 +192,34 @@
                                                                         
 ! have to reopen stream 1                                               
         call getsetpath(setpath) 
-        open(1,file=setpath(1:len_trim(setpath))) 
+        compath = setpath//".gz"
+!        open(1,file=setpath(1:len_trim(setpath))) 
+        call gzopen(1,'r',compath,istat)
+        if (istat.ne.0) then
+           write(*,*) 'LHAPDF MRSTpdf : unable to open file ',compath,' status = ',istat
+           stop
+        endif
         line = '' 
         do while (line(2:11).ne.'Evolution:') 
-           read(1,'(a)'),line 
+!           read(1,'(a)'),line 
+           call gzread(1,outline,nbbuf,istat)
+           line = outline(1:istat)
         enddo 
-        read(1,'(a)'),line 
-        read(1,'(a)'),line 
-                                                                        
-        read(1,*)nmem(iset),ndef(iset) 
+!        read(1,'(a)'),line 
+        call gzread(1,outline,nbbuf,istat)
+!        read(1,'(a)'),line 
+        call gzread(1,outline,nbbuf,istat)
+                                                                        
+!        read(1,*)nmem(iset),ndef(iset) 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) nmem(iset),ndef(iset) 
                                                                         
 ! - dummy read up to the member requested                               
       do i=0,mem-1 
         do n=1,nx-1 
           do m=1,nq 
-            read(1,'(a)')line 
+!            read(1,'(a)')line 
+             call gzread(1,outline,nbbuf,istat)
           enddo 
         enddo 
       enddo 
@@ -208,7 +228,10 @@
 !- read in the data of the requested member                             
         do 20 n=1,nx-1 
         do 20 m=1,nq 
-        read(1,50)f1(n,m),f2(n,m),f3(n,m),f4(n,m),                      &
+!        read(1,50)f1(n,m),f2(n,m),f3(n,m),f4(n,m),                      &
+!     &                  f5(n,m),f7(n,m),f6(n,m),f8(n,m)                 
+           call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),50)f1(n,m),f2(n,m),f3(n,m),f4(n,m),                      &
      &                  f5(n,m),f7(n,m),f6(n,m),f8(n,m)                 
 ! notation: 1=uval 2=val 3=glue 4=usea 5=chm 6=str 7=btm 8=dsea         
    20 continue 
@@ -251,7 +274,8 @@
       qqlb(1)=dlog(emb2) 
       call jeppe1(0,nx,nqb,xxl,qqlb,fb,ccb(0,1,1,1,1,iset)) 
                                                                         
-      close(1) 
+!      close(1) 
+      call gzclose(1,istat)
    50 format(8f10.5) 
                                                                         
                                                                         
--- orig.lhapdf/5.8.5/src/wrapNNPDF.f	2010-07-09 10:59:42.000000000 +0200
+++ lhapdf/5.8.5/src/wrapNNPDF.f	2011-02-16 14:00:38.000000000 +0100
@@ -52,6 +52,9 @@
       COMMON/nnpdf10vfns/q2th,asref,q2ref
       REAL*8 as0,asc,asb,ast,asq
       COMMON/nnpdf10AS/ as0,asc,asb,ast,asq
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
 !
       q2    = q**2.                ! for the commons
       qq2   = q**2.
@@ -74,7 +77,9 @@
       ENTRY NNPDFread(nset)
 !
 !     Read evol params from NNPDF08.LHpdf
-      READ(1,*) ivfn,imodev,itmc,niter,xmin,xm1,xm2,xmax,epsevol
+!      READ(1,*) ivfn,imodev,itmc,niter,xmin,xm1,xm2,xmax,epsevol
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) ivfn,imodev,itmc,niter,xmin,xm1,xm2,xmax,epsevol
 !
       RETURN
 
--- orig.lhapdf/5.8.5/src/wrapNNPDF20grid.f	2010-07-23 23:24:54.000000000 +0200
+++ lhapdf/5.8.5/src/wrapNNPDF20grid.f	2011-02-16 14:11:46.000000000 +0100
@@ -69,6 +69,9 @@
       double precision dy,x1,x2,y,x1a(mmax),x2a(nmax),ya(mmax,nmax) 
       integer ix1a(m),ix2a(n)
       integer offset
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
 !                                                                       
       KREP = mmem 
                                                                         
@@ -205,35 +208,51 @@
                                                                         
       ENTRY NNPDFINT20read(nset) 
 !                                                                       
-      READ(1,*)nmem(nset),ndef(nset) 
+!      READ(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
                                                                         
 !     Set number of members                                             
       call setnmem(nset,nmem) 
                                                                         
 !     Read the grid in x                                                
-      READ(1,*) nxx 
+!      READ(1,*) nxx 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nxx
       IF(NXX.NE.NX)WRITE(*,*)"WARNING CHANGE NX ACCORDING TO .LHgrid"
       DO ix = 1,nxx 
-         READ(1,*) xg(ix,nset) 
+!         READ(1,*) xg(ix,nset) 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) xg(ix,nset)  
       ENDDO 
                                                                         
 !     Read the grid in Q2                                               
-      READ(1,*) nqq2 
+!      READ(1,*) nqq2 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nqq2
       IF(NQQ2.NE.NQ2)WRITE(*,*)"WARNING CHANGE NQ2 ACCORDING TO .LHgrid"
-      READ(1,*) q2min 
+!      READ(1,*) q2min 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) q2min
       DO iq2 = 1,nqq2 
-         READ(1,*) q2g(iq2,nset) 
+!         READ(1,*) q2g(iq2,nset) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) q2g(iq2,nset) 
       ENDDO 
                                                                         
 !     Read the number of replicas                                       
-      READ(1,*) NREP 
+!      READ(1,*) NREP 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nrep
                                                                         
 !     Read the evolved xpdf grid for each replica                       
       offset = 101*(nset-1)
       DO K=0,NREP 
          DO IX=1,NX 
             DO IQ2=1,NQ2 
-               READ(1,*) ( xpdfev(ix,iq2,ipdf,k+offset), ipdf=-6,6,1 ) 
+!               READ(1,*) ( xpdfev(ix,iq2,ipdf,k+offset), ipdf=-6,6,1 ) 
+              call gzread(1,outline,nbbuf,istat)
+              read(outline(1:istat),*) ( xpdfev(ix,iq2,ipdf,k+offset), ipdf=-6,6,1 ) 
             ENDDO 
          ENDDO 
       ENDDO 
--- orig.lhapdf/5.8.5/src/wrapNNPDFgrid.f	2010-07-25 19:48:23.000000000 +0200
+++ lhapdf/5.8.5/src/wrapNNPDFgrid.f	2011-02-16 14:07:39.000000000 +0100
@@ -70,6 +70,9 @@
       double precision dy,x1,x2,y,x1a(mmax),x2a(nmax),ya(mmax,nmax) 
       integer ix1a(m),ix2a(n)
       integer offset 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
 !                                                                       
       KREP = mmem 
                                                                         
@@ -233,35 +236,51 @@
                                                                         
       ENTRY NNPDFINTread(nset) 
 !                                                                       
-      READ(1,*)nmem(nset),ndef(nset) 
+!      READ(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
                                                                         
 !     Set number of members                                             
       call setnmem(nset,nmem) 
                                                                         
 !     Read the grid in x                                                
-      READ(1,*) nxx 
+!      READ(1,*) nxx 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nxx
       IF(NXX.NE.NX)WRITE(*,*)"WARNING CHANGE NX ACCORDING TO .LHgrid"
       DO ix = 1,nxx 
-         READ(1,*) xg(ix,nset) 
+!         READ(1,*) xg(ix,nset) 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) xg(ix,nset)  
       ENDDO 
                                                                         
 !     Read the grid in Q2                                               
-      READ(1,*) nqq2 
+!      READ(1,*) nqq2 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nqq2
       IF(NQQ2.NE.NQ2)WRITE(*,*)"WARNING CHANGE NQ2 ACCORDING TO .LHgrid"
-      READ(1,*) q2min 
+!      READ(1,*) q2min 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) q2min
       DO iq2 = 1,nqq2 
-         READ(1,*) q2g(iq2,nset) 
+!         READ(1,*) q2g(iq2,nset) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) q2g(iq2,nset) 
       ENDDO 
                                                                         
 !     Read the number of replicas                                       
-      READ(1,*) NREP 
+!      READ(1,*) NREP 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nrep
                                                                         
 !     Read the evolved xpdf grid for each replica 
       offset = 101*(nset-1)                      
       DO K=0,NREP 
          DO IX=1,NX 
             DO IQ2=1,NQ2 
-               READ(1,*) tmp
+!               READ(1,*) tmp
+              call gzread(1,outline,nbbuf,istat)
+              read(outline(1:istat),*) tmp
 !               write (*,*) ix,iq2,ipdf,k,tmp(7)
                DO ipdf=-6,6,1
                   xpdfev(ix,iq2,ipdf,k+offset) = tmp(ipdf+7)
--- orig.lhapdf/5.8.5/src/eps09.f	2011-02-05 08:56:10.000000000 +0100
+++ lhapdf/5.8.5/src/eps09.f	2011-02-16 17:05:17.000000000 +0100
@@ -114,6 +114,10 @@
       Integer :: psetlast = -10, Alast = -10, orderlast = -10
  
       character*512 dirpath,setpath
+      integer istat,nbbuf
+      character*512 outline
+      character*512 compath
+      data nbbuf /512/
 
       save Alast
       save psetlast
@@ -203,7 +207,13 @@
       call getdirpath(dirpath) 
       setpath=dirpath(:LEN_TRIM(dirpath))//"/"//filenimi(:LEN_TRIM(filenimi))//".LHgrid"
       print *,setpath(:LEN_TRIM(setpath))
-      OPEN (11, file = setpath(:LEN_TRIM(setpath)), status='OLD', IOSTAT=iovar)
+      compath = setpath//".gz"
+!     OPEN (11, file = setpath(:LEN_TRIM(setpath)), status='OLD', IOSTAT=iovar)
+      call gzopen(1,'r',compath,istat)
+      if (istat.ne.0) then
+        write(*,*) 'LHAPDF EPS09 : unable to open file ',compath,' status = ',istat
+        stop
+      endif
 
       If (iovar .NE. 0) Then
       Write(*,*) 'Missing file: ',filenimi
@@ -214,18 +224,22 @@
 
       Do k = 0,50
 
-      Read(11,*) dummy
+!      Read(11,*) dummy
+        call gzread(11,outline,nbbuf,istat)
 
       Do t = 0,50
 
-      Read(11,*) (allvalues(setnumber,p,k,t), p=1,8)
+!      Read(11,*) (allvalues(setnumber,p,k,t), p=1,8)
+       call gzread(11,outline,nbbuf,istat)
+       read(outline(1:istat),*) (allvalues(setnumber,p,k,t), p=1,8)
 
       End Do
       End Do
 
       End Do
 
-      Close(11)
+!      Close(11)
+      call gzclose(11,istat)
 
       psetlast  = pset
       Alast     = A
--- orig.lhapdf/5.8.5/src/wrapEVLCTEQ.f	2008-10-21 13:07:39.000000000 +0200
+++ lhapdf/5.8.5/src/wrapEVLCTEQ.f	2011-02-17 13:36:49.000000000 +0100
@@ -15,6 +15,9 @@
       integer nflavor,Eorder,j,nx,nq 
       integer nset 
       data pi / 3.141592653589793d0 / 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
       external parmflavor 
       save nflavor,xmin,qmax,anx,anq 
                                                                         
@@ -70,7 +73,9 @@
       entry EVLCTEQread(nset) 
       call CtLhbldat1 
       call CtLhbldat2 
-      read(1,*) xmin,qmax,nx,nq 
+!      read(1,*) xmin,qmax,nx,nq 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) xmin,qmax,nx,nq 
       anx=nx 
       anq=nq-1 
       return 
--- orig.lhapdf/5.8.5/src/wrapa02m.f	2009-02-16 14:49:44.000000000 +0100
+++ lhapdf/5.8.5/src/wrapa02m.f	2011-02-17 13:43:48.000000000 +0100
@@ -23,6 +23,9 @@
       real*8 pdfs(0:np),fset(-6:6),alfas 
       real*8 x,Q,xb,q2,xmin,xmax,qsq,qsqmin,qsqmax,b,ss 
       real*8 aa,f0,fp,fm 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
       data xmin,xmax,qsqmin,qsqmax/1d-7,1d0,0.8d0,2d8/ 
                                                                         
       save f,npdf,npar,pdfmem,dels,delx,x1,delx1,xlog1,nxbb,xx          &
@@ -109,13 +112,17 @@
       ndef(nset) = 0 
                                                                         
                                                                         
-      read(1,*) npdf 
+!      read(1,*) npdf 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) npdf
 !      print *,'number of members',npdf                                 
       npar=nvar 
       do k=0,npar 
          do n=1,nxb-1 
             do m=1,nq 
-               read(1,*) (f(k,n,m,i),i=0,npdf) 
+!               read(1,*) (f(k,n,m,i),i=0,npdf) 
+               call gzread(1,outline,nbbuf,istat)
+               read(outline(1:istat),*) (f(k,n,m,i),i=0,npdf) 
 !               print 100,(f(k,n,m,i),i=0,npdf)                         
             enddo 
          enddo 
--- orig.lhapdf/5.8.5/src/wrapa02m-lite.f	2009-02-16 14:49:44.000000000 +0100
+++ lhapdf/5.8.5/src/wrapa02m-lite.f	2011-02-17 14:24:16.000000000 +0100
@@ -26,6 +26,10 @@
       real*8 pdfs(0:np),fset(-6:6),alfas 
       real*8 x,Q,xb,q2,xmin,xmax,qsq,qsqmin,qsqmax,b,ss 
       real*8 aa,f0,fp,fm 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      character*512 compath
       data xmin,xmax,qsqmin,qsqmax/1d-7,1d0,0.8d0,2d8/ 
                                                                         
       save f,npdf,npar,pdfmem,dels,delx,x1,delx1,xlog1,nxbb,xx          &
@@ -112,12 +116,16 @@
       nmem(nset) = nvar2 
       ndef(nset) = 0 
 ! - dummy read in to get to End: (stream 1 is still open)               
-      read(1,*) npdf 
+!      read(1,*) npdf 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) npdf
       npar=nvar2 
       do k=0,npar 
          do n=1,nxb-1 
             do m=1,nq 
-               read(1,*) (f(k,n,m,i),i=0,npdf) 
+!               read(1,*) (f(k,n,m,i),i=0,npdf) 
+               call gzread(1,outline,nbbuf,istat)
+               read(outline(1:istat),*) (f(k,n,m,i),i=0,npdf) 
             enddo 
          enddo 
       enddo 
@@ -147,29 +155,45 @@
       
 ! have to reopen stream 1                                               
       call getsetpath(setpath) 
-      open(1,file=setpath(1:len_trim(setpath))) 
+!      open(1,file=setpath(1:len_trim(setpath))) 
+      compath = setpath//".gz" 
+      call gzopen(1,'r',compath,istat)
+      if (istat.ne.0) then
+         write(*,*) 'LHAPDF A02Mpdf : unable to open file ',compath,' status = ',istat
+         stop
+      endif
       line = '' 
       do while (line(2:11).ne.'Evolution:') 
-         read(1,'(a)') line 
+!         read(1,'(a)') line 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),'(a)') line
       enddo 
-      read(1,'(a)'),line 
-      read(1,'(a)'),line 
+!      read(1,'(a)'),line 
+      call gzread(1,outline,nbbuf,istat)
+!      read(1,'(a)'),line 
+      call gzread(1,outline,nbbuf,istat)
                                                                         
                                                                         
-      read(1,*) npdf 
+!      read(1,*) npdf 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) npdf
 !      print *,'number of members',npdf                                 
       npar=nvar2 
       do k=0,imem-1 
          do n=1,nxb-1 
             do m=1,nq 
-               read(1,*) (f(0,n,m,i),i=0,npdf) 
+!               read(1,*) (f(0,n,m,i),i=0,npdf) 
+               call gzread(1,outline,nbbuf,istat)
+               read(outline(1:istat),*) (f(0,n,m,i),i=0,npdf) 
             enddo 
          enddo 
       enddo 
 
       do n=1,nxb-1 
          do m=1,nq 
-            read(1,*) (f(0,n,m,i),i=0,npdf) 
+!            read(1,*) (f(0,n,m,i),i=0,npdf) 
+            call gzread(1,outline,nbbuf,istat)
+            read(outline(1:istat),*) (f(0,n,m,i),i=0,npdf) 
          enddo 
       enddo 
 
@@ -210,7 +234,8 @@
           end do 
         end do 
       end do 
-      close(1)
+!      close(1)
+      call gzclose(1,istat)
       return 
 
       END                                           
--- orig.lhapdf/5.8.5/src/wrapabfkwpi.f	2009-02-16 14:49:44.000000000 +0100
+++ lhapdf/5.8.5/src/wrapabfkwpi.f	2011-02-17 14:08:14.000000000 +0100
@@ -13,6 +13,9 @@
       integer nmem(nmxset),ndef(nmxset),mmem 
       common/NAME/name,nmem,ndef,mmem 
       integer nset 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
       save 
                                                                         
       iimem = imem 
@@ -39,24 +42,50 @@
       return 
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
       entry ABFKWPread(nset) 
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
 !      print *,nmem,ndef                                                
       lastmem = -999 
       do j=1,3 
-        read(1,*)(parpi(k,j),k=1,4) 
-        read(1,*)(parpi(k,j),k=5,8) 
-        read(1,*)(parpi(k,j),k=9,12) 
-        read(1,*)(parpi(k,j),k=13,16) 
-        read(1,*)(parpi(k,j),k=17,20) 
-        read(1,*)(parpi(k,j),k=21,24) 
-        read(1,*)(parpi(k,j),k=25,28) 
-        read(1,*)(parpi(k,j),k=29,32) 
-        read(1,*)(parpi(k,j),k=33,36) 
-        read(1,*)(parpi(k,j),k=37,40) 
+!        read(1,*)(parpi(k,j),k=1,4) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) (parpi(k,j),k=1,4) 
+!         read(1,*)(parpi(k,j),k=5,8) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) (parpi(k,j),k=5,8) 
+!         read(1,*)(parpi(k,j),k=9,12) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) (parpi(k,j),k=9,12) 
+!         read(1,*)(parpi(k,j),k=13,16) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) (parpi(k,j),k=13,16) 
+!         read(1,*)(parpi(k,j),k=17,20) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) (parpi(k,j),k=17,20) 
+!         read(1,*)(parpi(k,j),k=21,24) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) (parpi(k,j),k=21,24) 
+!         read(1,*)(parpi(k,j),k=25,28) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) (parpi(k,j),k=25,28) 
+!         read(1,*)(parpi(k,j),k=29,32) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) (parpi(k,j),k=29,32) 
+!         read(1,*)(parpi(k,j),k=33,36) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) (parpi(k,j),k=33,36) 
+!         read(1,*)(parpi(k,j),k=37,40) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) (parpi(k,j),k=37,40) 
         do l=1,25 
           do k=1,20 
-            read(1,*)(CALCPI(m,k,l,j),m=1,4) 
-            read(1,*)(CALCPI(m,k,l,j),m=5,8) 
+!            read(1,*)(CALCPI(m,k,l,j),m=1,4) 
+             call gzread(1,outline,nbbuf,istat)
+             read(outline(1:istat),*) (CALCPI(m,k,l,j),m=1,4) 
+!            read(1,*)(CALCPI(m,k,l,j),m=5,8) 
+             call gzread(1,outline,nbbuf,istat)
+             read(outline(1:istat),*) (CALCPI(m,k,l,j),m=5,8) 
           enddo 
         enddo 
       enddo 
--- orig.lhapdf/5.8.5/src/wrapabkm09.f	2010-07-20 22:18:46.000000000 +0200
+++ lhapdf/5.8.5/src/wrapabkm09.f	2011-02-17 14:11:53.000000000 +0100
@@ -20,6 +20,9 @@
       real*8 aa,f0,fp,fm
       real*8 pdfs0(0:np),pdfsp(0:np),pdfsm(0:np),q2plus,q2minus,q2zero
       real*8 q2mat,delq2,f2p,f2pp,aq2,bq2,cq2
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
       data xmin,xmax,qsqmin,qsqmax/1d-7,1d0,0.8d0,2d8/
       data q2mat /1d0/
 
@@ -180,13 +183,17 @@
       ndef(nset) = 0
 
 
-      read(1,*) npdf
+!      read(1,*) npdf
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) npdf
       !print *,'number of members',npdf
       npar=nvar
       do k=0,npar
          do n=1,nxb-1
             do m=1,nq
-               read(1,*) (f(k,n,m,i),i=0,npdf)
+!               read(1,*) (f(k,n,m,i),i=0,npdf)
+               call gzread(1,outline,nbbuf,istat)
+               read(outline(1:istat),*) (f(k,n,m,i),i=0,npdf) 
 !	       print 100,(f(k,n,m,i),i=0,npdf)
             enddo
          enddo
--- orig.lhapdf/5.8.5/src/wrapdgg.f	2008-10-21 13:07:39.000000000 +0200
+++ lhapdf/5.8.5/src/wrapdgg.f	2011-02-17 14:40:16.000000000 +0100
@@ -9,6 +9,9 @@
       integer nmem(nmxset),ndef(nmxset),mmem 
       common/NAME/name,nmem,ndef,mmem 
       integer nset,iset 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
                                                                         
       save 
       call getnset(iset) 
@@ -47,7 +50,9 @@
       return 
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
       entry DGGread(nset) 
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
       return 
 !                                                                       
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
--- orig.lhapdf/5.8.5/src/wrapdog.f	2008-10-21 13:07:39.000000000 +0200
+++ lhapdf/5.8.5/src/wrapdog.f	2011-02-17 14:41:15.000000000 +0100
@@ -9,6 +9,9 @@
       integer nmem(nmxset),ndef(nmxset),mmem 
       common/NAME/name,nmem,ndef,mmem 
       integer ns 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
                                                                         
       save 
                                                                         
@@ -51,7 +54,9 @@
       return 
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
       entry DOGread(nset) 
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
       return 
 !                                                                       
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
--- orig.lhapdf/5.8.5/src/wrapgjr.f	2010-03-11 15:56:24.000000000 +0100
+++ lhapdf/5.8.5/src/wrapgjr.f	2011-02-17 14:46:31.000000000 +0100
@@ -40,6 +40,9 @@
      &  1d5,1.25d5,1.6d5,2d5,2.5d5,3.16d5,4d5,5d5,6.3d5,8d5, &
      &  1d6,1.25d6,1.6d6,2d6,2.5d6,3.16d6,4d6,5d6,6.3d6,8d6, &
      &  1d7,1.25d7,1.6d7,2d7,2.5d7,3.16d7,4d7,5d7,6.3d7,8d7,1d8/
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
 
       save 
       x=xin
@@ -80,7 +83,9 @@
       entry GJRread(nset)
 !     
       call getnmem(nset,imem) 
-      read(1,*)nmem(nset),ndef(nset)
+!      read(1,*)nmem(nset),ndef(nset)
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset)
       lstart = -3
       if(name(nset)(1:7).eq.'GJR08VF') lstart=-5
       do i=0,nmem(nset)
@@ -90,12 +95,21 @@
         do k=1,99
          if(name(nset)(1:7).eq.'GJR08VF'.or. &
      &      name(nset)(1:7).eq.'GJR08LO') then
-           read(1,*) fgrid(j,k,-5,i),fgrid(j,k,-4,i), &
+!           read(1,*) fgrid(j,k,-5,i),fgrid(j,k,-4,i), &
+!     &  	   fgrid(j,k,-3,i),fgrid(j,k,-2,i),fgrid(j,k,-1,i), &
+!     &  	   fgrid(j,k,0,i),fgrid(j,k,1,i),fgrid(j,k,2,i), &
+!     &  	   fgrid(j,k,3,i)
+           call gzread(1,outline,nbbuf,istat)
+           read(outline(1:istat),*) fgrid(j,k,-5,i),fgrid(j,k,-4,i), &
      &  	   fgrid(j,k,-3,i),fgrid(j,k,-2,i),fgrid(j,k,-1,i), &
      &  	   fgrid(j,k,0,i),fgrid(j,k,1,i),fgrid(j,k,2,i), &
      &  	   fgrid(j,k,3,i)
          else
-          read(1,*) fgrid(j,k,-3,i),fgrid(j,k,-2,i),fgrid(j,k,-1,i), &
+!          read(1,*) fgrid(j,k,-3,i),fgrid(j,k,-2,i),fgrid(j,k,-1,i), &
+!     &  	   fgrid(j,k,0,i),fgrid(j,k,1,i),fgrid(j,k,2,i), &
+!     &  	    fgrid(j,k,3,i)
+           call gzread(1,outline,nbbuf,istat)
+           read(outline(1:istat),*) fgrid(j,k,-3,i),fgrid(j,k,-2,i),fgrid(j,k,-1,i), &
      &  	   fgrid(j,k,0,i),fgrid(j,k,1,i),fgrid(j,k,2,i), &
      &  	    fgrid(j,k,3,i)
          endif
--- orig.lhapdf/5.8.5/src/wrapgrvg.f	2008-10-21 13:07:39.000000000 +0200
+++ lhapdf/5.8.5/src/wrapgrvg.f	2011-02-17 15:08:02.000000000 +0100
@@ -9,6 +9,9 @@
       integer nmem(nmxset),ndef(nmxset),mmem 
       common/NAME/name,nmem,ndef,mmem 
       integer nset 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
                                                                         
       save 
                                                                         
@@ -68,7 +71,9 @@
       return 
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
       entry GRVGread(nset) 
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
       return 
 !                                                                       
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
--- orig.lhapdf/5.8.5/src/wrapgrvpi.f	2008-10-21 13:07:39.000000000 +0200
+++ lhapdf/5.8.5/src/wrapgrvpi.f	2011-02-17 15:11:11.000000000 +0100
@@ -9,6 +9,9 @@
       integer nmem(nmxset),ndef(nmxset),mmem 
       common/NAME/name,nmem,ndef,mmem 
       integer nset 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
                                                                         
       save 
                                                                         
@@ -52,7 +55,9 @@
 !                                                                       
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
       entry GRVPread(nset) 
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
       return 
 !                                                                       
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
--- orig.lhapdf/5.8.5/src/wrapgsg.f	2008-10-21 13:07:39.000000000 +0200
+++ lhapdf/5.8.5/src/wrapgsg.f	2011-02-17 15:16:52.000000000 +0100
@@ -12,6 +12,9 @@
       integer nmem(nmxset),ndef(nmxset),mmem 
       common/NAME/name,nmem,ndef,mmem 
       integer nset 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
       save 
                                                                         
       call getnset(iset) 
@@ -63,11 +66,15 @@
       return 
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
       entry GSGread(nset) 
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(nset),ndef(nset) 
       do j=1,3 
       do k=1,78 
       do m=1,11 
-         read(1,*)SIG(k,m,j),QNS(k,m,j),GL(k,m,j) 
+!         read(1,*)SIG(k,m,j),QNS(k,m,j),GL(k,m,j) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*)SIG(k,m,j),QNS(k,m,j),GL(k,m,j) 
       enddo 
       enddo 
       enddo 
--- orig.lhapdf/5.8.5/src/wrapgsg96.f	2008-10-21 13:07:39.000000000 +0200
+++ lhapdf/5.8.5/src/wrapgsg96.f	2011-02-17 15:21:27.000000000 +0100
@@ -11,6 +11,9 @@
       integer nmem(nmxset),ndef(nmxset),mmem 
       common/NAME/name,nmem,ndef,mmem 
       integer nset 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
                                                                         
       save 
                                                                         
@@ -59,23 +62,43 @@
       return 
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
       entry GSG96read(nset) 
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(nset),ndef(nset) 
                                                                         
       do m = 1,2 
       do k = 1,78 
-        read(1,*)(sig(k,j,m),j=1,4) 
-        read(1,*)(sig(k,j,m),j=5,8) 
-        read(1,*)(sig(k,j,m),j=9,11) 
+!        read(1,*)(sig(k,j,m),j=1,4) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*)(sig(k,j,m),j=1,4) 
+!        read(1,*)(sig(k,j,m),j=5,8) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*)(sig(k,j,m),j=5,8) 
+!        read(1,*)(sig(k,j,m),j=9,11) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*)(sig(k,j,m),j=9,11) 
       enddo 
       do k = 1,78 
-        read(1,*)(qns(k,j,m),j=1,4) 
-        read(1,*)(qns(k,j,m),j=5,8) 
-        read(1,*)(qns(k,j,m),j=9,11) 
+!        read(1,*)(qns(k,j,m),j=1,4) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*)(qns(k,j,m),j=1,4) 
+!        read(1,*)(qns(k,j,m),j=5,8) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*)(qns(k,j,m),j=5,8) 
+!        read(1,*)(qns(k,j,m),j=9,11) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*)(qns(k,j,m),j=9,11) 
       enddo 
       do k = 1,78 
-        read(1,*)(gl(k,j,m),j=1,4) 
-        read(1,*)(gl(k,j,m),j=5,8) 
-        read(1,*)(gl(k,j,m),j=9,11) 
+!        read(1,*)(gl(k,j,m),j=1,4) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*)(gl(k,j,m),j=1,4) 
+!        read(1,*)(gl(k,j,m),j=5,8) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*)(gl(k,j,m),j=5,8) 
+!        read(1,*)(gl(k,j,m),j=9,11) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*)(gl(k,j,m),j=9,11) 
       enddo 
       enddo 
       return 
--- orig.lhapdf/5.8.5/src/wraplacg.f	2009-02-16 14:49:44.000000000 +0100
+++ lhapdf/5.8.5/src/wraplacg.f	2011-02-17 17:14:41.000000000 +0100
@@ -8,6 +8,9 @@
       integer nmem(nmxset),ndef(nmxset),mmem 
       common/NAME/name,nmem,ndef,mmem 
       integer nset 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
       save 
                                                                         
       q2in=qin*qin 
@@ -33,7 +36,9 @@
       return 
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
       entry LACGread(nset) 
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(nset),ndef(nset) 
       return 
 !                                                                       
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
--- orig.lhapdf/5.8.5/src/wrapowpi.f	2008-10-21 13:07:39.000000000 +0200
+++ lhapdf/5.8.5/src/wrapowpi.f	2011-02-17 17:19:34.000000000 +0100
@@ -12,6 +12,9 @@
       integer nset 
 !      integer iset,iimem                                               
 !      common/SET/iset,iimem                                            
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
                                                                         
       save 
                                                                         
@@ -45,7 +48,9 @@
 !                                                                       
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
       entry OWPread(nset) 
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(nset),ndef(nset) 
 !      iset = nset                                                      
       return 
 !                                                                       
--- orig.lhapdf/5.8.5/src/wrapsasg.f	2008-10-21 13:07:39.000000000 +0200
+++ lhapdf/5.8.5/src/wrapsasg.f	2011-02-17 17:21:28.000000000 +0100
@@ -9,6 +9,9 @@
       common/NAME/name,nmem,ndef,mmem 
       integer nset 
       real*8 upv,dnv,usea,dsea,str,chm,bot,top,glu 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
                                                                         
       save 
       call getnset(iset) 
@@ -39,7 +42,9 @@
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
       entry SASGread(nset) 
 !      print *,'calling SASGread'                                       
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(nset),ndef(nset) 
       return 
 !                                                                       
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
--- orig.lhapdf/5.8.5/src/wrapwhitg.f	2008-10-21 13:07:39.000000000 +0200
+++ lhapdf/5.8.5/src/wrapwhitg.f	2011-02-17 17:28:39.000000000 +0100
@@ -9,6 +9,9 @@
       integer nmem(nmxset),ndef(nmxset),mmem 
       common/NAME/name,nmem,ndef,mmem 
       integer nset 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
                                                                         
       save 
       call getnset(iset) 
@@ -53,7 +56,9 @@
       return 
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
       entry WHITGread(nset) 
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(nset),ndef(nset) 
       return 
 !                                                                       
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
--- orig.lhapdf/5.8.5/src/wrapusergrid.f	2010-03-17 11:49:42.000000000 +0100
+++ lhapdf/5.8.5/src/wrapusergrid.f	2011-02-17 17:31:31.000000000 +0100
@@ -16,6 +16,9 @@
       common/ugrid/NUMX,NUMQ2,fgrid
       double precision up,upv,dn,dnv,usea,dsea,str,chm,bot,glu
       double precision qq(5),yntmp(5)
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
       save 
       x=xin
       q2=qin*qin 
@@ -131,7 +134,9 @@
 !     
       call getnmem(nset,imem) 
 
-      read(1,*)nmem(nset),ndef(nset),NUMX,NUMQ2,nacross,npartons,(iparton(k),k=1,npartons)
+!      read(1,*)nmem(nset),ndef(nset),NUMX,NUMQ2,nacross,npartons,(iparton(k),k=1,npartons)
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(nset),ndef(nset),NUMX,NUMQ2,nacross,npartons,(iparton(k),k=1,npartons)
       
       do np = -6,6
           NPARTON(np) = .FALSE.
@@ -141,16 +146,22 @@
       nnq2 = numq2/nacross
       
       do iq=1,nnq2
-         read(1,*) (grid(NUMX+(iq-1)*nacross+ii),ii=1,nacross)
+!         read(1,*) (grid(NUMX+(iq-1)*nacross+ii),ii=1,nacross)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (grid(NUMX+(iq-1)*nacross+ii),ii=1,nacross)
       enddo
 
       do jx=1,nnx
-         read(1,*) (grid((jx-1)*nacross+ii),ii=1,nacross)
+!         read(1,*) (grid((jx-1)*nacross+ii),ii=1,nacross)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (grid((jx-1)*nacross+ii),ii=1,nacross)
       enddo
 
     !read in to alphas grid  
       do iq=1,nnq2
-         read(1,*) (agrid((iq-1)*nacross+ii),ii=1,nacross)
+!         read(1,*) (agrid((iq-1)*nacross+ii),ii=1,nacross)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (agrid((iq-1)*nacross+ii),ii=1,nacross)
       enddo
 
       do ns=0,nmem(nset)
@@ -158,7 +169,9 @@
           NPARTON(iparton(k)) = .TRUE.
           do IQ=1,NUMQ2
             do JX=1,nnx
-	      read(1,*)(fgrid(ns,(jx-1)*nacross+ii,iq,iparton(k)),ii=1,nacross)
+!	      read(1,*)(fgrid(ns,(jx-1)*nacross+ii,iq,iparton(k)),ii=1,nacross)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*)(fgrid(ns,(jx-1)*nacross+ii,iq,iparton(k)),ii=1,nacross)
             enddo
           enddo
         enddo
--- orig.lhapdf/5.8.5/src/wrapheragrid.f	2010-06-29 16:21:42.000000000 +0200
+++ lhapdf/5.8.5/src/wrapheragrid.f	2011-02-17 18:15:27.000000000 +0100
@@ -23,6 +23,9 @@
      &C38S3,C40S3,C44S3,C52S3,C136S3,C11S6,C2S9,C4S9,C10S9,C14S9,C16S9, &
      &C40S9,C44S9,C62S9,C112S9,C182S9,C11S12,C35S18,C61S12,C215S1,      &
      &C29S12,CPI2S3,CPIA,CPIB,CPIC,CPID,CPIE,CPIF,CCA,CCF,CTF,CATF,CFTF 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
       save 
       x=xin
       q2=qin*qin 
@@ -59,19 +62,27 @@
 !     
       call getnmem(nset,imem) 
 
-      read(1,*)nmem(nset),ndef(nset)
+!      read(1,*)nmem(nset),ndef(nset)
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(nset),ndef(nset)
       
       do iq=1,23
-         read(1,*) (grid(161+(iq-1)*7+ii),ii=1,7)
+!         read(1,*) (grid(161+(iq-1)*7+ii),ii=1,7)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (grid(161+(iq-1)*7+ii),ii=1,7)
       enddo
 
       do jx=1,23
-         read(1,*) (grid((jx-1)*7+ii),ii=1,7)
+!         read(1,*) (grid((jx-1)*7+ii),ii=1,7)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (grid((jx-1)*7+ii),ii=1,7)
       enddo
 
     !read in to alphas grid  
       do iq=1,23
-         read(1,*) (agrid((iq-1)*7+ii),ii=1,7)
+!         read(1,*) (agrid((iq-1)*7+ii),ii=1,7)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (agrid((iq-1)*7+ii),ii=1,7)
       enddo
 
       DO Iq=0,160
@@ -92,7 +103,9 @@
         do k = 0,7
           do IQ=1,161
             do JX=1,23
-	      read(1,*)(fgrid(ns,(jx-1)*7+ii,iq,k),ii=1,7)
+!	      read(1,*)(fgrid(ns,(jx-1)*7+ii,iq,k),ii=1,7)
+              call gzread(1,outline,nbbuf,istat)
+              read(outline(1:istat),*)(fgrid(ns,(jx-1)*7+ii,iq,k),ii=1,7)
             enddo
           enddo
         enddo
--- orig.lhapdf/5.8.5/src/wrapheragrid-lite.f	2010-06-29 16:24:39.000000000 +0200
+++ lhapdf/5.8.5/src/wrapheragrid-lite.f	2011-02-17 18:21:47.000000000 +0100
@@ -24,6 +24,10 @@
      &C38S3,C40S3,C44S3,C52S3,C136S3,C11S6,C2S9,C4S9,C10S9,C14S9,C16S9, &
      &C40S9,C44S9,C62S9,C112S9,C182S9,C11S12,C35S18,C61S12,C215S1,      &
      &C29S12,CPI2S3,CPIA,CPIB,CPIC,CPID,CPIE,CPIF,CCA,CCF,CTF,CATF,CFTF 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      character*512 compath
       save 
       x=xin
       q2=qin*qin 
@@ -60,21 +64,29 @@
 !     
       call getnmem(nset,imem) 
 
-      read(1,*)nmem(nset),ndef(nset)
+
+!      read(1,*)nmem(nset),ndef(nset)
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(nset),ndef(nset)
       
       do iq=1,23
-         read(1,*) (grid(161+(iq-1)*7+ii),ii=1,7)
+!         read(1,*) (grid(161+(iq-1)*7+ii),ii=1,7)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (grid(161+(iq-1)*7+ii),ii=1,7)
       enddo
 
       do jx=1,23
-         read(1,*) (grid((jx-1)*7+ii),ii=1,7)
+!         read(1,*) (grid((jx-1)*7+ii),ii=1,7)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (grid((jx-1)*7+ii),ii=1,7)
       enddo
 
     !read in to alphas grid  
       do iq=1,23
-         read(1,*) (agrid((iq-1)*7+ii),ii=1,7)
+!         read(1,*) (agrid((iq-1)*7+ii),ii=1,7)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (agrid((iq-1)*7+ii),ii=1,7)
       enddo
-
  
       DO Iq=0,160
         Q2=10**(8.30103/160D0*Iq )
@@ -96,7 +108,8 @@
         do k = 0,7
           do IQ=1,161
             do JX=1,23
-	      read(1,'(a)')line
+!	      read(1,'(a)')line
+              call gzread(1,outline,nbbuf,istat)
             enddo
           enddo
         enddo
@@ -150,36 +163,55 @@
 
   ! have to reopen stream 1 
   call getsetpath(setpath)
-  open(1,file=setpath(1:len_trim(setpath)))
+!  open(1,file=setpath(1:len_trim(setpath)))
+      compath = setpath//".gz" 
+      call gzopen(1,'r',compath,istat)
+      if (istat.ne.0) then
+        write(*,*) 'LHAPDF HERAGRIDpdf : unable to open file ',compath,' status = ',istat
+        stop
+      endif
 
   line = ''
   do while (line(2:11).ne.'Evolution:') 
-     read(1,'(a)'),line
-  enddo
-  read(1,'(a)'),line
-  read(1,'(a)'),line
-
-  read(1,*)nmem(iset),ndef(iset)
-
-  do iq=1,23
-     read(1,*) (grid(161+(iq-1)*7+ii),ii=1,7)
+!     read(1,'(a)'),line
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),'(a)') line
   enddo
+!  read(1,'(a)'),line
+      call gzread(1,outline,nbbuf,istat)
+!  read(1,'(a)'),line
+      call gzread(1,outline,nbbuf,istat)
+
+!  read(1,*)nmem(iset),ndef(iset)
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(iset),ndef(iset)
+      
+      do iq=1,23
+!         read(1,*) (grid(161+(iq-1)*7+ii),ii=1,7)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (grid(161+(iq-1)*7+ii),ii=1,7)
+      enddo
 
-  do jx=1,23
-     read(1,*) (grid((jx-1)*7+ii),ii=1,7)
-  enddo
+      do jx=1,23
+!         read(1,*) (grid((jx-1)*7+ii),ii=1,7)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (grid((jx-1)*7+ii),ii=1,7)
+      enddo
 
-  !read in to alphas grid  
-  do iq=1,23
-     read(1,*) (agrid((iq-1)*7+ii),ii=1,7)
-  enddo
+    !read in to alphas grid  
+      do iq=1,23
+!         read(1,*) (agrid((iq-1)*7+ii),ii=1,7)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (agrid((iq-1)*7+ii),ii=1,7)
+      enddo
  ! - dummy read in to get to End: (stream 1 is still open) 
 
    do ns=0,mem-1
      do k = 0,7
        do IQ=1,161
    	 do JX=1,23
-     	   read(1,'(a)')line
+!     	   read(1,'(a)')line
+       call gzread(1,outline,nbbuf,istat)
    	 enddo
        enddo
      enddo
@@ -189,12 +221,15 @@
    do k = 0,7
      do IQ=1,161
        do JX=1,23
-   	 read(1,*)(fgrid(ns,(jx-1)*7+ii,iq,k),ii=1,7)
+!   	 read(1,*)(fgrid(ns,(jx-1)*7+ii,iq,k),ii=1,7)
+       call gzread(1,outline,nbbuf,istat)
+       read(outline(1:istat),*)(fgrid(ns,(jx-1)*7+ii,iq,k),ii=1,7)
        enddo
      enddo
    enddo
   
-   close(1)
+!   close(1)
+      call gzclose(1,istat)
    return
 !
  1000 format(5e13.5)
--- orig.lhapdf/5.8.5/src/wraphkn.f	2009-06-29 15:16:21.000000000 +0200
+++ lhapdf/5.8.5/src/wraphkn.f	2011-02-17 18:33:00.000000000 +0100
@@ -64,6 +64,10 @@
      &  8.000000D-1, 8.250000D-1, 8.500000D-1, 8.750000D-1, &
      &  9.000000D-1, 9.250000D-1, 9.500000D-1, 9.750000D-1, &
      &  1.000000D+0 /
+
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
      
       save 
       
@@ -120,13 +124,17 @@
 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
       entry hknread(nset) 
 
-      read(1,*)nmem(nset),ndef(nset)
+!      read(1,*)nmem(nset),ndef(nset)
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(nset),ndef(nset)
   !    print *,nset,nmem(nset),ndef(nset)
       
       do n=0,nmem(nset)
         DO J=1,NQ
           DO K=1,NX-1
-            READ(1,1025) (PDFG(K,J,I,n), I=1,NFF)
+!            READ(1,1025) (PDFG(K,J,I,n), I=1,NFF)
+             call gzread(1,outline,nbbuf,istat)
+            READ(outline(1:istat),1025) (PDFG(K,J,I,n), I=1,NFF)
 	    !print *,n,j,k
           ENDDO
         ENDDO
--- orig.lhapdf/5.8.5/src/lhaglue.f	2010-08-02 16:30:01.000000000 +0200
+++ lhapdf/5.8.5/src/lhaglue.f	2011-02-21 10:43:24.000000000 +0100
@@ -1342,6 +1342,8 @@
      stop
   endif
 
+  lhaname = lhaname(1:len_trim(lhaname))//'.gz'
+
   lhamemb=lhainput-lhaset
   ! Now work out if we have already called this set/member
   iset = 0
--- orig.lhapdf/5.8.5/src/inputPDF.F	2010-06-25 17:17:02.000000000 +0200
+++ lhapdf/5.8.5/src/inputPDF.F	2011-02-21 10:56:37.000000000 +0100
@@ -42,6 +42,9 @@
   logical first
   data first/.true./
   save Nfunc,Fn,Fw,Fpow,Fmap,Ccoef,Fparm,Ftype,Ctype,first,Treshold
+  integer istat,nbbuf
+  character*512 outline
+  data nbbuf /512/
 #ifdef NNPDF
 !     NNPDF variables
   INTEGER KREP
@@ -202,7 +205,9 @@
      enddo
      first=.false.
   endif
-  read(1,*) s1,Fw(nset),Nfunc(nset)
+!  read(1,*) s1,Fw(nset),Nfunc(nset)
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) s1,Fw(nset),Nfunc(nset)
   ! print *,s1,Fw,Nfunc
   if (lhasilent.eq.0) then
      write(*,*) 'Parametrization: ',s1
@@ -210,38 +215,66 @@
   endif
   do i=1,Nfunc(nset)
      Ftype(nset,i)=-1
-     read(1,*) s1,s2
+!     read(1,*) s1,s2
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) s1,s2
      if (index(s2,'x-taylor').eq.1) then
         Ftype(nset,i)=1
-        read(1,*) FPow(nset,i),Fn(nset,i)
-        read(1,*) (Fmap(nset,i,j),j=1,Fn(nset,i))
+!        read(1,*) FPow(nset,i),Fn(nset,i)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) FPow(nset,i),Fn(nset,i)
+!        read(1,*) (Fmap(nset,i,j),j=1,Fn(nset,i))
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (Fmap(nset,i,j),j=1,Fn(nset,i))
      endif
      if (index(s2,'log-pade').eq.1) then
         Ftype(nset,i)=2
         FPow(nset,i)=0d0
-        read(1,*) Fn(nset,i)
-        read(1,*) (Fmap(nset,i,j),j=1,Fn(nset,i))
+!        read(1,*) Fn(nset,i)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) Fn(nset,i)
+!        read(1,*) (Fmap(nset,i,j),j=1,Fn(nset,i))
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (Fmap(nset,i,j),j=1,Fn(nset,i))
      endif
      if (index(s2,'cteq6-ratio').eq.1) then
         Ftype(nset,i)=101
         Fpow(nset,i)=0d0
         Fn(nset,i)=5
-        read(1,*) (Fmap(nset,i,j),j=1,Fn(nset,i))
+!        read(1,*) (Fmap(nset,i,j),j=1,Fn(nset,i))
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (Fmap(nset,i,j),j=1,Fn(nset,i))
      endif
      if (index(s2,'convol').eq.1) then
         Ftype(nset,i)=201
-        read(1,*) Fn(nset,i)
-        read(1,*) (Fmap(nset,i,j),j=1,Fn(nset,i))
+!        read(1,*) Fn(nset,i)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) Fn(nset,i)
+!        read(1,*) (Fmap(nset,i,j),j=1,Fn(nset,i))
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (Fmap(nset,i,j),j=1,Fn(nset,i))
      endif
 #ifdef NNPDF
      if (index(s2,'XNNPDF').eq.1) then
      	Ftype(nset,i)=301
-     	read(1,*) tnl(i)
-     	read(1,*) (neu(j,i),j=1,tnl(i))
-     	read(1,*) (xnor(j,i),j=1,2)
-     	read(1,*) (pdfnor(j,i),j=1,2)
-     	read(1,*) (pdfexp(j,i),j=1,2)
-     	read(1,*) NPAR(i)
+!     	read(1,*) tnl(i)
+        call gzread(1,outline,nbbuf,istat)
+     	read(outline(1:istat),*) tnl(i)
+!     	read(1,*) (neu(j,i),j=1,tnl(i))
+        call gzread(1,outline,nbbuf,istat)
+     	read(outline(1:istat),*) (neu(j,i),j=1,tnl(i))
+!     	read(1,*) (xnor(j,i),j=1,2)
+        call gzread(1,outline,nbbuf,istat)
+     	read(outline(1:istat),*) (xnor(j,i),j=1,2)
+!     	read(1,*) (pdfnor(j,i),j=1,2)
+        call gzread(1,outline,nbbuf,istat)
+     	read(outline(1:istat),*) (pdfnor(j,i),j=1,2)
+!     	read(1,*) (pdfexp(j,i),j=1,2)
+        call gzread(1,outline,nbbuf,istat)
+     	read(outline(1:istat),*) (pdfexp(j,i),j=1,2)
+!     	read(1,*) NPAR(i)
+        call gzread(1,outline,nbbuf,istat)
+     	read(outline(1:istat),*) NPAR(i)
      endif
 #endif
      if (Ftype(nset,i).lt.0) then
@@ -250,10 +283,14 @@
         stop
      endif
   enddo
-  read(1,*) s1
+!  read(1,*) s1
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) s1
   do i=-6,6
      Ctype(nset,i)=-1
-     read(1,*) s1,s2
+!     read(1,*) s1,s2
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) s1,s2
      ! print *,s1,s2
      if (index(s2,'none').eq.1) then
         Ctype(nset,i)=0
@@ -261,17 +298,23 @@
      endif
      if (index(s2,'treshold').eq.1) then
         Ctype(nset,i)=0
-        read(1,*) Treshold(nset,i)
+!        read(1,*) Treshold(nset,i)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) Treshold(nset,i)
      endif
      if (index(s2,'composite').eq.1) then
         Ctype(nset,i)=1
         Treshold(nset,i)=0d0
-        read(1,*) (Ccoef(nset,i,j),j=1,Nfunc(nset))
+!        read(1,*) (Ccoef(nset,i,j),j=1,Nfunc(nset))
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (Ccoef(nset,i,j),j=1,Nfunc(nset))
      endif
      if (index(s2,'cteq6-ratio').eq.1) then
         Ctype(nset,i)=101
         Treshold(nset,i)=0d0
-        read(1,*) (Ccoef(nset,i,j),j=1,3)
+!        read(1,*) (Ccoef(nset,i,j),j=1,3)
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (Ccoef(nset,i,j),j=1,3)
      endif
      if (Ctype(nset,i).lt.0) then
         write(*,*) 'File description error:'
--- orig.lhapdf/5.8.5/src/QCDNUM.F	2010-06-29 16:18:49.000000000 +0200
+++ lhapdf/5.8.5/src/QCDNUM.F	2011-02-21 11:59:14.000000000 +0100
@@ -688,6 +688,10 @@
 !                                                                       
 ! common added 18/3/05 by MRW                                           
       common/lhasilent/lhasilent 
+
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
                                                                         
       CALL QTRACE('QNREAD ',0) 
                                                                         
@@ -703,6 +707,8 @@
                                                                         
 !--   Read header information                                           
       READ(LUN,ERR=500) KXX,KQ2 
+!      call gzread(lun,outline,nbbuf,istat)
+!      READ(outline(1:istat),*) KXX,KQ2 
       IF(KXX.NE.MXX.OR.KQ2.NE.MQ2) THEN 
         WRITE(6,'(/'' QNREAD: nxmax, nqmax on file  '',2I5,             &
      &            /''         nxmax, nqmax in QCDNUM'',2I5,             &
@@ -711,6 +717,8 @@
         STOP 
       ENDIF 
       READ(LUN,ERR=500) RHVERS,RHDATE 
+!      call gzread(lun,outline,nbbuf,istat)
+!      READ(outline(1:istat),*) RHVERS,RHDATE 
       READ(RHVERS(1:2),'(I2)') IV 
                                                                         
 !--   If ISTOP > 0 : stop when fileversion = QCDNUM15 or lower          
@@ -726,10 +734,18 @@
      & RHVERS                                                           
                                                                         
       READ(LUN,ERR=500) RMASS 
+!      call gzread(lun,outline,nbbuf,istat)
+!      READ(outline(1:istat),*) RMASS 
       READ(LUN,ERR=500) RWT1OK,RWT2OK,RWTFOK,RWFCOK,RWLCOK,RWFBOK,      &
      &                  RWLBOK,RPLUS                                    
+!      call gzread(lun,outline,nbbuf,istat)
+!      READ(outline(1:istat),*) RWT1OK,RWT2OK,RWTFOK,RWFCOK,RWLCOK,RWFBOK,      &
+!     &                  RWLBOK,RPLUS                                    
       READ(LUN,ERR=500) RXTAB,RQTAB,                                    &
      &                  NRX,NRQ,IRF2C,IRF2B,IRFLC,IRFLB                 
+!      call gzread(lun,outline,nbbuf,istat)
+!      READ(outline(1:istat),*) RXTAB,RQTAB,                                    &
+!     &                  NRX,NRQ,IRF2C,IRF2B,IRFLC,IRFLB                 
                                                                         
       IERR   = 0 
       LREADX = .FALSE. 
@@ -951,6 +967,8 @@
                                                                         
       IF(RWT1OK) THEN 
         READ(LUN,ERR=500) WGTFF1,WGTFG1,WGTGF1,WGTGG1 
+!         call gzread(lun,outline,nbbuf,istat)
+!        READ(outline(1:istat),*) WGTFF1,WGTFG1,WGTGF1,WGTGG1 
         LWT1OK = .TRUE. 
         if(lhasilent.eq.0)                                              &
      &   WRITE(6,'(/'' QNREAD: LO weight tables read in'')')            
@@ -959,6 +977,9 @@
       IF(RWT2OK) THEN 
         READ(LUN,ERR=500) WGTPP2,WGTPM2,WGTNS2,WGTFF2,WGTFG2,WGTGF2,    &
      &                    WGTGG2                                        
+!         call gzread(lun,outline,nbbuf,istat)
+!        READ(outline(1:istat),*) WGTPP2,WGTPM2,WGTNS2,WGTFF2,WGTFG2,WGTGF2,    &
+!     &                    WGTGG2                                        
         LWT2OK = .TRUE. 
         if(lhasilent.eq.0)                                              &
      &   WRITE(6,'(/'' QNREAD: NLO weight tables read in'')')           
@@ -966,6 +987,8 @@
                                                                         
       IF(RWTFOK) THEN 
         READ(LUN,ERR=500) WGTC2Q,WGTC2G,YNTC2Q,WGTCLQ,WGTCLG,WGTC3Q 
+!         call gzread(lun,outline,nbbuf,istat)
+!        READ(outline(1:istat),*) WGTC2Q,WGTC2G,YNTC2Q,WGTCLQ,WGTCLG,WGTC3Q 
         LWTFOK = .TRUE. 
         if(lhasilent.eq.0)                                              &
      &   WRITE(6,'(/'' QNREAD: F2, FL weight tables read in'')')        
@@ -974,6 +997,9 @@
       IF(RWFCOK.OR.RWLCOK.OR.RWFBOK.OR.RWLBOK) THEN 
         READ(LUN,ERR=500) WH_C0KG,WH_C1KG,WH_C1BKG,                     &
      &                    WH_C1KQ,WH_C1BKQ,WH_D1KQ,WH_D1BKQ             
+!         call gzread(lun,outline,nbbuf,istat)
+!        READ(outline(1:istat),*) WH_C0KG,WH_C1KG,WH_C1BKG,                     &
+!     &                    WH_C1KQ,WH_C1BKQ,WH_D1KQ,WH_D1BKQ             
         LWFCOK = RWFCOK 
         LWLCOK = RWLCOK 
         LWFBOK = RWFBOK 
--- orig.lhapdf/5.8.5/src/wrapQCDNUM.F	2009-09-11 15:52:07.000000000 +0200
+++ lhapdf/5.8.5/src/wrapQCDNUM.F	2011-02-21 14:06:05.000000000 +0100
@@ -16,6 +16,10 @@
       integer nset,iset,isetlast 
       data isetlast/-1/ 
       real*8 xmin,xmax,qmin,qmax,S 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+!      character*512 compath
       save iq0,iqc,iqb,nf0,mc2,mb2,tc2,tb2,mt2 
       save nx,xmin,xmax,nq,qmin,qmax,gridname,isetlast 
 !                                                                       
@@ -86,7 +90,9 @@
 !         qmax=1d10                                                     
 !         read(1,*) dummy                                               
 !      else                                                             
-         read(1,*) gridname,nx,xmin,xmax,nq,qmin,qmax 
+!         read(1,*) gridname,nx,xmin,xmax,nq,qmin,qmax 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) gridname,nx,xmin,xmax,nq,qmin,qmax 
 !*      endif                                                           
 !      iset = nset                                                      
       return 
@@ -139,8 +145,15 @@
          qnerr=-1 
          open(unit=2,status='old',file=gridname,                        &
      &        form='unformatted',err=1)                                 
+!         compath = gridname//".gz" 
+!         call gzopen(2,'r',compath,istat)
+!         if (istat.ne.0) then
+!           write(*,*) 'LHAPDF QCDNUMinit : unable to open file ',compath,' status = ',istat
+!           stop
+!         endif
          call QNREAD(2,1,qnerr) 
     1    close(2) 
+!    1    call gzclose(1,istat)
          if (qnerr.ne.0) then 
             write(*,*) 'Grid file problem: ',gridname 
             if (qnerr.lt.0) then 
--- orig.lhapdf/5.8.5/src/wrapQCDNUM3.f	2008-10-21 13:07:39.000000000 +0200
+++ lhapdf/5.8.5/src/wrapQCDNUM3.f	2011-02-21 14:06:32.000000000 +0100
@@ -16,6 +16,10 @@
       integer nset,iset,isetlast 
       data isetlast/-1/ 
       real*8 xmin,xmax,qmin,qmax,S 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+!      character*512 compath
       save iq0,iqc,iqb,nf0,mc2,mb2,tc2,tb2,mt2 
       save nx,xmin,xmax,nq,qmin,qmax,gridname 
 !                                                                       
@@ -70,7 +74,9 @@
 !         qmax=1d10                                                     
 !         read(1,*) dummy                                               
 !      else                                                             
-         read(1,*) gridname,nx,xmin,xmax,nq,qmin,qmax 
+!         read(1,*) gridname,nx,xmin,xmax,nq,qmin,qmax 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) gridname,nx,xmin,xmax,nq,qmin,qmax 
 !*      endif                                                           
 !      iset = nset                                                      
       return 
@@ -99,8 +105,15 @@
          qnerr=-1 
          open(unit=2,status='old',file=gridname,                        &
      &        form='unformatted',err=1)                                 
+!         compath = gridname//".gz" 
+!         call gzopen(2,'r',compath,istat)
+!         if (istat.ne.0) then
+!           write(*,*) 'LHAPDF QCDNUM3init : unable to open file ',compath,' status = ',istat
+!           stop
+!         endif
          call QNREAD(2,1,qnerr) 
     1    close(2) 
+!    1    call gzclose(2,istat)
          if (qnerr.ne.0) then 
             write(*,*) 'Grid file problem: ',gridname 
             if (qnerr.lt.0) then 
--- orig.lhapdf/5.8.5/src/wrapQCDNUM4.f	2008-10-21 13:07:39.000000000 +0200
+++ lhapdf/5.8.5/src/wrapQCDNUM4.f	2011-02-21 14:06:55.000000000 +0100
@@ -16,6 +16,10 @@
       integer nset,iset,isetlast 
       data isetlast/-1/ 
       real*8 xmin,xmax,qmin,qmax,S 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+!      character*512 compath
       save iq0,iqc,iqb,nf0,mc2,mb2,tc2,tb2,mt2 
       save nx,xmin,xmax,nq,qmin,qmax,gridname 
 !                                                                       
@@ -78,7 +82,9 @@
 !         qmax=1d10                                                     
 !         read(1,*) dummy                                               
 !      else                                                             
-         read(1,*) gridname,nx,xmin,xmax,nq,qmin,qmax 
+!         read(1,*) gridname,nx,xmin,xmax,nq,qmin,qmax 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) gridname,nx,xmin,xmax,nq,qmin,qmax 
 !*      endif                                                           
 !      iset = nset                                                      
       return 
@@ -121,8 +127,15 @@
          qnerr=-1 
          open(unit=2,status='old',file=gridname,                        &
      &        form='unformatted',err=1)                                 
+!         compath = gridname//".gz" 
+!         call gzopen(2,'r',compath,istat)
+!         if (istat.ne.0) then
+!           write(*,*) 'LHAPDF QCDNUM4init : unable to open file ',compath,' status = ',istat
+!           stop
+!         endif
          call QNREAD(2,1,qnerr) 
     1    close(2) 
+!    1    call gzclose(2,istat) 
          if (qnerr.ne.0) then 
             write(*,*) 'Grid file problem: ',gridname 
             if (qnerr.lt.0) then 
--- orig.lhapdf/5.8.5/src/wrapsmrspi.f	2008-10-21 13:07:39.000000000 +0200
+++ lhapdf/5.8.5/src/wrapsmrspi.f	2011-02-21 14:45:23.000000000 +0100
@@ -17,6 +17,9 @@
       common/NAME/name,nmem,ndef,mmem 
       integer nset 
       integer initread/0/ 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
       save 
                                                                         
       call getnset(iset) 
@@ -46,14 +49,19 @@
       return 
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
       entry SMRSPread(nset) 
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(nset),ndef(nset) 
       do j=1,3 
       do k=1,NX 
       do l=1,NQ 
       if(initread.eq.0) then 
-        read(1,*)(F(m,k,l,j),m=1,5),F(7,k,l,j),F(6,k,l,j) 
+!        read(1,*)(F(m,k,l,j),m=1,5),F(7,k,l,j),F(6,k,l,j) 
+         call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*)(F(m,k,l,j),m=1,5),F(7,k,l,j),F(6,k,l,j) 
       else 
-        read(1,'(a1)')dummy 
+!        read(1,'(a1)')dummy 
+        call gzread(1,outline,nbbuf,istat)
       endif 
       enddo 
       enddo 
--- orig.lhapdf/5.8.5/src/wraph1.f	2008-10-21 13:07:39.000000000 +0200
+++ lhapdf/5.8.5/src/wraph1.f	2011-02-22 10:03:07.000000000 +0100
@@ -30,6 +30,11 @@
       integer nmem(nmxset),ndef(nmxset),mmem 
       common/NAME/name,nmem,ndef,mmem 
       integer nset,iset 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      integer nitem
+      character*20 chvec(40000)
       save 
 !                                                                       
 !      enddo                                                            
@@ -78,15 +83,35 @@
 !                                                                       
       entry H1read(nset) 
 !                                                                       
-      read(1,*)nmem(nset),ndef(nset) 
-      read(1,1000)xl_bin 
-      read(1,1000)q2l_bin 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(nset),ndef(nset) 
+!      read(1,1000)xl_bin 
+      nitem = n_bin_x 
+      call gzmult(1,chvec,nitem)
+      do i=1,nitem
+         read(chvec(i),'(e13.5)') xl_bin(i)
+      enddo
+!      read(1,1000)q2l_bin 
+      nitem = n_bin_q2 
+      call gzmult(1,chvec,nitem)
+      do i=1,nitem
+         read(chvec(i),'(e13.5)') q2l_bin(i)
+      enddo
         do i=1,n_bin_q2 
           q2l_bin(i)=log(q2l_bin(i)) 
         enddo 
       do nm = 0,nmem(nset) 
         do jval = 1,8 
-      read(1,1000)((f(nm,jval,nx,nq2),nx=1,n_bin_x),nq2=1,n_bin_q2) 
+!      read(1,1000)((f(nm,jval,nx,nq2),nx=1,n_bin_x),nq2=1,n_bin_q2) 
+           nitem = n_bin_x*n_bin_q2
+           call gzmult(1,chvec,nitem)
+           do nx=1,n_bin_x
+              do nq2 = 1,n_bin_q2
+                 i = (nq2-1)*n_bin_x+nx
+                 read(chvec(i),'(e13.5)') f(nm,jval,nx,nq2)
+              enddo
+           enddo
         enddo 
       enddo 
       return 
--- orig.lhapdf/5.8.5/src/parameter.F	2011-02-22 11:22:43.000000000 +0100
+++ lhapdf/5.8.5/src/parameter.F	2011-02-22 11:18:45.000000000 +0100
@@ -38,6 +38,11 @@
   real*8 PARTR(MXPAR,0:MXREP,MXPDF)
   real*8 ANORMTR(MXPDF,0:MXREP)
   common/nnpdf10CPARTR/PARTR,ANORMTR
+  integer istat,nbbuf
+  character*512 outline
+  data nbbuf /512/
+  integer nitem
+  character*20 chvec(40000)
 !
 #endif
   mem=imem
@@ -87,12 +92,16 @@
   
   entry InitListPDF(nset)
   type=-1
-  read(1,*) s1,listN(nset),listP(nset)
-  !print *,s1,listN(nset),listP(nset)
+!  read(1,*) s1,listN(nset),listP(nset)
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) s1,listN(nset),listP(nset)
+  !print *,s1,listN(nset),listP(nset)
   if (index(s1,'list').eq.1) then
      type=1
      do i=0,listN(nset)
-        read(1,*) (parmL(nset,i,j),j=1,listP(nset))
+!        read(1,*) (parmL(nset,i,j),j=1,listP(nset))
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) (parmL(nset,i,j),j=1,listP(nset))
        !print *,i,(parmL(nset,i,j),j=1,listP(nset))
      enddo
       !print *,parmL(nset,0,1)
@@ -102,16 +111,24 @@
      type=2 ! is type=2 ok?
 
      do i=0,listN(nset)
-  	read(1,*)idum
+!  	read(1,*)idum
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) idum
   	if(idum.ne.i)write(*,*)"error in InitListPDF"
   	do ipdf = 1,listP(nset)
-  	   read(1,*) npar(ipdf)
-  	   read(1,*) anormtr(ipdf,i)
+!  	   read(1,*) npar(ipdf)
+       call gzread(1,outline,nbbuf,istat)
+       read(outline(1:istat),*) npar(ipdf)
+!  	   read(1,*) anormtr(ipdf,i)
+       call gzread(1,outline,nbbuf,istat)
+       read(outline(1:istat),*) anormtr(ipdf,i) 
   	   do ipar = 1,npar(ipdf)
-  	      read(1,*) partr(ipar,i,ipdf)
+!  	      read(1,*) partr(ipar,i,ipdf)
+          call gzread(1,outline,nbbuf,istat)
+          read(outline(1:istat),*) partr(ipar,i,ipdf)
   	   enddo
   	enddo
-     enddo
+ enddo
 #endif
   endif
   if (type.lt.0) then
--- orig.lhapdf/5.8.5/src/wrapzeus.f	2009-09-11 16:31:33.000000000 +0200
+++ lhapdf/5.8.5/src/wrapzeus.f	2011-02-22 11:26:04.000000000 +0100
@@ -20,6 +20,10 @@
       real*8 xval(45) 
       logical HEAVY,VFN 
       real*8 pwgt(20) 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      character*512 compath
       save 
 !                                                                       
       call getnset(iset) 
@@ -75,7 +79,9 @@
 !                                                                       
 !=======================================================================
       entry ZEUSread(nset) 
-         read(1,*) gridname,nx,xmin,xmax,nq,qmin,qmax 
+!         read(1,*) gridname,nx,xmin,xmax,nq,qmin,qmax 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) gridname,nx,xmin,xmax,nq,qmin,qmax 
       return 
 !                                                                       
 !=======================================================================
@@ -209,8 +215,15 @@
          qnerr=-1 
          open(unit=2,status='old',file=gridname,                        &
      &        form='unformatted',err=1)                                 
+!         compath = gridname//".gz" 
+!         call gzopen(2,'r',compath,istat)
+!         if (istat.ne.0) then
+!           write(*,*) 'LHAPDF ZEUSinit : unable to open file ',compath,' status = ',istat
+!           stop
+!         endif
          call QNREAD(2,1,qnerr) 
     1    close(2) 
+! 1       call gzclose(2,istat)
          if (qnerr.ne.0) then 
             write(*,*) 'Grid file problem: ',gridname 
             if (qnerr.lt.0) then 
--- orig.lhapdf/5.8.5/src/wrapgrv.f	2011-02-22 11:54:40.000000000 +0100
+++ lhapdf/5.8.5/src/wrapgrv.f	2011-02-22 15:20:39.000000000 +0100
@@ -19,6 +19,11 @@
      &          QS(NQ), XB(NX), XT(NARG), NA(NARG), ARRF(NX+NQ)         
       CHARACTER*80 LINE 
       dimension pdf(-6:6) 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      integer nitem
+      character*20 chvec(40000)
       save 
       x=xin 
       q2=qin*qin 
@@ -78,22 +83,38 @@
       entry GRVread(nset) 
 !                                                                       
 !      print *,'calling grvread'                                        
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
                                                                         
-      read(1,93)xb 
+!      read(1,93)xb
+      nitem = nx 
+      call gzmult(1,chvec,nitem)
+      do ii = 1,nitem
+         read(chvec(ii),'(e8.2)') xb(ii)
+      enddo
 !      print *,xb                                                       
-      read(1,93)qs 
+!      read(1,93)qs 
+      nitem = nq
+      call gzmult(1,chvec,nitem)
+      do ii = 1,nitem
+         read(chvec(ii),'(e8.2)') qs(ii)
+      enddo
 !      print *,qs                                                       
    93 format(8e8.2) 
 !                                                                       
       do ng=0,nmem(nset) 
 !                                                                       
-      READ(1,89) LINE 
+!      READ(1,89) LINE 
+         call gzread(1,outline,nbbuf,istat)
    89 FORMAT(A80) 
 !      print *,line                                                     
       DO 15 M = 1, NX-1 
       DO 15 N = 1, NQ 
-      READ(1,90) PARTON(1,N,M), PARTON(2,N,M), PARTON(3,N,M),           &
+!      READ(1,90) PARTON(1,N,M), PARTON(2,N,M), PARTON(3,N,M),           &
+!     &           PARTON(4,N,M), PARTON(5,N,M), PARTON(6,N,M)            
+      call gzread(1,outline,nbbuf,istat)
+      READ(outline(1:istat),90) PARTON(1,N,M), PARTON(2,N,M), PARTON(3,N,M),           &
      &           PARTON(4,N,M), PARTON(5,N,M), PARTON(6,N,M)            
    90 FORMAT (6(1PE10.3)) 
    15 CONTINUE 
--- orig.lhapdf/5.8.5/src/wraphera.f	2011-02-22 11:54:41.000000000 +0100
+++ lhapdf/5.8.5/src/wraphera.f	2011-02-22 17:25:40.000000000 +0100
@@ -17,6 +17,10 @@
       real*8 xval(45)
       logical HEAVY,VFN
       real*8 pwgt(20)
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      character*512 compath
       save
 !
       call getnset(iset)
@@ -72,7 +76,9 @@
 !
 !===========================================================================
       entry HERAread(nset)
-         read(1,*) gridname,nx,xmin,xmax,nq,qmin,qmax
+!         read(1,*) gridname,nx,xmin,xmax,nq,qmin,qmax
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) gridname,nx,xmin,xmax,nq,qmin,qmax
 !	 print *,gridname,nx,xmin,xmax,nq,qmin,qmax,' from HERAread'
       return
 !
@@ -211,8 +217,15 @@
          qnerr=-1
          open(unit=2,status='old',file=gridname, &
      &        form='unformatted',err=1)
+!         compath = gridname//".gz" 
+!         call gzopen(2,'r',compath,istat)
+!         if (istat.ne.0) then
+!           write(*,*) 'LHAPDF HERAinit : unable to open file ',compath,' status = ',istat
+!           stop
+!         endif
          call QNREAD(2,1,qnerr)
  1       close(2)
+! 1       call gzclose(2,istat)
          if (qnerr.ne.0) then
             write(*,*) 'Grid file problem: ',gridname
             if (qnerr.lt.0) then 
--- orig.lhapdf/5.8.5/src/LHpdflib.F	2011-02-01 13:25:50.000000000 +0100
+++ lhapdf/5.8.5/src/LHpdflib.F	2011-02-22 18:36:20.360429000 +0100
@@ -85,6 +85,10 @@
   common/lhasilent/lhasilent
   integer nset,nnset
   integer stat
+  integer istat,nbbuf
+  character*512 outline
+  data nbbuf /512/
+  character*512 compath
 
 #ifndef LOW_MEMORY
   ! check if this set is already initialized - will not work for lite
@@ -95,7 +99,9 @@
   call commoninit()
   call getlhapdfversion(lhaversion)
 
-  inputfile(nset)=setpath
+!  inputfile(nset)=setpath
+  compath = setpath//".gz" 
+  inputfile(nset)=compath
   lhasilent = 0
   if (lhaparm(19).eq.'SILENT') then
      lhasilent = 1
@@ -108,16 +114,23 @@
   endif
 
   call setnset(nset)
-  open(unit=1, file=setpath, status='old', iostat=stat)
-  if (stat .ne. 0) then
-    write(*,*) 'File ', setpath(:len_trim(setpath)), ' cannot be opened !'
-    write(*,*) 'If you have not already done so:'
-    write(*,*) 'Use the bin/lhapdf-getdata script to download the file.'
-    write(*,*) 'Set the environmental variable LHAPATH to specify the directory if not as default (above).' 
-    close(1)
-    call exit(1)
-  end if
-  read(1,*) s1,s2
+!  open(unit=1, file=setpath, status='old', iostat=stat)
+!  if (stat .ne. 0) then
+!    write(*,*) 'File ', setpath(:len_trim(setpath)), ' cannot be opened !'
+!    write(*,*) 'If you have not already done so:'
+!    write(*,*) 'Use the bin/lhapdf-getdata script to download the file.'
+!    write(*,*) 'Set the environmental variable LHAPATH to specify the directory if not as default (above).' 
+!    close(1)
+!    call exit(1)
+!  end if
+  call gzopen(1,'r',compath,istat)
+  if (istat.ne.0) then
+     write(*,*) 'LHAPDF InitPDFsetM : unable to open file ',compath,' status = ',istat
+     stop
+  endif
+!  read(1,*) s1,s2
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) s1,s2
   if ((    index(s2,'1.0').ne.1) &
      .and.(index(s2,'1.1').ne.1) &
      .and.(index(s2,'2.0').ne.1) &
@@ -214,7 +227,9 @@
      endif
   endif
   id=Ctoken()
-1 read(1,*) string
+!1 read(1,*) string
+1 call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) string
   id=token(string)
   ! print *,'id = ',id,string
   if (id.eq.0) then
@@ -237,7 +252,8 @@
   if (id.eq.7) call initMinMax(nset)
   ! print *,'7/8'
   if (id.ne.8) goto 1
-  close(1)
+!  close(1)
+  call gzclose(1,istat)
   ! print *,'calling InitEvolveCode',nset
   call InitEvolveCode(nset)
 
--- orig.lhapdf/5.8.5/src/Makefile.am	2010-12-14 12:25:01.000000000 +0100
+++ lhapdf/5.8.5/src/Makefile.am	2011-02-22 18:36:20.344142000 +0100
@@ -6,7 +6,7 @@
 #MODULECODE   = modules.f
 MODULECODE   = commoninit.f
 LHAPDFCODE   = version.cc LHpdflib.F description.f evolution.f \
-               parameter.F QCDparams.f alphas.f inputPDF.F
+               parameter.F QCDparams.f alphas.f inputPDF.F gzio.F ftn_gzio.c
 CUSTOMCODE   = wrapevolve.F Sqcdnum.f Szeus.f 
 PHOTONCODE   = wrapsasg.f wrapgrvg.f wrapdog.f wrapdgg.f wraplacg.f wrapgsg.f \
                wrapgsg96.f wrapacfgpg.f wrapwhitg.f
--- orig.lhapdf/5.8.5/src/wrapacfgpg.f	2010-11-11 15:38:10.000000000 +0100
+++ lhapdf/5.8.5/src/wrapacfgpg.f	2011-02-22 18:36:20.399121000 +0100
@@ -11,6 +11,9 @@
       integer nmem(nmxset),ndef(nmxset),mmem 
       common/NAME/name,nmem,ndef,mmem 
       integer nset 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
                                                                         
       save 
                                                                         
@@ -44,36 +47,78 @@
       return 
 !cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc 
       entry ACFGPread(nset) 
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
       do iset = 1,3 
-        read(1,*)(par(j,iset),j=1,4) 
-        read(1,*)(par(j,iset),j=5,8) 
-        read(1,*)(par(j,iset),j=9,12) 
-        read(1,*)(par(j,iset),j=13,16) 
-        read(1,*)(par(j,iset),j=17,20) 
-        read(1,*)(par(j,iset),j=21,24) 
-        read(1,*)(par(j,iset),j=25,28) 
-        read(1,*)(par(j,iset),j=29,30) 
+!        read(1,*)(par(j,iset),j=1,4) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) (par(j,iset),j=1,4) 
+!         read(1,*)(par(j,iset),j=5,8) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) (par(j,iset),j=5,8) 
+!         read(1,*)(par(j,iset),j=9,12) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) (par(j,iset),j=9,12) 
+!         read(1,*)(par(j,iset),j=13,16) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) (par(j,iset),j=13,16) 
+!         read(1,*)(par(j,iset),j=17,20) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) (par(j,iset),j=17,20) 
+!         read(1,*)(par(j,iset),j=21,24) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) (par(j,iset),j=21,24) 
+!         read(1,*)(par(j,iset),j=25,28) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) (par(j,iset),j=25,28) 
+!         read(1,*)(par(j,iset),j=29,30) 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),*) (par(j,iset),j=29,30) 
         do j=1,32 
           do k=1,20 
-            read(1,*)(calc(i,k,j,iset),i=1,4) 
-            read(1,*)(calc(i,k,j,iset),i=5,8) 
+!            read(1,*)(calc(i,k,j,iset),i=1,4) 
+             call gzread(1,outline,nbbuf,istat)
+             read(outline(1:istat),*) (calc(i,k,j,iset),i=1,4) 
+!            read(1,*)(calc(i,k,j,iset),i=5,8) 
+             call gzread(1,outline,nbbuf,istat)
+             read(outline(1:istat),*) (calc(i,k,j,iset),i=5,8) 
           enddo 
         enddo 
       enddo 
 ! last one                                                              
-      read(1,*)(par2(j),j=1,4) 
-      read(1,*)(par2(j),j=5,8) 
-      read(1,*)(par2(j),j=9,12) 
-      read(1,*)(par2(j),j=13,16) 
-      read(1,*)(par2(j),j=17,20) 
-      read(1,*)(par2(j),j=21,24) 
-      read(1,*)(par2(j),j=25,28) 
-      read(1,*)(par2(j),j=29,30) 
+!       read(1,*)(par2(j),j=1,4) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) (par2(j),j=1,4) 
+!       read(1,*)(par2(j),j=5,8) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) (par2(j),j=5,8) 
+!       read(1,*)(par2(j),j=9,12) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) (par2(j),j=9,12) 
+!       read(1,*)(par2(j),j=13,16) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) (par2(j),j=13,16) 
+!       read(1,*)(par2(j),j=17,20) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) (par2(j),j=17,20) 
+!       read(1,*)(par2(j),j=21,24) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) (par2(j),j=21,24) 
+!       read(1,*)(par2(j),j=25,28) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) (par2(j),j=25,28) 
+!       read(1,*)(par2(j),j=29,30) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) (par2(j),j=29,30) 
       do j=1,32 
         do k=1,20 
-          read(1,*)(celc(i,k,j),i=1,4) 
-          read(1,*)(celc(i,k,j),i=5,8) 
+!          read(1,*)(celc(i,k,j),i=1,4) 
+           call gzread(1,outline,nbbuf,istat)
+           read(outline(1:istat),*) (celc(i,k,j),i=1,4) 
+!          read(1,*)(celc(i,k,j),i=5,8) 
+           call gzread(1,outline,nbbuf,istat)
+           read(outline(1:istat),*) (celc(i,k,j),i=5,8) 
         enddo 
       enddo 
                                                                         
--- orig.lhapdf/5.8.5/src/wrapct10.f	2010-12-14 12:43:36.000000000 +0100
+++ lhapdf/5.8.5/src/wrapct10.f	2011-02-22 18:36:20.462687000 +0100
@@ -24,6 +24,11 @@
       common/masses_LHA/cMass(nmxset),bMass(nmxset),tMass(nmxset) 
                                                                         
       data pi / 3.141592653589793d0 / 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      integer nitem
+      character*20 chvec(40000)
       save 
 !                                                                       
       call getnset(iset) 
@@ -61,16 +66,22 @@
       call LHCT10set 
                                                                         
                                             !*** nmem+1=number of member
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(nset),ndef(nset) 
       if(nmem(nset) .gt. nhess) then 
          print *,'fatal error:  nmem=',nmem(nset),' > nhess=',nhess 
          stop 
       endif 
                                                                         
       MxVal = 2 
-      Read  (1, '(A)') Line 
-      Read  (1, '(A)') Line 
-      Read  (1, *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
+      call gzread(1,outline,nbbuf,istat)
+      Read  (outline(1:istat), *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
       Iorder(nset) = Nint(Dr) 
       Nfl(nset) = Nint(Fl) 
       Alambda(nset) = Al(nset) 
@@ -79,17 +90,43 @@
       bMass(nset) = Amass(5,nset) 
       tMass(nset) = Amass(6,nset) 
                                                                         
-      Read  (1, '(A)') Line 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
 !                                               This is the .pds (WKT) f
-      Read  (1, *) N0, N0, N0, NfMx(nset), N0, N0 
-      Read  (1, '(A)') Line 
-      Read  (1, *) NX(nset),  NT(nset), N0, N0, N0 
-      Read  (1, '(A)') (Line,I=1,4) 
-      Read  (1, *)                                                      &
-     &  QINI(nset), QMAX(nset), (aa,TV(I,nset), I =0, NT(nset))         
-                                                                        
-      Read  (1, '(A)') Line 
-      Read  (1, *) XMIN(nset), aa, (XV(I,nset), I =1, NX(nset)) 
+!      Read  (1, *) N0, N0, N0, NfMx(nset), N0, N0 
+      call gzread(1,outline,nbbuf,istat)
+      Read  (outline(1:istat), *) N0, N0, N0, NfMx(nset), N0, N0 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) NX(nset),  NT(nset), N0, N0, N0 
+      call gzread(1,outline,nbbuf,istat)
+      Read  (outline(1:istat), *) NX(nset),  NT(nset), N0, N0, N0 
+!      Read  (1, '(A)') (Line,I=1,4) 
+      call gzread(1,outline,nbbuf,istat)
+      call gzread(1,outline,nbbuf,istat)
+      call gzread(1,outline,nbbuf,istat)
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *)                                                      &
+!     &  QINI(nset), QMAX(nset), (aa,TV(I,nset), I =0, NT(nset))         
+      nitem = 4+2*nt(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) qini(nset)
+      read(chvec(2),*) qmax(nset)
+      do i = 0, nt(nset)
+         read(chvec(2*i+3),*) aa
+         read(chvec(2*i+4),*) tv(i,nset)
+      enddo
+                                                                        
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) XMIN(nset), aa, (XV(I,nset), I =1, NX(nset)) 
+      nitem = 2+nx(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) XMIN(nset)
+      read(chvec(2),*) aa
+      do i = 1,nx(nset)
+         read(chvec(2+i),*) XV(I,nset)
+      enddo
       XV(0,nset)=0D0 
 !                                                                       
 !                  Since quark = anti-quark for nfl>2 at this stage,    
@@ -103,9 +140,16 @@
                                              !*** new version: allows nm
       do ihess = 0,nmem(nset) 
                                                                         
-        Read  (1, '(A)') Line 
-        Read  (1, '(A)') Line 
-        Read  (1, *, IOSTAT=IRET) (UPD(ihess,I,nset), I=1,Npts) 
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat)
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat)
+!        Read  (1, *, IOSTAT=IRET) (UPD(ihess,I,nset), I=1,Npts) 
+         nitem = npts
+         call gzmult(1,chvec,nitem)
+         do i = 1,npts
+            read(chvec(i),*) UPD(ihess,I,nset)
+         enddo
                                                                         
       enddo 
       return 
--- orig.lhapdf/5.8.5/src/wrapevolve.F	2011-02-01 16:16:56.000000000 +0100
+++ lhapdf/5.8.5/src/wrapevolve.F	2011-02-22 18:36:20.437972000 +0100
@@ -121,6 +121,9 @@
       character*512 setpath
       integer nnpdf,nnpdf100,nnpdf1000
       data nnpdf,nnpdf100,nnpdf1000/0,0,0/
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
       save
 !
       call setnset(nset)
@@ -326,7 +329,9 @@
       endif
 
 !
-      read(1,*) name(nset)   
+!      read(1,*) name(nset)   
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) name(nset)
 !      print *, 'this is readevolve', name(nset)   
 !
       call setnset(nset)
--- orig.lhapdf/5.8.5/src/wrapmstw.f	2011-01-26 15:33:06.000000000 +0100
+++ lhapdf/5.8.5/src/wrapmstw.f	2011-02-22 18:36:20.460493000 +0100
@@ -65,6 +65,9 @@
        &     1.8d4,3.2d4,5.6d4,1d5,1.8d5,3.2d5,5.6d5,1d6, &
        &     1.8d6,3.2d6,5.6d6,1d7,1.8d7,3.2d7,5.6d7,1d8, &
        &     1.8d8,3.2d8,5.6d8,1d9/
+  integer istat,nbbuf
+  character*512 outline
+  data nbbuf /512/
   save
 
   call getnset(iset)
@@ -209,24 +212,46 @@
   !                                                                       
   entry MSTWread(nset)
 
-  read(1,*) nmem(nset),ndef(nset)
+!  read(1,*) nmem(nset),ndef(nset)
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) nmem(nset),ndef(nset) 
 
   do ih = 0, nmem(nset)
      
      !   Read header containing heavy-quark masses and alphaS values.
-     read(1,*)
-     read(1,*)
-     read(1,*) dummyChar,dummyWord,dummyWord,dummyChar, &
+!     read(1,*)
+     call gzread(1,outline,nbbuf,istat)
+!     read(1,*)
+     call gzread(1,outline,nbbuf,istat)
+!     read(1,*) dummyChar,dummyWord,dummyWord,dummyChar, &
+!          &        distance(nset,ih),tolerance(nset,ih)
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) dummyChar,dummyWord,dummyWord,dummyChar, &
           &        distance(nset,ih),tolerance(nset,ih)
-     read(1,*) dummyChar,dummyWord,dummyChar,mCharm(nset,ih)
-     read(1,*) dummyChar,dummyWord,dummyChar,mBottom(nset,ih)
-     read(1,*) dummyChar,dummyWord,dummyChar,alphaSQ0(nset,ih)
-     read(1,*) dummyChar,dummyWord,dummyChar,alphaSMZ(nset,ih)
-     read(1,*) dummyChar,dummyWord,dummyWord,dummyChar, &
+!     read(1,*) dummyChar,dummyWord,dummyChar,mCharm(nset,ih)
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) dummyChar,dummyWord,dummyChar,mCharm(nset,ih)
+!     read(1,*) dummyChar,dummyWord,dummyChar,mBottom(nset,ih)
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) dummyChar,dummyWord,dummyChar,mBottom(nset,ih)
+!     read(1,*) dummyChar,dummyWord,dummyChar,alphaSQ0(nset,ih)
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) dummyChar,dummyWord,dummyChar,alphaSQ0(nset,ih)
+!     read(1,*) dummyChar,dummyWord,dummyChar,alphaSMZ(nset,ih)
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) dummyChar,dummyWord,dummyChar,alphaSMZ(nset,ih)
+!     read(1,*) dummyChar,dummyWord,dummyWord,dummyChar, &
+!          &        alphaSorder(nset,ih),alphaSnfmax(nset,ih)
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) dummyChar,dummyWord,dummyWord,dummyChar, &
           &        alphaSorder(nset,ih),alphaSnfmax(nset,ih)
-     read(1,*) dummyChar,dummyWord,dummyChar,nExtraFlavours
-     read(1,*)
-     read(1,*)
+!     read(1,*) dummyChar,dummyWord,dummyChar,nExtraFlavours
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) dummyChar,dummyWord,dummyChar,nExtraFlavours
+!     read(1,*)
+     call gzread(1,outline,nbbuf,istat)
+!     read(1,*)
+     call gzread(1,outline,nbbuf,istat)
 
      !   Heavy-quark masses and alphaS values
      !   are stored in a COMMON block.
@@ -295,31 +320,39 @@
         do m=1,nq
            if (nExtraFlavours.gt.0) then
               if (alphaSorder(nset,ih).eq.2) then ! NNLO
-                 read(1,'(12(1pe12.4))',iostat=io) &
-                      & (ff(ip,n,m),ip=1,12)
+!                 read(1,'(12(1pe12.4))',iostat=io) &
+!                      & (ff(ip,n,m),ip=1,12)
+                 call gzread(1,outline,nbbuf,istat)
+                 read(outline(1:istat),'(12(1pe12.4))') (ff(ip,n,m),ip=1,12)
               else          ! LO or NLO
                  ff(10,n,m) = 0.d0 ! = chm-cbar
                  ff(11,n,m) = 0.d0 ! = bot-bbar
-                 read(1,'(10(1pe12.4))',iostat=io) &
-                      & (ff(ip,n,m),ip=1,9),ff(12,n,m)
+!                 read(1,'(10(1pe12.4))',iostat=io) 
+!                      & (ff(ip,n,m),ip=1,9),ff(12,n,m)
+                 call gzread(1,outline,nbbuf,istat)
+                 read(outline(1:istat),'(10(1pe12.4))') (ff(ip,n,m),ip=1,9),ff(12,n,m)
               end if
            else             ! nExtraFlavours = 0
               if (alphaSorder(nset,ih).eq.2) then ! NNLO
                  ff(12,n,m) = 0.d0 ! = photon
-                 read(1,'(11(1pe12.4))',iostat=io) &
-                      & (ff(ip,n,m),ip=1,11)
+!                 read(1,'(11(1pe12.4))',iostat=io) &
+!                      & (ff(ip,n,m),ip=1,11)
+                 call gzread(1,outline,nbbuf,istat)
+                 read(outline(1:istat),'(11(1pe12.4))') (ff(ip,n,m),ip=1,11)
               else          ! LO or NLO
                  ff(10,n,m) = 0.d0 ! = chm-cbar
                  ff(11,n,m) = 0.d0 ! = bot-bbar
                  ff(12,n,m) = 0.d0 ! = photon
-                 read(1,'(9(1pe12.4))',iostat=io) &
-                      & (ff(ip,n,m),ip=1,9)
+!                 read(1,'(9(1pe12.4))',iostat=io) &
+!                      & (ff(ip,n,m),ip=1,9)
+                 call gzread(1,outline,nbbuf,istat)
+                 read(outline(1:istat),'(9(1pe12.4))') (ff(ip,n,m),ip=1,9)
               end if
            end if
-           if (io.ne.0) then
-              print *,"Error in MSTWevolve reading file"
-              stop
-           end if
+!           if (io.ne.0) then
+!              print *,"Error in MSTWevolve reading file"
+!              stop
+!           end if
         enddo
      enddo
 
@@ -465,11 +498,11 @@
 !--   in a similar way as at the endpoints qsqmin and qsqmax.
       do n=1,nx
          do m=1,my
-            if (myc0.eq.2.and.m.eq.1) then
-               ff2(n,m)=(ff(ip,n,m+1)-ff(ip,n,m))/(yy(m+1)-yy(m))
-            else if (myc0.eq.2.and.m.eq.2) then
-               ff2(n,m)=(ff(ip,n,m)-ff(ip,n,m-1))/(yy(m)-yy(m-1))
-            else if (m.eq.1.or.m.eq.myc0+1.or.m.eq.myb0+1) then
+             if (myc0.eq.2.and.m.eq.1) then
+                ff2(n,m)=(ff(ip,n,m+1)-ff(ip,n,m))/(yy(m+1)-yy(m))
+             else if (myc0.eq.2.and.m.eq.2) then
+                ff2(n,m)=(ff(ip,n,m)-ff(ip,n,m-1))/(yy(m)-yy(m-1))
+             else if (m.eq.1.or.m.eq.myc0+1.or.m.eq.myb0+1) then
                ff2(n,m)=polderiv1(yy(m),yy(m+1),yy(m+2), &
      &              ff(ip,n,m),ff(ip,n,m+1),ff(ip,n,m+2))
             else if (m.eq.my.or.m.eq.myc0.or.m.eq.myb0) then
@@ -497,11 +530,11 @@
 !--   Calculate the cross derivatives (d/dy)(d/dx).
       do n=1,nx
          do m = 1, my
-            if (myc0.eq.2.and.m.eq.1) then
-               ff21(n,m)=(ff1(n,m+1)-ff1(n,m))/(yy(m+1)-yy(m))
-            else if (myc0.eq.2.and.m.eq.2) then
-               ff21(n,m)=(ff1(n,m)-ff1(n,m-1))/(yy(m)-yy(m-1))
-            else if (m.eq.1.or.m.eq.myc0+1.or.m.eq.myb0+1) then
+             if (myc0.eq.2.and.m.eq.1) then
+                ff21(n,m)=(ff1(n,m+1)-ff1(n,m))/(yy(m+1)-yy(m))
+             else if (myc0.eq.2.and.m.eq.2) then
+                ff21(n,m)=(ff1(n,m)-ff1(n,m-1))/(yy(m)-yy(m-1))
+             else if (m.eq.1.or.m.eq.myc0+1.or.m.eq.myb0+1) then
                ff21(n,m)=polderiv1(yy(m),yy(m+1),yy(m+2), &
      &              ff1(n,m),ff1(n,m+1),ff1(n,m+2))
             else if (m.eq.my.or.m.eq.myc0.or.m.eq.myb0) then
--- orig.lhapdf/5.8.5/src/wrapmstw-lite.f	2011-01-26 15:33:15.000000000 +0100
+++ lhapdf/5.8.5/src/wrapmstw-lite.f	2011-02-22 18:36:20.458031000 +0100
@@ -67,6 +67,10 @@
        &     1.8d4,3.2d4,5.6d4,1d5,1.8d5,3.2d5,5.6d5,1d6, &
        &     1.8d6,3.2d6,5.6d6,1d7,1.8d7,3.2d7,5.6d7,1d8, &
        &     1.8d8,3.2d8,5.6d8,1d9/
+  integer istat,nbbuf
+  character*512 outline
+  data nbbuf /512/
+  character*512 compath
   save
 
   call getnset(iset)
@@ -212,30 +216,53 @@
   entry MSTWread(nset)
 
   ! Dummy read to get to the 'End:' (stream 1 is still open)
-  read(1,*) nmem(nset),ndef(nset)
+!  read(1,*) nmem(nset),ndef(nset)
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) nmem(nset),ndef(nset) 
   do ih = 0, nmem(nset)
      !   Read header containing heavy-quark masses and alphaS values.
-     read(1,*)
-     read(1,*)
-     read(1,*) dummyChar,dummyWord,dummyWord,dummyChar, &
+!      read(1,*)
+     call gzread(1,outline,nbbuf,istat)
+!      read(1,*)
+     call gzread(1,outline,nbbuf,istat)
+!      read(1,*) dummyChar,dummyWord,dummyWord,dummyChar, &
+!           &        distance(nset,0),tolerance(nset,0)
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) dummyChar,dummyWord,dummyWord,dummyChar, &
           &        distance(nset,0),tolerance(nset,0)
-     read(1,*) dummyChar,dummyWord,dummyChar,mCharm(nset,0)
-     read(1,*) dummyChar,dummyWord,dummyChar,mBottom(nset,0)
-     read(1,*) dummyChar,dummyWord,dummyChar,alphaSQ0(nset,0)
-     read(1,*) dummyChar,dummyWord,dummyChar,alphaSMZ(nset,0)
-     read(1,*) dummyChar,dummyWord,dummyWord,dummyChar, &
+!      read(1,*) dummyChar,dummyWord,dummyChar,mCharm(nset,0)
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) dummyChar,dummyWord,dummyChar,mCharm(nset,0)
+!      read(1,*) dummyChar,dummyWord,dummyChar,mBottom(nset,0)
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) dummyChar,dummyWord,dummyChar,mBottom(nset,0)
+!      read(1,*) dummyChar,dummyWord,dummyChar,alphaSQ0(nset,0)
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) dummyChar,dummyWord,dummyChar,alphaSQ0(nset,0)
+!      read(1,*) dummyChar,dummyWord,dummyChar,alphaSMZ(nset,0)
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) dummyChar,dummyWord,dummyChar,alphaSMZ(nset,0)
+!      read(1,*) dummyChar,dummyWord,dummyWord,dummyChar, &
+!           &        alphaSorder(nset,0),alphaSnfmax(nset,0)
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) dummyChar,dummyWord,dummyWord,dummyChar, &
           &        alphaSorder(nset,0),alphaSnfmax(nset,0)
-     read(1,*) dummyChar,dummyWord,dummyChar,nExtraFlavours
-     read(1,*)
-     read(1,*)
+!      read(1,*) dummyChar,dummyWord,dummyChar,nExtraFlavours
+     call gzread(1,outline,nbbuf,istat)
+     read(outline(1:istat),*) dummyChar,dummyWord,dummyChar,nExtraFlavours
+!      read(1,*)
+     call gzread(1,outline,nbbuf,istat)
+!      read(1,*)
+     call gzread(1,outline,nbbuf,istat)
      !   Now read in the grids from the grid file.
      do n=1,nx-1
         do m=1,nq
-           read(1,*,iostat=io)
-           if (io.ne.0) then
-              print *,"Error in MSTWevolve reading file"
-              stop
-           end if
+!           read(1,*,iostat=io)
+           call gzread(1,outline,nbbuf,istat)
+!           if (io.ne.0) then
+!              print *,"Error in MSTWevolve reading file"
+!              stop
+!           end if
         enddo
      enddo
   end do
@@ -287,43 +314,77 @@
 
   ! have to reopen stream 1 
   call getsetpath(setpath)
-  open(1,file=setpath(1:len_trim(setpath)))
-
+  compath = setpath//".gz"
+!  open(1,file=setpath(1:len_trim(setpath)))
+  call gzopen(1,'r',compath,istat)
+  if (istat.ne.0) then
+     write(*,*) 'LHAPDF MSTWpdf : unable to open file ',compath,' status = ',istat
+     stop
+  endif
+  
   line = ''
   do while (line(2:11).ne.'Evolution:')
-     read(1,'(a)'),line
+!     read(1,'(a)'),line
+     call gzread(1,outline,nbbuf,istat)
+     line = outline(1:istat)
   enddo
-  read(1,'(a)'),line
-  read(1,'(a)'),line
-
-  read(1,*)nmem(iset),ndef(iset)
+!  read(1,'(a)'),line
+  call gzread(1,outline,nbbuf,istat)
+!  read(1,'(a)'),line
+  call gzread(1,outline,nbbuf,istat)
+     
+!  read(1,*)nmem(iset),ndef(iset)
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) nmem(iset),ndef(iset) 
   ! Dummy read up to the member requested
   do i=0,mem-1
      do j=1,11
-        read(1,*)
+!        read(1,*)
+        call gzread(1,outline,nbbuf,istat)
      enddo
      do n=1,nx-1
         do m=1,nq
-           read(1,'(a)')line
+!           read(1,'(a)')line
+           call gzread(1,outline,nbbuf,istat)
         enddo
      enddo
   enddo
 
   ih=0
   !   Read header containing heavy-quark masses and alphaS values.
-  read(1,*)
-  read(1,*)
-  read(1,*) dummyChar,dummyWord,dummyWord,dummyChar, &
+!   read(1,*)
+  call gzread(1,outline,nbbuf,istat)
+!   read(1,*)
+  call gzread(1,outline,nbbuf,istat)
+!   read(1,*) dummyChar,dummyWord,dummyWord,dummyChar, &
+!        &        distance(iset,ih),tolerance(iset,ih)
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) dummyChar,dummyWord,dummyWord,dummyChar, &
        &        distance(iset,ih),tolerance(iset,ih)
-  read(1,*) dummyChar,dummyWord,dummyChar,mCharm(iset,ih)
-  read(1,*) dummyChar,dummyWord,dummyChar,mBottom(iset,ih)
-  read(1,*) dummyChar,dummyWord,dummyChar,alphaSQ0(iset,ih)
-  read(1,*) dummyChar,dummyWord,dummyChar,alphaSMZ(iset,ih)
-  read(1,*) dummyChar,dummyWord,dummyWord,dummyChar, &
-       &        alphaSorder(iset,ih),alphaSnfmax(iset,ih)
-  read(1,*) dummyChar,dummyWord,dummyChar,nExtraFlavours
-  read(1,*)
-  read(1,*)
+!   read(1,*) dummyChar,dummyWord,dummyChar,mCharm(iset,ih)
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) dummyChar,dummyWord,dummyChar,mCharm(iset,ih)
+!   read(1,*) dummyChar,dummyWord,dummyChar,mBottom(iset,ih)
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) dummyChar,dummyWord,dummyChar,mBottom(iset,ih)
+!   read(1,*) dummyChar,dummyWord,dummyChar,alphaSQ0(iset,ih)
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) dummyChar,dummyWord,dummyChar,alphaSQ0(iset,ih)
+!   read(1,*) dummyChar,dummyWord,dummyChar,alphaSMZ(iset,ih)
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) dummyChar,dummyWord,dummyChar,alphaSMZ(iset,ih)
+!   read(1,*) dummyChar,dummyWord,dummyWord,dummyChar, &
+!        &        alphaSorder(iset,ih),alphaSnfmax(iset,ih)
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) dummyChar,dummyWord,dummyWord,dummyChar, &
+        &        alphaSorder(iset,ih),alphaSnfmax(iset,ih)
+!   read(1,*) dummyChar,dummyWord,dummyChar,nExtraFlavours
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*) dummyChar,dummyWord,dummyChar,nExtraFlavours
+!   read(1,*)
+  call gzread(1,outline,nbbuf,istat)
+!   read(1,*)
+  call gzread(1,outline,nbbuf,istat)
 
   !   Heavy-quark masses and alphaS values
   !   are stored in a COMMON block.
@@ -392,25 +453,33 @@
      do m=1,nq
         if (nExtraFlavours.gt.0) then
            if (alphaSorder(iset,ih).eq.2) then ! NNLO
-              read(1,'(12(1pe12.4))',iostat=io) &
-                   & (ff(ip,n,m),ip=1,12)
+!              read(1,'(12(1pe12.4))',iostat=io) &
+!                   & (ff(ip,n,m),ip=1,12)
+              call gzread(1,outline,nbbuf,istat)
+              read(outline(1:istat),'(12(1pe12.4))') (ff(ip,n,m),ip=1,12)
            else          ! LO or NLO
               ff(10,n,m) = 0.d0 ! = chm-cbar
               ff(11,n,m) = 0.d0 ! = bot-bbar
-              read(1,'(10(1pe12.4))',iostat=io) &
-                   & (ff(ip,n,m),ip=1,9),ff(12,n,m)
+!              read(1,'(10(1pe12.4))',iostat=io) &
+!                   & (ff(ip,n,m),ip=1,9),ff(12,n,m)
+              call gzread(1,outline,nbbuf,istat)
+              read(outline(1:istat),'(10(1pe12.4))') (ff(ip,n,m),ip=1,9),ff(12,n,m)
            end if
         else             ! nExtraFlavours = 0
            if (alphaSorder(iset,ih).eq.2) then ! NNLO
               ff(12,n,m) = 0.d0 ! = photon
-              read(1,'(11(1pe12.4))',iostat=io) &
-                   & (ff(ip,n,m),ip=1,11)
+!              read(1,'(11(1pe12.4))',iostat=io) &
+!                   & (ff(ip,n,m),ip=1,11)
+              call gzread(1,outline,nbbuf,istat)
+              read(outline(1:istat),'(11(1pe12.4))') (ff(ip,n,m),ip=1,11)
            else          ! LO or NLO
               ff(10,n,m) = 0.d0 ! = chm-cbar
               ff(11,n,m) = 0.d0 ! = bot-bbar
               ff(12,n,m) = 0.d0 ! = photon
-              read(1,'(9(1pe12.4))',iostat=io) &
-                   & (ff(ip,n,m),ip=1,9)
+!              read(1,'(9(1pe12.4))',iostat=io) &
+!                   & (ff(ip,n,m),ip=1,9)
+              call gzread(1,outline,nbbuf,istat)
+              read(outline(1:istat),'(9(1pe12.4))') (ff(ip,n,m),ip=1,9)
            end if
         end if
         if (io.ne.0) then
@@ -441,7 +510,8 @@
   enddo
   ! end of section moved from the read routine
 
-  close(1)
+!  close(1)
+  call gzclose(1,istat)
 
   ! Call the initialisation routine with alpha_S(Q_0).
   IF (alphaSnfmax(iset,ih).EQ.5) THEN ! maximum of five flavours
@@ -520,11 +590,11 @@
 !--   in a similar way as at the endpoints qsqmin and qsqmax.
       do n=1,nx
          do m=1,my
-            if (myc0.eq.2.and.m.eq.1) then
-               ff2(n,m)=(ff(ip,n,m+1)-ff(ip,n,m))/(yy(m+1)-yy(m))
-            else if (myc0.eq.2.and.m.eq.2) then
-               ff2(n,m)=(ff(ip,n,m)-ff(ip,n,m-1))/(yy(m)-yy(m-1))
-            else if (m.eq.1.or.m.eq.myc0+1.or.m.eq.myb0+1) then
+             if (myc0.eq.2.and.m.eq.1) then
+                ff2(n,m)=(ff(ip,n,m+1)-ff(ip,n,m))/(yy(m+1)-yy(m))
+             else if (myc0.eq.2.and.m.eq.2) then
+                ff2(n,m)=(ff(ip,n,m)-ff(ip,n,m-1))/(yy(m)-yy(m-1))
+             else if (m.eq.1.or.m.eq.myc0+1.or.m.eq.myb0+1) then
                ff2(n,m)=polderiv1(yy(m),yy(m+1),yy(m+2), &
      &              ff(ip,n,m),ff(ip,n,m+1),ff(ip,n,m+2))
             else if (m.eq.my.or.m.eq.myc0.or.m.eq.myb0) then
@@ -552,11 +622,11 @@
 !--   Calculate the cross derivatives (d/dy)(d/dx).
       do n=1,nx
          do m = 1, my
-            if (myc0.eq.2.and.m.eq.1) then
-               ff21(n,m)=(ff1(n,m+1)-ff1(n,m))/(yy(m+1)-yy(m))
-            else if (myc0.eq.2.and.m.eq.2) then
-               ff21(n,m)=(ff1(n,m)-ff1(n,m-1))/(yy(m)-yy(m-1))
-            else if (m.eq.1.or.m.eq.myc0+1.or.m.eq.myb0+1) then
+             if (myc0.eq.2.and.m.eq.1) then
+                ff21(n,m)=(ff1(n,m+1)-ff1(n,m))/(yy(m+1)-yy(m))
+             else if (myc0.eq.2.and.m.eq.2) then
+                ff21(n,m)=(ff1(n,m)-ff1(n,m-1))/(yy(m)-yy(m-1))
+             else if (m.eq.1.or.m.eq.myc0+1.or.m.eq.myb0+1) then
                ff21(n,m)=polderiv1(yy(m),yy(m+1),yy(m+2), &
      &              ff1(n,m),ff1(n,m+1),ff1(n,m+2))
             else if (m.eq.my.or.m.eq.myc0.or.m.eq.myb0) then
--- orig.lhapdf/5.8.5/src/wrapNNPDF20grid-lite.f	2011-01-24 14:52:36.000000000 +0100
+++ lhapdf/5.8.5/src/wrapNNPDF20grid-lite.f	2011-02-22 18:36:20.379370000 +0100
@@ -70,6 +70,10 @@
       parameter(nmax=1e3,mmax=1e3) 
       double precision dy,x1,x2,y,x1a(mmax),x2a(nmax),ya(mmax,nmax) 
       integer ix1a(m),ix2a(n) 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      character*512 compath
 !                                                                       
 !      KREP = mmem
 !  always use the 0 element in the lite version  
@@ -205,34 +209,49 @@
                                                                         
       ENTRY NNPDFINT20read(nset) 
 !                                                                       
-      READ(1,*)nmem(nset),ndef(nset) 
+!      READ(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
                                                                         
 !     Set number of members                                             
       call setnmem(nset,nmem) 
                                                                         
 !     Read the grid in x                                                
-      READ(1,*) nxx 
+!      READ(1,*) nxx 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nxx
       IF(NXX.NE.NX)WRITE(*,*)"WARNING CHANGE NX ACCORDING TO .LHgrid"
       DO ix = 1,nxx 
-         READ(1,*) xg(ix,nset) 
+!         READ(1,*) xg(ix,nset) 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) xg(ix,nset)  
       ENDDO 
                                                                         
 !     Read the grid in Q2                                               
-      READ(1,*) nqq2 
+!      READ(1,*) nqq2 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nqq2
       IF(NQQ2.NE.NQ2)WRITE(*,*)"WARNING CHANGE NQ2 ACCORDING TO .LHgrid"
-      READ(1,*) q2min 
+!      READ(1,*) q2min 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) q2min
       DO iq2 = 1,nqq2 
-         READ(1,*) q2g(iq2,nset) 
+!         READ(1,*) q2g(iq2,nset) 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) q2g(iq2,nset) 
       ENDDO 
                                                                         
 !     Read the number of replicas                                       
-      READ(1,*) NREP 
+!      READ(1,*) NREP 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nrep
                                                                         
 !     Dummy read in to get to End (stream 1 is still open)                       
       DO K=0,NREP 
          DO IX=1,NX 
             DO IQ2=1,NQ2 
-               READ(1,'(a)') line 
+!               READ(1,'(a)') line 
+              call gzread(1,outline,nbbuf,istat)
             ENDDO 
          ENDDO 
       ENDDO 
@@ -290,16 +309,27 @@
       call setnmem(iset,mem)
       
       call getsetpath(setpath)
-      
-      open(1,file=setpath(1:len_trim(setpath)))
+      compath = setpath//".gz"
+!      open(1,file=setpath(1:len_trim(setpath)))
+      call gzopen(1,'r',compath,istat)
+      if (istat.ne.0) then
+        write(*,*) 'LHAPDF NNPDFINT20pdf : unable to open file ',compath,' status = ',istat
+        stop
+      endif
       line = ''
       do while (line(3:12).ne.'Evolution:'.or.len_trim(line).gt.15)
-          read(1,'(a)')line
+!          read(1,'(a)')line
+          call gzread(1,outline,nbbuf,istat)
+          line = outline(1:istat)
       enddo
-      read(1,'(a)')line
-      read(1,'(a)')line
+!      read(1,'(a)')line
+      call gzread(1,outline,nbbuf,istat)
+!      read(1,'(a)')line
+      call gzread(1,outline,nbbuf,istat)
           
-      READ(1,*)nmem(iset),ndef(iset)
+!      READ(1,*)nmem(iset),ndef(iset)
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(iset),ndef(iset)
       pdfmem = mem 
       IF (pdfmem.LT.0) THEN 
          WRITE(*,*) 'NNPDF set:' 
@@ -309,27 +339,40 @@
       ENDIF
       
 !     Read the grid in x                                                
-      READ(1,*) nxx 
+!      READ(1,*) nxx 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nxx
       IF(NXX.NE.NX)WRITE(*,*)"WARNING CHANGE NX ACCORDING TO .LHgrid"
       DO ix = 1,nxx 
-         READ(1,*) xg(ix,iset) 
+!         READ(1,*) xg(ix,iset) 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) xg(ix,iset)  
       ENDDO 
                                                                         
 !     Read the grid in Q2                                               
-      READ(1,*) nqq2 
+!      READ(1,*) nqq2 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nqq2
       IF(NQQ2.NE.NQ2)WRITE(*,*)"WARNING CHANGE NQ2 ACCORDING TO .LHgrid"
-      READ(1,*) q2min 
+!      READ(1,*) q2min 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) q2min
       DO iq2 = 1,nqq2 
-         READ(1,*) q2g(iq2,iset) 
+!         READ(1,*) q2g(iq2,iset) 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) q2g(iq2,iset) 
       ENDDO 
                                                                         
-      READ(1,*) NREP 
+!      READ(1,*) NREP 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nrep
                                                                         
 !     Dummy read up to the member requested the number of replicas                                       
       DO K=0,mem-1 
          DO IX=1,NX 
             DO IQ2=1,NQ2 
-               READ(1,'(a)') line 
+!               READ(1,'(a)') line 
+              call gzread(1,outline,nbbuf,istat)
             ENDDO 
          ENDDO 
       ENDDO 
@@ -337,11 +380,14 @@
  !    Read in the data of the requested member                                      
       DO IX=1,NX 
          DO IQ2=1,NQ2 
-            READ(1,*) ( xpdfev(ix,iq2,ipdf,0+iset-1), ipdf=-6,6,1 ) 
+!            READ(1,*) ( xpdfev(ix,iq2,ipdf,0+iset-1), ipdf=-6,6,1 ) 
+           call gzread(1,outline,nbbuf,istat)
+           read(outline(1:istat),*) ( xpdfev(ix,iq2,ipdf,0+iset-1), ipdf=-6,6,1 ) 
          ENDDO 
       ENDDO 
       
-      close(1)
+!      close(1)
+      call gzclose(1,istat)
       RETURN                                                                        
 !
       END                                           
--- orig.lhapdf/5.8.5/src/wrapNNPDFgrid-lite.f	2011-02-28 11:15:58.267398000 +0100
+++ lhapdf/5.8.5/src/wrapNNPDFgrid-lite.f	2011-03-01 10:09:19.837008000 +0100
@@ -71,6 +71,10 @@
       parameter(nmax=1e3,mmax=1e3) 
       double precision dy,x1,x2,y,x1a(mmax),x2a(nmax),ya(mmax,nmax) 
       integer ix1a(m),ix2a(n) 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      character*512 compath
 !                                                                       
 !
 !      KREP = mmem 
@@ -237,34 +241,49 @@
                                                                         
       ENTRY NNPDFINTread(nset) 
 !                                                                       
-      READ(1,*)nmem(nset),ndef(nset) 
+!      READ(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
                                                                         
 !     Set number of members                                             
       call setnmem(nset,nmem) 
                                                                         
 !     Read the grid in x                                                
-      READ(1,*) nxx 
+!      READ(1,*) nxx 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nxx
       IF(NXX.NE.NX)WRITE(*,*)"WARNING CHANGE NX ACCORDING TO .LHgrid"
       DO ix = 1,nxx 
-         READ(1,*) xg(ix,nset) 
+!         READ(1,*) xg(ix,nset) 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) xg(ix,nset)  
       ENDDO 
                                                                         
 !     Read the grid in Q2                                               
-      READ(1,*) nqq2 
+!      READ(1,*) nqq2 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) nqq2
       IF(NQQ2.NE.NQ2)WRITE(*,*)"WARNING CHANGE NQ2 ACCORDING TO .LHgrid"
-      READ(1,*) q2min 
+!      READ(1,*) q2min 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) q2min
       DO iq2 = 1,nqq2 
-         READ(1,*) q2g(iq2,nset) 
+!         READ(1,*) q2g(iq2,nset) 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) q2g(iq2,nset) 
       ENDDO 
                                                                         
 !     Read the number of replicas                                       
-      READ(1,*) NREP 
+!      READ(1,*) NREP 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nrep
                                                                         
 ! - dummy read in to get to End: (stream 1 is still open)               
       DO K=0,NREP 
          DO IX=1,NX 
             DO IQ2=1,NQ2 
-               READ(1,'(a)') line 
+!               READ(1,'(a)') line 
+               call gzread(1,outline,nbbuf,istat)
             ENDDO 
          ENDDO 
       ENDDO 
@@ -322,16 +341,28 @@
         call setnmem(iset,mem) 
    
         call getsetpath(setpath) 
-        open(1,file=setpath(1:len_trim(setpath))) 
+        compath = setpath//".gz"
+!        open(1,file=setpath(1:len_trim(setpath))) 
+        call gzopen(1,'r',compath,istat)
+        if (istat.ne.0) then
+           write(*,*) 'LHAPDF NNPDFINTpdf : unable to open file ',compath,' status = ',istat
+           stop
+        endif
         line = '' 
 	
         do while (line(3:12).ne.'Evolution:') 
-           read(1,'(a)')line
+!           read(1,'(a)')line
+          call gzread(1,outline,nbbuf,istat)
+          line = outline(1:istat)
         enddo 
-        read(1,'(a)')line 
-        read(1,'(a)')line 
-!                                                                       
-      READ(1,*)nmem(iset),ndef(iset) 
+!        read(1,'(a)')line 
+        call gzread(1,outline,nbbuf,istat)
+!        read(1,'(a)')line 
+        call gzread(1,outline,nbbuf,istat)
+!                                                                       
+!      READ(1,*)nmem(iset),ndef(iset) 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) nmem(iset),ndef(iset) 
       pdfmem = mem 
       IF (pdfmem.LT.0) THEN 
          WRITE(*,*) 'NNPDF set:' 
@@ -341,29 +372,42 @@
       ENDIF 
                                                                         
 !     Read the grid in x                                                
-      READ(1,*) nxx 
+!      READ(1,*) nxx 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nxx
       IF(NXX.NE.NX)WRITE(*,*)"WARNING CHANGE NX ACCORDING TO .LHgrid"
       DO ix = 1,nxx 
-         READ(1,*) xg(ix,iset) 
+!         READ(1,*) xg(ix,iset) 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) xg(ix,iset) 
       ENDDO 
                                                                         
 !     Read the grid in Q2                                               
-      READ(1,*) nqq2 
+!      READ(1,*) nqq2 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nqq2
       IF(NQQ2.NE.NQ2)WRITE(*,*)"WARNING CHANGE NQ2 ACCORDING TO .LHgrid"
-      READ(1,*) q2min 
+!      READ(1,*) q2min 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) q2min
       DO iq2 = 1,nqq2 
-         READ(1,*) q2g(iq2,iset) 
+!         READ(1,*) q2g(iq2,iset) 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*) q2g(iq2,iset) 
       ENDDO 
                                                                         
 !     Read the number of replicas                                       
-      READ(1,*) NREP 
+!      READ(1,*) NREP 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nrep
                                                                         
 ! - dummy read up rto the member requested               
 
       DO K=0,mem-1 
          DO IX=1,NX 
             DO IQ2=1,NQ2 
-               READ(1,'(a)') line 
+!               READ(1,'(a)') line 
+              call gzread(1,outline,nbbuf,istat)
             ENDDO 
          ENDDO 
       ENDDO 
@@ -372,7 +416,9 @@
 !- read in the data of the requested member 
       DO IX=1,NX 
          DO IQ2=1,NQ2 
-            READ(1,*) tmp
+!            READ(1,*) tmp
+           call gzread(1,outline,nbbuf,istat)
+           read(outline(1:istat),*) tmp
             DO ipdf=-6,6,1
                xpdfev(ix,iq2,ipdf,iset-1) = tmp(ipdf+7)
             ENDDO
@@ -380,7 +426,8 @@
       ENDDO
 
 !                                                                       
-      close(1) 
+!      close(1) 
+      call gzclose(1,istat)
       RETURN 
         
       END                                           
--- orig.lhapdf/5.8.5/src/wrapcteq6-lite.f	2011-02-28 11:15:58.233737000 +0100
+++ lhapdf/5.8.5/src/wrapcteq6-lite.f	2011-03-01 23:43:44.416019000 +0100
@@ -23,6 +23,13 @@
      & / Masstbl / Amass(6,nmxset)                                      
       common/masses_LHA/cMass(nmxset),bMass(nmxset),tMass(nmxset) 
       data pi / 3.141592653589793d0 / 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      integer nitem
+      character*20 chvec(40000)
+      character*512 compath
+      logical pass
       save 
 !                                                                       
       call getnset(iset) 
@@ -60,14 +67,20 @@
                                                                         
       call LHct6set 
                                             !*** nmem+1=number of member
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset) 
 !      if(nmem(nset) .gt. nhess) then                                   
 !         print *,'fatal error:  nmem=',nmem(nset),' > nhess=',nhess    
 !         stop                                                          
 !      endif                                                            
-      Read  (1, '(A)') Line 
-      Read  (1, '(A)') Line 
-      Read  (1, *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
       Iorder(nset) = Nint(Dr) 
       Nfl(nset) = Nint(Fl) 
       Alambda(nset) = Al(nset) 
@@ -76,15 +89,33 @@
       bMass(nset) = Amass(5,nset) 
       tMass(nset) = Amass(6,nset) 
                                                                         
-      Read  (1, '(A)') Line 
-      Read  (1, *) NX(nset),  NT(nset), NfMx(nset) 
-                                                                        
-      Read  (1, '(A)') Line 
-      Read  (1, *)                                                      &
-     &  QINI(nset), QMAX(nset), (TV(I,nset), I =0, NT(nset))            
-                                                                        
-      Read  (1, '(A)') Line 
-      Read  (1, *) XMIN(nset), (XV(I,nset), I =0, NX(nset)) 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) NX(nset),  NT(nset), NfMx(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) NX(nset),  NT(nset), NfMx(nset) 
+                                                                        
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *)                                                      &
+!     &  QINI(nset), QMAX(nset), (TV(I,nset), I =0, NT(nset))            
+      nitem = 3+nt(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) qini(nset)
+      read(chvec(2),*) qmax(nset)
+      do i = 0, nt(nset)
+         read(chvec(i+3),*) tv(i,nset)
+      enddo
+                                                                        
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) XMIN(nset), (XV(I,nset), I =0, NX(nset)) 
+      nitem = 2+nx(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) XMIN(nset)
+      do i = 0,nx(nset)
+         read(chvec(2+i),*) XV(I,nset)
+      enddo
                                                                         
       Do 11 Iq = 0, NT(nset) 
          TV(Iq,nset) = Log(Log (TV(Iq,nset) /Al(nset))) 
@@ -100,9 +131,16 @@
                                              !*** new version: allows nm
       do ihess = 0,nmem(nset) 
                                                                         
-        Read  (1, '(A)') Line 
-        Read  (1, '(A)') Line 
-        Read  (1, *, IOSTAT=IRET) (UPD(ihess,I,nset), I=1,Npts) 
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat)
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat)
+!        Read  (1, *, IOSTAT=IRET) (UPD(ihess,I,nset), I=1,Npts) 
+         nitem = npts
+         call gzmult(1,chvec,nitem)
+         do i = 1,npts
+            read(chvec(i),*) UPD(ihess,I,nset)
+         enddo
                                                                         
       enddo 
       return 
@@ -122,25 +160,57 @@
                                                                         
 ! have to reopen stream 1                                               
         call getsetpath(setpath) 
-        open(1,file=setpath(1:len_trim(setpath))) 
-                                                                        
+!        open(1,file=setpath(1:len_trim(setpath))) 
+        compath = setpath//".gz" 
+        call gzopen(1,'r',compath,istat)
+        if (istat.ne.0) then
+           write(*,*) 'LHAPDF CTEQ6pdf : unable to open file ',compath,' status = ',istat
+           stop
+        endif
+        
         line = '' 
         do while (line(1:3).ne.'==>') 
-          read(1,'(a)'),line 
+!          read(1,'(a)'),line 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),'(a)'),line
         enddo 
 ! - backspace by one record                                             
-        backspace(1) 
+!        backspace(1) 
+        pass = .true.
 ! - dummy read up to the member requested                               
         do n=0,mem-1 
-          read(1,'(a)'),line 
-          read(1,'(a)'),line 
-          Read  (1, *, IOSTAT=IRET) (UPD(0,I,iset), I=1,Npts) 
-        enddo 
+!          read(1,'(a)'),line 
+           if ( pass ) then
+              pass = .false.
+           else
+              call gzread(1,outline,nbbuf,istat)
+           endif
+!          read(1,'(a)'),line 
+           call gzread(1,outline,nbbuf,istat)
+!          Read  (1, *, IOSTAT=IRET) (UPD(0,I,iset), I=1,Npts) 
+           nitem = npts
+           call gzmult(1,chvec,nitem)
+           do i = 1,npts
+              read(chvec(i),*) UPD(0,I,iset)
+           enddo
+        enddo
 !- read in the data of the requested member                             
-          Read  (1, '(A)') Line 
-          Read  (1, '(A)') Line 
-          Read  (1, *, IOSTAT=IRET) (UPD(0,I,iset), I=1,Npts) 
-          close(1) 
+!          Read  (1, '(A)') Line 
+        if ( pass  ) then
+           pass = .false.
+        else
+           call gzread(1,outline,nbbuf,istat)
+        endif
+!          Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat)
+!          Read  (1, *, IOSTAT=IRET) (UPD(0,I,iset), I=1,Npts) 
+         nitem = npts
+         call gzmult(1,chvec,nitem)
+         do i = 1,npts
+            read(chvec(i),*) UPD(0,I,iset)
+         enddo
+!          close(1) 
+         call gzclose(1,istat)
       return 
 !                                                                       
       END                                           
--- orig.lhapdf/5.8.5/src/wrapabkm09-lite.f	2011-02-28 11:15:58.302075000 +0100
+++ lhapdf/5.8.5/src/wrapabkm09-lite.f	2011-03-02 14:24:21.950032000 +0100
@@ -22,6 +22,10 @@
       real*8 aa,f0,fp,fm
       real*8 pdfs0(0:np),pdfsp(0:np),pdfsm(0:np),q2plus,q2minus,q2zero
       real*8 q2mat,delq2,f2p,f2pp,aq2,bq2,cq2
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      character*512 compath
       data xmin,xmax,qsqmin,qsqmax/1d-7,1d0,0.8d0,2d8/
       data q2mat /1d0/
 
@@ -184,13 +188,17 @@
 
 
 ! - dummy read in to get to End: (stream 1 is still open)               
-      read(1,*) npdf
+!      read(1,*) npdf
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) npdf
       !print *,'number of members',npdf
       npar=nvar2
       do k=0,npar
          do n=1,nxb-1
             do m=1,nq
-               read(1,*) (f(k,n,m,i),i=0,npdf)
+!               read(1,*) (f(k,n,m,i),i=0,npdf)
+              call gzread(1,outline,nbbuf,istat)
+              read(outline(1:istat),*) (f(k,n,m,i),i=0,npdf) 
 !	       print 100,(f(k,n,m,i),i=0,npdf)
             enddo
          enddo
@@ -222,28 +230,44 @@
       
 ! have to reopen stream 1                                               
       call getsetpath(setpath) 
-      open(1,file=setpath(1:len_trim(setpath))) 
+!      open(1,file=setpath(1:len_trim(setpath))) 
+      compath = setpath//".gz" 
+      call gzopen(1,'r',compath,istat)
+      if (istat.ne.0) then
+         write(*,*) 'LHAPDF ABKM09pdf : unable to open file ',compath,' status = ',istat
+         stop
+      endif
       line = '' 
       do while (line(2:11).ne.'Evolution:') 
-         read(1,'(a)') line 
+!         read(1,'(a)') line 
+         call gzread(1,outline,nbbuf,istat)
+         read(outline(1:istat),'(a)') line
       enddo 
 
-      read(1,'(a)'),line 
-      read(1,'(a)'),line 
-
-      read(1,*) npdf
+!      read(1,'(a)'),line 
+      call gzread(1,outline,nbbuf,istat)
+!      read(1,'(a)'),line 
+      call gzread(1,outline,nbbuf,istat)
+         
+!      read(1,*) npdf
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) npdf
       npar=nvar2
       do k=0,imem-1
          do n=1,nxb-1
             do m=1,nq
-               read(1,*) (f(0,n,m,i),i=0,npdf)
+!               read(1,*) (f(0,n,m,i),i=0,npdf)
+              call gzread(1,outline,nbbuf,istat)
+              read(outline(1:istat),*) (f(0,n,m,i),i=0,npdf) 
             enddo
          enddo
       enddo
       
       do n=1,nxb-1 
          do m=1,nq 
-            read(1,*) (f(0,n,m,i),i=0,npdf) 
+!            read(1,*) (f(0,n,m,i),i=0,npdf) 
+           call gzread(1,outline,nbbuf,istat)
+           read(outline(1:istat),*) (f(0,n,m,i),i=0,npdf) 
          enddo 
       enddo 
 
@@ -282,7 +306,8 @@
           end do
         end do
       end do
-      close(1)
+!      close(1)
+      call gzclose(1,istat)
       return
       end
 
--- orig.lhapdf/5.8.5/src/wrapgjr-lite.f	2011-02-28 11:15:58.286083000 +0100
+++ lhapdf/5.8.5/src/wrapgjr-lite.f	2011-03-02 14:28:01.784198000 +0100
@@ -15,6 +15,10 @@
       double precision arg(2)
       double precision lha_dfint
       double precision lha_gjr08
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      character*512 compath
       data ng /118,99/
 
       data grid &
@@ -81,12 +85,15 @@
       entry GJRread(nset)
 !     
       call getnmem(nset,imem) 
-      read(1,*)nmem(nset),ndef(nset)
+!      read(1,*)nmem(nset),ndef(nset)
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(nset),ndef(nset)
 ! - dummy read in to get to End: (stream 1 is still open)               
       do i = 0,nmem(nset)
         do j=1,118
           do k=1,99
-	  read(1,'(a)') line
+!	  read(1,'(a)') line
+      call gzread(1,outline,nbbuf,istat)
         enddo
        enddo
       enddo
@@ -115,20 +122,33 @@
       call setnmem(iset,imem)
 ! have to reopen stream 1      
       call getsetpath(setpath) 
-      open(1,file=setpath(1:len_trim(setpath))) 
+!      open(1,file=setpath(1:len_trim(setpath))) 
+      compath = setpath//".gz" 
+      call gzopen(1,'r',compath,istat)
+      if (istat.ne.0) then
+        write(*,*) 'LHAPDF GJRpdf : unable to open file ',compath,' status = ',istat
+        stop
+        endif
       line = '' 
       do while (line(2:11).ne.'Evolution:') 
-         read(1,'(a)'),line 
+!         read(1,'(a)'),line 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),'(a)'),line
       enddo 
-      read(1,'(a)'),line 
-      read(1,'(a)'),line 
+!      read(1,'(a)'),line 
+      call gzread(1,outline,nbbuf,istat)
+!      read(1,'(a)'),line 
+      call gzread(1,outline,nbbuf,istat)
                                                                         
-      read(1,*)nmem(iset),ndef(iset) 
+!      read(1,*)nmem(iset),ndef(iset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*) nmem(iset),ndef(iset) 
 
       do i = 0,mem-1
         do j=1,118
           do k=1,99
-	  read(1,'(a)') line
+!	  read(1,'(a)') line
+            call gzread(1,outline,nbbuf,istat)
         enddo
        enddo
       enddo
@@ -140,12 +160,21 @@
         do k=1,99
           if(name(iset)(1:7).eq.'GJR08VF'.or. &
      &      name(iset)(1:7).eq.'GJR08LO') then
-            read(1,*) fgrid(j,k,-5,i),fgrid(j,k,-4,i), &
+!            read(1,*) fgrid(j,k,-5,i),fgrid(j,k,-4,i), &
+!     &  	  fgrid(j,k,-3,i),fgrid(j,k,-2,i),fgrid(j,k,-1,i), &
+!     &  	  fgrid(j,k,0,i),fgrid(j,k,1,i),fgrid(j,k,2,i), &
+!     &  	  fgrid(j,k,3,i)
+            call gzread(1,outline,nbbuf,istat)
+            read(outline(1:istat),*) fgrid(j,k,-5,i),fgrid(j,k,-4,i), &
      &  	  fgrid(j,k,-3,i),fgrid(j,k,-2,i),fgrid(j,k,-1,i), &
      &  	  fgrid(j,k,0,i),fgrid(j,k,1,i),fgrid(j,k,2,i), &
      &  	  fgrid(j,k,3,i)
           else
-            read(1,*) fgrid(j,k,-3,i),fgrid(j,k,-2,i),fgrid(j,k,-1,i), &
+!            read(1,*) fgrid(j,k,-3,i),fgrid(j,k,-2,i),fgrid(j,k,-1,i), &
+!     &  	  fgrid(j,k,0,i),fgrid(j,k,1,i),fgrid(j,k,2,i), &
+!     &  	   fgrid(j,k,3,i)
+            call gzread(1,outline,nbbuf,istat)
+            read(outline(1:istat),*) fgrid(j,k,-3,i),fgrid(j,k,-2,i),fgrid(j,k,-1,i), &
      &  	  fgrid(j,k,0,i),fgrid(j,k,1,i),fgrid(j,k,2,i), &
      &  	   fgrid(j,k,3,i)
           endif
@@ -160,7 +189,8 @@
         enddo
       enddo
 
-      close(1) 
+!      close(1) 
+      call gzclose(1,istat)
 
       return
 !
--- orig.lhapdf/5.8.5/src/wraph1-lite.f	2011-02-28 11:15:58.293902000 +0100
+++ lhapdf/5.8.5/src/wraph1-lite.f	2011-03-02 14:41:28.758654000 +0100
@@ -33,6 +33,12 @@
       integer nmem(nmxset),ndef(nmxset),mmem 
       common/NAME/name,nmem,ndef,mmem 
       integer nset,iset 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      integer nitem
+      character*20 chvec(40000)
+      character*512 compath
       save 
 !                                                                       
 !      enddo                                                            
@@ -84,12 +90,35 @@
       entry H1read(nset) 
 !                                                                       
 ! - dummy read in to get to End: (stream 1 is still open) 
-      read(1,*)nmem(nset),ndef(nset)
-      read(1,1000)xl_bin 
-      read(1,1000)q2l_bin 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(nset),ndef(nset) 
+!      read(1,1000)xl_bin 
+      nitem = n_bin_x 
+      call gzmult(1,chvec,nitem)
+      do i=1,nitem
+         read(chvec(i),'(e13.5)') xl_bin(i)
+      enddo
+!      read(1,1000)q2l_bin 
+      nitem = n_bin_q2 
+      call gzmult(1,chvec,nitem)
+      do i=1,nitem
+         read(chvec(i),'(e13.5)') q2l_bin(i)
+      enddo
+        do i=1,n_bin_q2 
+          q2l_bin(i)=log(q2l_bin(i)) 
+        enddo 
       do nm = 0,nmem(nset) 
         do jval = 1,8 
-          read(1,1000) ((f(0,jval,nx,nq2),nx=1,n_bin_x),nq2=1,n_bin_q2)
+!      read(1,1000)((f(nm,jval,nx,nq2),nx=1,n_bin_x),nq2=1,n_bin_q2) 
+           nitem = n_bin_x*n_bin_q2
+           call gzmult(1,chvec,nitem)
+           do nx=1,n_bin_x
+              do nq2 = 1,n_bin_q2
+                 i = (nq2-1)*n_bin_x+nx
+                 read(chvec(i),'(e13.5)') f(nm,jval,nx,nq2)
+              enddo
+           enddo
         enddo 
       enddo 
       return 
@@ -104,18 +133,40 @@
       entry H1pdf(mem) 
 ! have to reopen stream 1                                               
         call getsetpath(setpath) 
-        open(1,file=setpath(1:len_trim(setpath))) 
+!        open(1,file=setpath(1:len_trim(setpath))) 
+      compath = setpath//".gz" 
+      call gzopen(1,'r',compath,istat)
+      if (istat.ne.0) then
+         write(*,*) 'LHAPDF H1pdf : unable to open file ',compath,' status = ',istat
+         stop
+      endif
         line = ''
         do while (line(2:11).ne.'Evolution:') 
-           read(1,'(a)') line 
+!           read(1,'(a)') line 
+           call gzread(1,outline,nbbuf,istat)
+           read(outline(1:istat),'(a)') line
         enddo 
-        read(1,'(a)'),line 
-        read(1,'(a)'),line 
+!        read(1,'(a)'),line 
+        call gzread(1,outline,nbbuf,istat)
+!        read(1,'(a)'),line 
+        call gzread(1,outline,nbbuf,istat)
          
 	call getnset(iset)                                                                
-        read(1,*)nmem(iset),ndef(iset) 
-        read(1,1000)xl_bin 
-        read(1,1000)q2l_bin 
+!        read(1,*)nmem(iset),ndef(iset) 
+        call gzread(1,outline,nbbuf,istat)
+        read(outline(1:istat),*)nmem(iset),ndef(iset) 
+!        read(1,1000)xl_bin 
+        nitem = n_bin_x 
+        call gzmult(1,chvec,nitem)
+        do i=1,nitem
+           read(chvec(i),'(e13.5)') xl_bin(i)
+        enddo
+!        read(1,1000)q2l_bin 
+        nitem = n_bin_q2 
+        call gzmult(1,chvec,nitem)
+        do i=1,nitem
+           read(chvec(i),'(e13.5)') q2l_bin(i)
+        enddo
         do i=1,n_bin_q2 
           q2l_bin(i)=log(q2l_bin(i)) 
         enddo 
@@ -127,15 +178,32 @@
 
       do nm = 0,mem-1 
         do jval = 1,8 
-            read(1,1000) ((f(0,jval,nx,nq2),nx=1,n_bin_x),nq2=1,n_bin_q2)
-        enddo 
+!            read(1,1000) ((f(0,jval,nx,nq2),nx=1,n_bin_x),nq2=1,n_bin_q2)
+           nitem = n_bin_x*n_bin_q2
+           call gzmult(1,chvec,nitem)
+           do nx=1,n_bin_x
+              do nq2 = 1,n_bin_q2
+                 i = (nq2-1)*n_bin_x+nx
+                 read(chvec(i),'(e13.5)') f(0,jval,nx,nq2)
+              enddo
+           enddo
+        enddo
       enddo 
 
       do jval = 1,8 
-        read(1,1000)((f(0,jval,nx,nq2),nx=1,n_bin_x),nq2=1,n_bin_q2) 
-      enddo 
+!        read(1,1000)((f(0,jval,nx,nq2),nx=1,n_bin_x),nq2=1,n_bin_q2) 
+         nitem = n_bin_x*n_bin_q2
+         call gzmult(1,chvec,nitem)
+         do nx=1,n_bin_x
+            do nq2 = 1,n_bin_q2
+               i = (nq2-1)*n_bin_x+nx
+               read(chvec(i),'(e13.5)') f(0,jval,nx,nq2)
+            enddo
+         enddo
+      enddo
   
-      close(1)
+!      close(1)
+      call gzclose(1,istat)
       return 
 !                                                                       
  1000 format(5e13.5) 
--- orig.lhapdf/5.8.5/src/wraphkn-lite.f	2011-02-28 11:15:58.303548000 +0100
+++ lhapdf/5.8.5/src/wraphkn-lite.f	2011-03-02 14:46:12.989365000 +0100
@@ -64,6 +64,10 @@
      &  8.000000D-1, 8.250000D-1, 8.500000D-1, 8.750000D-1, &
      &  9.000000D-1, 9.250000D-1, 9.500000D-1, 9.750000D-1, &
      &  1.000000D+0 /
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      character*512 compath
      
       save 
       
@@ -117,12 +121,15 @@
       entry hknread(nset) 
   !dummy read to get to the End: (stream 1 is still open)
 
-      read(1,*)nmem(nset),ndef(nset)
+!      read(1,*)nmem(nset),ndef(nset)
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(nset),ndef(nset)
 
       do n=0,nmem(nset)
         DO J=1,NQ
           DO K=1,NX-1
-            READ(1,'(a)') line
+!            READ(1,'(a)') line
+             call gzread(1,outline,nbbuf,istat)
           ENDDO
         ENDDO
       enddo
@@ -149,28 +156,43 @@
 
   ! have to reopen stream 1 
   call getsetpath(setpath)
-  open(1,file=setpath(1:len_trim(setpath)))
+!  open(1,file=setpath(1:len_trim(setpath)))
+  compath = setpath//".gz"
+  call gzopen(1,'r',compath,istat)
+  if (istat.ne.0) then
+     write(*,*) 'LHAPDF hknpdf : unable to open file ',compath,' status = ',istat
+     stop
+  endif
 
   line = ''
   do while (line(2:11).ne.'Evolution:') 
-     read(1,'(a)'),line
+!     read(1,'(a)'),line
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),'(a)'),line
   enddo
-  read(1,'(a)'),line
-  read(1,'(a)'),line
-
-  read(1,*)nmem(iset),ndef(iset)
+!  read(1,'(a)'),line
+  call gzread(1,outline,nbbuf,istat)
+!  read(1,'(a)'),line
+  call gzread(1,outline,nbbuf,istat)
+
+!  read(1,*)nmem(iset),ndef(iset)
+  call gzread(1,outline,nbbuf,istat)
+  read(outline(1:istat),*)nmem(iset),ndef(iset)
   ! - dummy read up to the member requested
   do i=0,mem-1
      do j=1,nq
         do k=1,nx-1
-           read(1,'(a)')line
+!           read(1,'(a)')line
+           call gzread(1,outline,nbbuf,istat)
         enddo
      enddo
   enddo
   !   Now read in the grids from the grid file.
       DO J=1,NQ
         DO K=1,NX-1
-          READ(1,1025) (PDFG(K,J,I,0), I=1,NFF)
+!          READ(1,1025) (PDFG(K,J,I,0), I=1,NFF)
+           call gzread(1,outline,nbbuf,istat)
+           READ(outline(1:istat),1025) (PDFG(K,J,I,0), I=1,NFF)
 !         print *,
         ENDDO
       ENDDO
@@ -181,7 +203,8 @@
         ENDDO
       ENDDO
       
-      close(1) 
+!      close(1) 
+      call gzclose(1,istat)
 
  1025 FORMAT(1X,7(1PE14.6))
 
--- orig.lhapdf/5.8.5/src/wrapcteq65-lite.f	2011-02-28 11:15:58.218406000 +0100
+++ lhapdf/5.8.5/src/wrapcteq65-lite.f	2011-03-03 11:52:47.269443000 +0100
@@ -25,6 +25,13 @@
       common/masses_LHA/cMass(nmxset),bMass(nmxset),tMass(nmxset) 
                                                                         
       data pi / 3.141592653589793d0 / 
+      integer istat,nbbuf
+      character*512 outline
+      data nbbuf /512/
+      integer nitem
+      character*20 chvec(40000)
+      character*512 compath
+      logical pass
       save 
 !                                                                       
       call getnset(iset) 
@@ -126,16 +133,22 @@
       call LHct65set 
                                                                         
                                             !*** nmem+1=number of member
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(nset),ndef(nset) 
 !      if(nmem(nset) .gt. nhess) then                                   
 !         print *,'fatal error:  nmem=',nmem(nset),' > nhess=',nhess    
 !         stop                                                          
 !      endif                                                            
                                                                         
       MxVal = 3 
-      Read  (1, '(A)') Line 
-      Read  (1, '(A)') Line 
-      Read  (1, *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
+      call gzread(1,outline,nbbuf,istat)
+      Read  (outline(1:istat), *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
       Iorder(nset) = Nint(Dr) 
       Nfl(nset) = Nint(Fl) 
       Alambda(nset) = Al(nset) 
@@ -144,17 +157,44 @@
       bMass(nset) = Amass(5,nset) 
       tMass(nset) = Amass(6,nset) 
                                                                         
-      Read  (1, '(A)') Line 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
 !                                               This is the .pds (WKT) f
-      Read  (1, *) N0, N0, N0, NfMx(nset), N0, N0 
-      Read  (1, '(A)') Line 
-      Read  (1, *) NX(nset),  NT(nset), N0, N0, N0 
-      Read  (1, '(A)') (Line,I=1,4) 
-      Read  (1, *)                                                      &
-     &  QINI(nset), QMAX(nset), (aa,TV(I,nset), I =0, NT(nset))         
-                                                                        
-      Read  (1, '(A)') Line 
-      Read  (1, *) XMIN(nset), aa, (XV(I,nset), I =1, NX(nset)) 
+!      Read  (1, *) N0, N0, N0, NfMx(nset), N0, N0 
+      call gzread(1,outline,nbbuf,istat)
+      Read  (outline(1:istat), *) N0, N0, N0, NfMx(nset), N0, N0 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) NX(nset),  NT(nset), N0, N0, N0 
+      call gzread(1,outline,nbbuf,istat)
+      Read  (outline(1:istat), *) NX(nset),  NT(nset), N0, N0, N0 
+!      Read  (1, '(A)') (Line,I=1,4) 
+      call gzread(1,outline,nbbuf,istat)
+      call gzread(1,outline,nbbuf,istat)
+      call gzread(1,outline,nbbuf,istat)
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *)                                                      &
+!     &  QINI(nset), QMAX(nset), (aa,TV(I,nset), I =0, NT(nset))         
+      nitem = 4+2*nt(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) qini(nset)
+      read(chvec(2),*) qmax(nset)
+      do i = 0, nt(nset)
+         read(chvec(2*i+3),*) aa
+         read(chvec(2*i+4),*) tv(i,nset)
+      enddo
+      
+                                                                        
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) XMIN(nset), aa, (XV(I,nset), I =1, NX(nset)) 
+      nitem = 2+nx(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) XMIN(nset)
+      read(chvec(2),*) aa
+      do i = 1,nx(nset)
+         read(chvec(2+i),*) XV(I,nset)
+      enddo
       XV(0,nset)=0D0 
 !                                                                       
 !                  Since quark = anti-quark for nfl>2 at this stage,    
@@ -168,9 +208,16 @@
                                              !*** new version: allows nm
       do ihess = 0,nmem(nset) 
                                                                         
-        Read  (1, '(A)') Line 
-        Read  (1, '(A)') Line 
-        Read  (1, *, IOSTAT=IRET) (UPD(0,I,nset), I=1,Npts) 
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat)
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat)
+!        Read  (1, *, IOSTAT=IRET) (UPD(0,I,nset), I=1,Npts) 
+         nitem = npts
+         call gzmult(1,chvec,nitem)
+         do i = 1,npts
+            read(chvec(i),*) UPD(0,I,nset)
+         enddo
                                                                         
       enddo 
       return 
@@ -182,16 +229,22 @@
       call LHct65set 
                                                                         
                                             !*** nmem+1=number of member
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(nset),ndef(nset) 
 !      if(nmem(nset) .gt. nhess) then                                   
 !         print *,'fatal error:  nmem=',nmem(nset),' > nhess=',nhess    
 !         stop                                                          
 !      endif                                                            
                                                                         
       MxVal = 2 
-      Read  (1, '(A)') Line 
-      Read  (1, '(A)') Line 
-      Read  (1, *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
+      call gzread(1,outline,nbbuf,istat)
+      Read  (outline(1:istat), *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
       Iorder(nset) = Nint(Dr) 
       Nfl(nset) = Nint(Fl) 
       Alambda(nset) = Al(nset) 
@@ -200,17 +253,43 @@
       bMass(nset) = Amass(5,nset) 
       tMass(nset) = Amass(6,nset) 
                                                                         
-      Read  (1, '(A)') Line 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
 !                                               This is the .pds (WKT) f
-      Read  (1, *) N0, N0, N0, NfMx(nset), N0, N0 
-      Read  (1, '(A)') Line 
-      Read  (1, *) NX(nset),  NT(nset), N0, N0, N0 
-      Read  (1, '(A)') (Line,I=1,4) 
-      Read  (1, *)                                                      &
-     &  QINI(nset), QMAX(nset), (aa,TV(I,nset), I =0, NT(nset))         
-                                                                        
-      Read  (1, '(A)') Line 
-      Read  (1, *) XMIN(nset), aa, (XV(I,nset), I =1, NX(nset)) 
+!      Read  (1, *) N0, N0, N0, NfMx(nset), N0, N0 
+      call gzread(1,outline,nbbuf,istat)
+      Read  (outline(1:istat), *) N0, N0, N0, NfMx(nset), N0, N0 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) NX(nset),  NT(nset), N0, N0, N0 
+      call gzread(1,outline,nbbuf,istat)
+      Read  (outline(1:istat), *) NX(nset),  NT(nset), N0, N0, N0 
+!      Read  (1, '(A)') (Line,I=1,4) 
+      call gzread(1,outline,nbbuf,istat)
+      call gzread(1,outline,nbbuf,istat)
+      call gzread(1,outline,nbbuf,istat)
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *)                                                      &
+!     &  QINI(nset), QMAX(nset), (aa,TV(I,nset), I =0, NT(nset))         
+      nitem = 4+2*nt(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) qini(nset)
+      read(chvec(2),*) qmax(nset)
+      do i = 0, nt(nset)
+         read(chvec(2*i+3),*) aa
+         read(chvec(2*i+4),*) TV(I,nset)
+      enddo
+                                                                        
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) XMIN(nset), aa, (XV(I,nset), I =1, NX(nset)) 
+      nitem = 2+nx(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) XMIN(nset)
+      read(chvec(2),*) aa
+      do i = 1, nx(nset)
+         read(chvec(i+2),*) XV(I,nset)
+      enddo
       XV(0,nset)=0D0 
 !                                                                       
 !                  Since quark = anti-quark for nfl>2 at this stage,    
@@ -224,9 +303,16 @@
                                              !*** new version: allows nm
       do ihess = 0,nmem(nset) 
                                                                         
-        Read  (1, '(A)') Line 
-        Read  (1, '(A)') Line 
-        Read  (1, *, IOSTAT=IRET) (UPD(0,I,nset), I=1,Npts) 
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat)
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat)
+!        Read  (1, *, IOSTAT=IRET) (UPD(0,I,nset), I=1,Npts) 
+         nitem = npts
+         call gzmult(1,chvec,nitem)
+         do i = 1,npts
+            read(chvec(i),*) UPD(0,I,nset)
+         enddo
                                                                         
       enddo 
       return 
@@ -238,7 +324,9 @@
       call LHct65set 
                                                                         
                                             !*** nmem+1=number of member
-      read(1,*)nmem(nset),ndef(nset) 
+!      read(1,*)nmem(nset),ndef(nset) 
+      call gzread(1,outline,nbbuf,istat)
+      read(outline(1:istat),*)nmem(nset),ndef(nset) 
 !      if(nmem(nset) .gt. nhess) then                                   
 !         print *,'fatal error:  nmem=',nmem(nset),' > nhess=',nhess    
 !         stop                                                          
@@ -246,9 +334,13 @@
                                                                         
                                                !one more species free   
       MxVal = 4 
-      Read  (1, '(A)') Line 
-      Read  (1, '(A)') Line 
-      Read  (1, *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
+      call gzread(1,outline,nbbuf,istat)
+      Read  (outline(1:istat), *) Dr, Fl, Al(nset), (Amass(I,nset),I=1,6) 
       Iorder(nset) = Nint(Dr) 
       Nfl(nset) = Nint(Fl) 
       Alambda(nset) = Al(nset) 
@@ -257,17 +349,43 @@
       bMass(nset) = Amass(5,nset) 
       tMass(nset) = Amass(6,nset) 
                                                                         
-      Read  (1, '(A)') Line 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
 !                                               This is the .pds (WKT) f
-      Read  (1, *) N0, N0, N0, NfMx(nset), N0, N0 
-      Read  (1, '(A)') Line 
-      Read  (1, *) NX(nset),  NT(nset), N0, N0, N0 
-      Read  (1, '(A)') (Line,I=1,4) 
-      Read  (1, *)                                                      &
-     &  QINI(nset), QMAX(nset), (aa,TV(I,nset), I =0, NT(nset))         
-                                                                        
-      Read  (1, '(A)') Line 
-      Read  (1, *) XMIN(nset), aa, (XV(I,nset), I =1, NX(nset)) 
+!      Read  (1, *) N0, N0, N0, NfMx(nset), N0, N0 
+      call gzread(1,outline,nbbuf,istat)
+      Read  (outline(1:istat), *) N0, N0, N0, NfMx(nset), N0, N0 
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) NX(nset),  NT(nset), N0, N0, N0 
+      call gzread(1,outline,nbbuf,istat)
+      Read  (outline(1:istat), *) NX(nset),  NT(nset), N0, N0, N0 
+!      Read  (1, '(A)') (Line,I=1,4) 
+      call gzread(1,outline,nbbuf,istat)
+      call gzread(1,outline,nbbuf,istat)
+      call gzread(1,outline,nbbuf,istat)
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *)                                                      &
+!     &  QINI(nset), QMAX(nset), (aa,TV(I,nset), I =0, NT(nset))         
+      nitem = 4+2*nt(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) qini(nset)
+      read(chvec(2),*) qmax(nset)
+      do i = 0, nt(nset)
+         read(chvec(2*i+3),*) aa
+         read(chvec(2*i+4),*) TV(I,nset)
+      enddo
+                                                                        
+!      Read  (1, '(A)') Line 
+      call gzread(1,outline,nbbuf,istat)
+!      Read  (1, *) XMIN(nset), aa, (XV(I,nset), I =1, NX(nset)) 
+      nitem = 2+nx(nset)
+      call gzmult(1,chvec,nitem)
+      read(chvec(1),*) XMIN(nset)
+      read(chvec(2),*) aa
+      do i = 1, nx(nset)
+         read(chvec(i+2),*) XV(I,nset)
+      enddo
       XV(0,nset)=0D0 
 !                                                                       
 ! we Read only the non-redundent data points                            
@@ -278,9 +396,16 @@
                                              !*** new version: allows nm
       do ihess = 0,nmem(nset) 
                                                                         
-        Read  (1, '(A)') Line 
-        Read  (1, '(A)') Line 
-        Read  (1, *, IOSTAT=IRET) (UPD(0,I,nset), I=1,Npts) 
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat)
+!        Read  (1, '(A)') Line 
+         call gzread(1,outline,nbbuf,istat)
+!        Read  (1, *, IOSTAT=IRET) (UPD(0,I,nset), I=1,Npts) 
+         nitem = npts
+         call gzmult(1,chvec,nitem)
+         do i = 1,npts
+            read(chvec(i),*) UPD(0,I,nset)
+         enddo
                                                                         
       enddo 
       return 
@@ -299,25 +424,57 @@
                                                                         
 ! have to reopen stream 1                                               
         call getsetpath(setpath) 
-        open(1,file=setpath(1:len_trim(setpath))) 
+        compath = setpath//".gz"
+!        open(1,file=setpath(1:len_trim(setpath))) 
+        call gzopen(1,'r',compath,istat)
+        if (istat.ne.0) then
+           write(*,*) 'LHAPDF CTEQ65pdf : unable to open file ',compath,' status = ',istat
+           stop
+        endif
                                                                         
         line = '' 
         do while (line(1:3).ne.'==>') 
-          read(1,'(a)'),line 
+!          read(1,'(a)'),line 
+           call gzread(1,outline,nbbuf,istat)
+          read(outline(1:istat),'(a)'),line 
         enddo 
 ! - backspace by one record                                             
-        backspace(1) 
+!        backspace(1) 
+        pass = .true.
 ! - dummy read up to the member requested                               
         do n=0,mem-1 
-          read(1,'(a)'),line 
-          read(1,'(a)'),line 
-          Read  (1, *, IOSTAT=IRET) (UPD(0,I,iset), I=1,Npts) 
+!          read(1,'(a)'),line 
+           if ( pass ) then
+              pass = .false.
+           else
+              call gzread(1,outline,nbbuf,istat)
+           endif
+!          read(1,'(a)'),line 
+           call gzread(1,outline,nbbuf,istat)
+!          Read  (1, *, IOSTAT=IRET) (UPD(0,I,iset), I=1,Npts) 
+           nitem = npts
+           call gzmult(1,chvec,nitem)
+           do i = 1,npts
+              read(chvec(i),*) UPD(0,I,iset)
+           enddo
         enddo 
 !- read in the data of the requested member                             
-          Read  (1, '(A)') Line 
-          Read  (1, '(A)') Line 
-          Read  (1, *, IOSTAT=IRET) (UPD(0,I,iset), I=1,Npts) 
-          close(1) 
+!          Read  (1, '(A)') Line 
+        if ( pass ) then
+           pass = .false.
+        else
+           call gzread(1,outline,nbbuf,istat)
+        endif
+!          Read  (1, '(A)') Line 
+        call gzread(1,outline,nbbuf,istat)
+!          Read  (1, *, IOSTAT=IRET) (UPD(0,I,iset), I=1,Npts) 
+         nitem = npts
+         call gzmult(1,chvec,nitem)
+         do i = 1,npts
+            read(chvec(i),*) UPD(0,I,iset)
+         enddo
+!          close(1) 
+        call gzclose(1,istat) 
       return 
 !                                                                       
       END                                           
